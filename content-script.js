(()=>{var Kt=Object.create;var Ht=Object.defineProperty;var Jt=Object.getOwnPropertyDescriptor;var Qt=Object.getOwnPropertyNames;var Zt=Object.getPrototypeOf,te=Object.prototype.hasOwnProperty;var Ut=(D=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(D,{get:(s,C)=>(typeof require<"u"?require:s)[C]}):D)(function(D){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+D+'" is not supported')});var Tt=(D,s)=>()=>(s||D((s={exports:{}}).exports,s),s.exports);var ee=(D,s,C,a)=>{if(s&&typeof s=="object"||typeof s=="function")for(let u of Qt(s))!te.call(D,u)&&u!==C&&Ht(D,u,{get:()=>s[u],enumerable:!(a=Jt(s,u))||a.enumerable});return D};var se=(D,s,C)=>(C=D!=null?Kt(Zt(D)):{},ee(s||!D||!D.__esModule?Ht(C,"default",{value:D,enumerable:!0}):C,D));var Wt=Tt(()=>{});var Gt=Tt(()=>{});var qt=Tt(()=>{});var Xt=Tt(()=>{});var Vt=Tt(()=>{});var zt=Tt(()=>{});var $t=Tt((exports,module)=>{(function(s,C){typeof exports=="object"&&typeof module=="object"?module.exports=C():typeof define=="function"&&define.amd?define("pdfjs-dist/build/pdf",[],C):typeof exports=="object"?exports["pdfjs-dist/build/pdf"]=C():s["pdfjs-dist/build/pdf"]=s.pdfjsLib=C()})(globalThis,()=>(()=>{"use strict";var __webpack_modules__=[,(D,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.VerbosityLevel=s.Util=s.UnknownErrorException=s.UnexpectedResponseException=s.TextRenderingMode=s.RenderingIntentFlag=s.PromiseCapability=s.PermissionFlag=s.PasswordResponses=s.PasswordException=s.PageActionEventType=s.OPS=s.MissingPDFException=s.MAX_IMAGE_SIZE_TO_CACHE=s.LINE_FACTOR=s.LINE_DESCENT_FACTOR=s.InvalidPDFException=s.ImageKind=s.IDENTITY_MATRIX=s.FormatError=s.FeatureTest=s.FONT_IDENTITY_MATRIX=s.DocumentActionEventType=s.CMapCompressionType=s.BaseException=s.BASELINE_FACTOR=s.AnnotationType=s.AnnotationStateModelType=s.AnnotationReviewState=s.AnnotationReplyType=s.AnnotationMode=s.AnnotationMarkedState=s.AnnotationFlag=s.AnnotationFieldFlag=s.AnnotationEditorType=s.AnnotationEditorPrefix=s.AnnotationEditorParamsType=s.AnnotationBorderStyleType=s.AnnotationActionEventType=s.AbortException=void 0,s.assert=l,s.bytesToString=W,s.createValidAbsoluteUrl=E,s.getModificationDate=kt,s.getVerbosityLevel=U,s.info=L,s.isArrayBuffer=Et,s.isArrayEqual=yt,s.normalizeUnicode=Yt,s.objectFromMap=st,s.objectSize=Y,s.setVerbosityLevel=$,s.shadow=t,s.string32=Z,s.stringToBytes=V,s.stringToPDFString=gt,s.stringToUTF8String=mt,s.unreachable=o,s.utf8StringToString=dt,s.warn=S;let C=[1,0,0,1,0,0];s.IDENTITY_MATRIX=C;let a=[.001,0,0,.001,0,0];s.FONT_IDENTITY_MATRIX=a;let u=1e7;s.MAX_IMAGE_SIZE_TO_CACHE=u;let F=1.35;s.LINE_FACTOR=F;let x=.35;s.LINE_DESCENT_FACTOR=x;let I=x/F;s.BASELINE_FACTOR=I;let y={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};s.RenderingIntentFlag=y;let n={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};s.AnnotationMode=n;let e="pdfjs_internal_editor_";s.AnnotationEditorPrefix=e;let d={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};s.AnnotationEditorType=d;let p={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};s.AnnotationEditorParamsType=p;let i={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};s.PermissionFlag=i;let A={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};s.TextRenderingMode=A;let T={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};s.ImageKind=T;let _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};s.AnnotationType=_;let b={MARKED:"Marked",REVIEW:"Review"};s.AnnotationStateModelType=b;let M={MARKED:"Marked",UNMARKED:"Unmarked"};s.AnnotationMarkedState=M;let N={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};s.AnnotationReviewState=N;let P={GROUP:"Group",REPLY:"R"};s.AnnotationReplyType=P;let c={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};s.AnnotationFlag=c;let f={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};s.AnnotationFieldFlag=f;let k={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};s.AnnotationBorderStyleType=k;let B={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};s.AnnotationActionEventType=B;let O={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};s.DocumentActionEventType=O;let G={O:"PageOpen",C:"PageClose"};s.PageActionEventType=G;let X={ERRORS:0,WARNINGS:1,INFOS:5};s.VerbosityLevel=X;let K={NONE:0,BINARY:1};s.CMapCompressionType=K;let rt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};s.OPS=rt;let Q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};s.PasswordResponses=Q;let tt=X.WARNINGS;function $(J){Number.isInteger(J)&&(tt=J)}function U(){return tt}function L(J){tt>=X.INFOS&&console.log(`Info: ${J}`)}function S(J){tt>=X.WARNINGS&&console.log(`Warning: ${J}`)}function o(J){throw new Error(J)}function l(J,q){J||o(q)}function m(J){switch(J?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function E(J,q=null,H=null){if(!J)return null;try{if(H&&typeof J=="string"&&(H.addDefaultProtocol&&J.startsWith("www.")&&J.match(/\./g)?.length>=2&&(J=`http://${J}`),H.tryConvertEncoding))try{J=mt(J)}catch{}let it=q?new URL(J,q):new URL(J);if(m(it))return it}catch{}return null}function t(J,q,H,it=!1){return Object.defineProperty(J,q,{value:H,enumerable:!it,configurable:!0,writable:!1}),H}let r=function(){function q(H,it){this.constructor===q&&o("Cannot initialize BaseException."),this.message=H,this.name=it}return q.prototype=new Error,q.constructor=q,q}();s.BaseException=r;class h extends r{constructor(q,H){super(q,"PasswordException"),this.code=H}}s.PasswordException=h;class g extends r{constructor(q,H){super(q,"UnknownErrorException"),this.details=H}}s.UnknownErrorException=g;class v extends r{constructor(q){super(q,"InvalidPDFException")}}s.InvalidPDFException=v;class w extends r{constructor(q){super(q,"MissingPDFException")}}s.MissingPDFException=w;class R extends r{constructor(q,H){super(q,"UnexpectedResponseException"),this.status=H}}s.UnexpectedResponseException=R;class j extends r{constructor(q){super(q,"FormatError")}}s.FormatError=j;class z extends r{constructor(q){super(q,"AbortException")}}s.AbortException=z;function W(J){(typeof J!="object"||J?.length===void 0)&&o("Invalid argument for bytesToString");let q=J.length,H=8192;if(q<H)return String.fromCharCode.apply(null,J);let it=[];for(let ht=0;ht<q;ht+=H){let ft=Math.min(ht+H,q),pt=J.subarray(ht,ft);it.push(String.fromCharCode.apply(null,pt))}return it.join("")}function V(J){typeof J!="string"&&o("Invalid argument for stringToBytes");let q=J.length,H=new Uint8Array(q);for(let it=0;it<q;++it)H[it]=J.charCodeAt(it)&255;return H}function Z(J){return String.fromCharCode(J>>24&255,J>>16&255,J>>8&255,J&255)}function Y(J){return Object.keys(J).length}function st(J){let q=Object.create(null);for(let[H,it]of J)q[H]=it;return q}function nt(){let J=new Uint8Array(4);return J[0]=1,new Uint32Array(J.buffer,0,1)[0]===1}function et(){try{return new Function(""),!0}catch{return!1}}class at{static get isLittleEndian(){return t(this,"isLittleEndian",nt())}static get isEvalSupported(){return t(this,"isEvalSupported",et())}static get isOffscreenCanvasSupported(){return t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?t(this,"platform",{isWin:!1,isMac:!1}):t(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}s.FeatureTest=at;let ot=[...Array(256).keys()].map(J=>J.toString(16).padStart(2,"0"));class lt{static makeHexColor(q,H,it){return`#${ot[q]}${ot[H]}${ot[it]}`}static scaleMinMax(q,H){let it;q[0]?(q[0]<0&&(it=H[0],H[0]=H[1],H[1]=it),H[0]*=q[0],H[1]*=q[0],q[3]<0&&(it=H[2],H[2]=H[3],H[3]=it),H[2]*=q[3],H[3]*=q[3]):(it=H[0],H[0]=H[2],H[2]=it,it=H[1],H[1]=H[3],H[3]=it,q[1]<0&&(it=H[2],H[2]=H[3],H[3]=it),H[2]*=q[1],H[3]*=q[1],q[2]<0&&(it=H[0],H[0]=H[1],H[1]=it),H[0]*=q[2],H[1]*=q[2]),H[0]+=q[4],H[1]+=q[4],H[2]+=q[5],H[3]+=q[5]}static transform(q,H){return[q[0]*H[0]+q[2]*H[1],q[1]*H[0]+q[3]*H[1],q[0]*H[2]+q[2]*H[3],q[1]*H[2]+q[3]*H[3],q[0]*H[4]+q[2]*H[5]+q[4],q[1]*H[4]+q[3]*H[5]+q[5]]}static applyTransform(q,H){let it=q[0]*H[0]+q[1]*H[2]+H[4],ht=q[0]*H[1]+q[1]*H[3]+H[5];return[it,ht]}static applyInverseTransform(q,H){let it=H[0]*H[3]-H[1]*H[2],ht=(q[0]*H[3]-q[1]*H[2]+H[2]*H[5]-H[4]*H[3])/it,ft=(-q[0]*H[1]+q[1]*H[0]+H[4]*H[1]-H[5]*H[0])/it;return[ht,ft]}static getAxialAlignedBoundingBox(q,H){let it=lt.applyTransform(q,H),ht=lt.applyTransform(q.slice(2,4),H),ft=lt.applyTransform([q[0],q[3]],H),pt=lt.applyTransform([q[2],q[1]],H);return[Math.min(it[0],ht[0],ft[0],pt[0]),Math.min(it[1],ht[1],ft[1],pt[1]),Math.max(it[0],ht[0],ft[0],pt[0]),Math.max(it[1],ht[1],ft[1],pt[1])]}static inverseTransform(q){let H=q[0]*q[3]-q[1]*q[2];return[q[3]/H,-q[1]/H,-q[2]/H,q[0]/H,(q[2]*q[5]-q[4]*q[3])/H,(q[4]*q[1]-q[5]*q[0])/H]}static singularValueDecompose2dScale(q){let H=[q[0],q[2],q[1],q[3]],it=q[0]*H[0]+q[1]*H[2],ht=q[0]*H[1]+q[1]*H[3],ft=q[2]*H[0]+q[3]*H[2],pt=q[2]*H[1]+q[3]*H[3],Pt=(it+pt)/2,wt=Math.sqrt((it+pt)**2-4*(it*pt-ft*ht))/2,Ct=Pt+wt||1,bt=Pt-wt||1;return[Math.sqrt(Ct),Math.sqrt(bt)]}static normalizeRect(q){let H=q.slice(0);return q[0]>q[2]&&(H[0]=q[2],H[2]=q[0]),q[1]>q[3]&&(H[1]=q[3],H[3]=q[1]),H}static intersect(q,H){let it=Math.max(Math.min(q[0],q[2]),Math.min(H[0],H[2])),ht=Math.min(Math.max(q[0],q[2]),Math.max(H[0],H[2]));if(it>ht)return null;let ft=Math.max(Math.min(q[1],q[3]),Math.min(H[1],H[3])),pt=Math.min(Math.max(q[1],q[3]),Math.max(H[1],H[3]));return ft>pt?null:[it,ft,ht,pt]}static bezierBoundingBox(q,H,it,ht,ft,pt,Pt,wt){let Ct=[],bt=[[],[]],xt,St,Dt,ut,Ot,It,Nt,jt;for(let Bt=0;Bt<2;++Bt){if(Bt===0?(St=6*q-12*it+6*ft,xt=-3*q+9*it-9*ft+3*Pt,Dt=3*it-3*q):(St=6*H-12*ht+6*pt,xt=-3*H+9*ht-9*pt+3*wt,Dt=3*ht-3*H),Math.abs(xt)<1e-12){if(Math.abs(St)<1e-12)continue;ut=-Dt/St,0<ut&&ut<1&&Ct.push(ut);continue}Nt=St*St-4*Dt*xt,jt=Math.sqrt(Nt),!(Nt<0)&&(Ot=(-St+jt)/(2*xt),0<Ot&&Ot<1&&Ct.push(Ot),It=(-St-jt)/(2*xt),0<It&&It<1&&Ct.push(It))}let Ft=Ct.length,_t,Rt=Ft;for(;Ft--;)ut=Ct[Ft],_t=1-ut,bt[0][Ft]=_t*_t*_t*q+3*_t*_t*ut*it+3*_t*ut*ut*ft+ut*ut*ut*Pt,bt[1][Ft]=_t*_t*_t*H+3*_t*_t*ut*ht+3*_t*ut*ut*pt+ut*ut*ut*wt;return bt[0][Rt]=q,bt[1][Rt]=H,bt[0][Rt+1]=Pt,bt[1][Rt+1]=wt,bt[0].length=bt[1].length=Rt+2,[Math.min(...bt[0]),Math.min(...bt[1]),Math.max(...bt[0]),Math.max(...bt[1])]}}s.Util=lt;let ct=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function gt(J){if(J[0]>="\xEF"){let H;if(J[0]==="\xFE"&&J[1]==="\xFF"?H="utf-16be":J[0]==="\xFF"&&J[1]==="\xFE"?H="utf-16le":J[0]==="\xEF"&&J[1]==="\xBB"&&J[2]==="\xBF"&&(H="utf-8"),H)try{let it=new TextDecoder(H,{fatal:!0}),ht=V(J);return it.decode(ht)}catch(it){S(`stringToPDFString: "${it}".`)}}let q=[];for(let H=0,it=J.length;H<it;H++){let ht=ct[J.charCodeAt(H)];q.push(ht?String.fromCharCode(ht):J.charAt(H))}return q.join("")}function mt(J){return decodeURIComponent(escape(J))}function dt(J){return unescape(encodeURIComponent(J))}function Et(J){return typeof J=="object"&&J?.byteLength!==void 0}function yt(J,q){if(J.length!==q.length)return!1;for(let H=0,it=J.length;H<it;H++)if(J[H]!==q[H])return!1;return!0}function kt(J=new Date){return[J.getUTCFullYear().toString(),(J.getUTCMonth()+1).toString().padStart(2,"0"),J.getUTCDate().toString().padStart(2,"0"),J.getUTCHours().toString().padStart(2,"0"),J.getUTCMinutes().toString().padStart(2,"0"),J.getUTCSeconds().toString().padStart(2,"0")].join("")}class At{#t=!1;constructor(){this.promise=new Promise((q,H)=>{this.resolve=it=>{this.#t=!0,q(it)},this.reject=it=>{this.#t=!0,H(it)}})}get settled(){return this.#t}}s.PromiseCapability=At;let vt=null,Mt=null;function Yt(J){return vt||(vt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Mt=new Map([["\uFB05","\u017Ft"]])),J.replaceAll(vt,(q,H,it)=>H?H.normalize("NFKC"):Mt.get(it))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);let DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){let{NodeCanvasFactory:D,NodeCMapReaderFactory:s,NodeFilterFactory:C,NodeStandardFontDataFactory:a}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=D,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=s,exports.DefaultFilterFactory=DefaultFilterFactory=C,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=a}let createPDFNetworkStream;if(_is_node.isNodeJS){let{PDFNodeStream:D}=__w_pdfjs_require__(21);createPDFNetworkStream=s=>new D(s)}else{let{PDFNetworkStream:D}=__w_pdfjs_require__(24),{PDFFetchStream:s}=__w_pdfjs_require__(25);createPDFNetworkStream=C=>(0,_display_utils.isValidFetchUrl)(C.url)?new s(C):new D(C)}function getDocument(D){if(typeof D=="string"||D instanceof URL?D={url:D}:(0,_util.isArrayBuffer)(D)&&(D={data:D}),typeof D!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!D.url&&!D.data&&!D.range)throw new Error("Invalid parameter object: need either .data, .range or .url");let s=new PDFDocumentLoadingTask,{docId:C}=s,a=D.url?getUrlProp(D.url):null,u=D.data?getDataProp(D.data):null,F=D.httpHeaders||null,x=D.withCredentials===!0,I=D.password??null,y=D.range instanceof PDFDataRangeTransport?D.range:null,n=Number.isInteger(D.rangeChunkSize)&&D.rangeChunkSize>0?D.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE,e=D.worker instanceof _PDFWorker?D.worker:null,d=D.verbosity,p=typeof D.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(D.docBaseUrl)?D.docBaseUrl:null,i=typeof D.cMapUrl=="string"?D.cMapUrl:null,A=D.cMapPacked!==!1,T=D.CMapReaderFactory||DefaultCMapReaderFactory,_=typeof D.standardFontDataUrl=="string"?D.standardFontDataUrl:null,b=D.StandardFontDataFactory||DefaultStandardFontDataFactory,M=D.stopAtErrors!==!0,N=Number.isInteger(D.maxImageSize)&&D.maxImageSize>-1?D.maxImageSize:-1,P=D.isEvalSupported!==!1,c=typeof D.isOffscreenCanvasSupported=="boolean"?D.isOffscreenCanvasSupported:!_is_node.isNodeJS,f=Number.isInteger(D.canvasMaxAreaInBytes)?D.canvasMaxAreaInBytes:-1,k=typeof D.disableFontFace=="boolean"?D.disableFontFace:_is_node.isNodeJS,B=D.fontExtraProperties===!0,O=D.enableXfa===!0,G=D.ownerDocument||globalThis.document,X=D.disableRange===!0,K=D.disableStream===!0,rt=D.disableAutoFetch===!0,Q=D.pdfBug===!0,tt=y?y.length:D.length??NaN,$=typeof D.useSystemFonts=="boolean"?D.useSystemFonts:!_is_node.isNodeJS&&!k,U=typeof D.useWorkerFetch=="boolean"?D.useWorkerFetch:T===_display_utils.DOMCMapReaderFactory&&b===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(_,document.baseURI),L=D.canvasFactory||new DefaultCanvasFactory({ownerDocument:G}),S=D.filterFactory||new DefaultFilterFactory({docId:C,ownerDocument:G}),o=null;(0,_util.setVerbosityLevel)(d);let l={canvasFactory:L,filterFactory:S};if(U||(l.cMapReaderFactory=new T({baseUrl:i,isCompressed:A}),l.standardFontDataFactory=new b({baseUrl:_})),!e){let t={verbosity:d,port:_worker_options.GlobalWorkerOptions.workerPort};e=t.port?_PDFWorker.fromPort(t):new _PDFWorker(t),s._worker=e}let m={docId:C,apiVersion:"3.7.107",data:u,password:I,disableAutoFetch:rt,rangeChunkSize:n,length:tt,docBaseUrl:p,enableXfa:O,evaluatorOptions:{maxImageSize:N,disableFontFace:k,ignoreErrors:M,isEvalSupported:P,isOffscreenCanvasSupported:c,canvasMaxAreaInBytes:f,fontExtraProperties:B,useSystemFonts:$,cMapUrl:U?i:null,standardFontDataUrl:U?_:null}},E={ignoreErrors:M,isEvalSupported:P,disableFontFace:k,fontExtraProperties:B,enableXfa:O,ownerDocument:G,disableAutoFetch:rt,pdfBug:Q,styleElement:o};return e.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");let t=_fetchDocument(e,m),r=new Promise(function(h){let g;y?g=new _transport_stream.PDFDataTransportStream({length:tt,initialData:y.initialData,progressiveDone:y.progressiveDone,contentDispositionFilename:y.contentDispositionFilename,disableRange:X,disableStream:K},y):u||(g=createPDFNetworkStream({url:a,length:tt,httpHeaders:F,withCredentials:x,rangeChunkSize:n,disableRange:X,disableStream:K})),h(g)});return Promise.all([t,r]).then(function([h,g]){if(s.destroyed)throw new Error("Loading aborted");let v=new _message_handler.MessageHandler(C,h,e.port),w=new WorkerTransport(v,s,g,E,l);s._transport=w,v.send("Ready",null)})}).catch(s._capability.reject),s}async function _fetchDocument(D,s){if(D.destroyed)throw new Error("Worker was destroyed");let C=await D.messageHandler.sendWithPromise("GetDocRequest",s,s.data?[s.data.buffer]:null);if(D.destroyed)throw new Error("Worker was destroyed");return C}function getUrlProp(D){if(D instanceof URL)return D.href;try{return new URL(D,window.location).href}catch{if(_is_node.isNodeJS&&typeof D=="string")return D}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(D){if(_is_node.isNodeJS&&typeof Buffer<"u"&&D instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(D);if(D instanceof Uint8Array&&D.byteLength===D.buffer.byteLength)return D;if(typeof D=="string")return(0,_util.stringToBytes)(D);if(typeof D=="object"&&!isNaN(D?.length)||(0,_util.isArrayBuffer)(D))return new Uint8Array(D);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(s,C,a=!1,u=null){this.length=s,this.initialData=C,this.progressiveDone=a,this.contentDispositionFilename=u,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,C){for(let a of this._rangeListeners)a(s,C)}onDataProgress(s,C){this._readyCapability.promise.then(()=>{for(let a of this._progressListeners)a(s,C)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(let C of this._progressiveReadListeners)C(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,C){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(s,C){this._pdfInfo=s,this._transport=C}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(s,C,a,u=!1){this._pageIndex=s,this._pageInfo=C,this._transport=a,this._stats=u?new _display_utils.StatTimer:null,this._pdfBug=u,this.commonObjs=a.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:C=this.rotate,offsetX:a=0,offsetY:u=0,dontFlip:F=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:s,rotation:C,offsetX:a,offsetY:u,dontFlip:F})}getAnnotations({intent:s="display"}={}){let C=this._transport.getRenderingIntent(s);return this._transport.getAnnotations(this._pageIndex,C.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:s,viewport:C,intent:a="display",annotationMode:u=_util.AnnotationMode.ENABLE,transform:F=null,background:x=null,optionalContentConfigPromise:I=null,annotationCanvasMap:y=null,pageColors:n=null,printAnnotationStorage:e=null}){if(arguments[0]?.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");this._stats?.time("Overall");let d=this._transport.getRenderingIntent(a,u,e);this.#e=!1,this.#s(),I||(I=this._transport.getOptionalContentConfig());let p=this._intentStates.get(d.cacheKey);p||(p=Object.create(null),this._intentStates.set(d.cacheKey,p)),p.streamReaderCancelTimeout&&(clearTimeout(p.streamReaderCancelTimeout),p.streamReaderCancelTimeout=null);let i=!!(d.renderingIntent&_util.RenderingIntentFlag.PRINT);p.displayReadyCapability||(p.displayReadyCapability=new _util.PromiseCapability,p.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d));let A=b=>{p.renderTasks.delete(T),(this._maybeCleanupAfterRender||i)&&(this.#e=!0),this.#n(!i),b?(T.capability.reject(b),this._abortOperatorList({intentState:p,reason:b instanceof Error?b:new Error(b)})):T.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},T=new InternalRenderTask({callback:A,params:{canvasContext:s,viewport:C,transform:F,background:x},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:y,operatorList:p.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!i,pdfBug:this._pdfBug,pageColors:n});(p.renderTasks||=new Set).add(T);let _=T.task;return Promise.all([p.displayReadyCapability.promise,I]).then(([b,M])=>{if(this.#e){A();return}this._stats?.time("Rendering"),T.initializeGraphics({transparency:b,optionalContentConfig:M}),T.operatorListChanged()}).catch(A),_}getOperatorList({intent:s="display",annotationMode:C=_util.AnnotationMode.ENABLE,printAnnotationStorage:a=null}={}){function u(){x.operatorList.lastChunk&&(x.opListReadCapability.resolve(x.operatorList),x.renderTasks.delete(I))}let F=this._transport.getRenderingIntent(s,C,a,!0),x=this._intentStates.get(F.cacheKey);x||(x=Object.create(null),this._intentStates.set(F.cacheKey,x));let I;return x.opListReadCapability||(I=Object.create(null),I.operatorListChanged=u,x.opListReadCapability=new _util.PromiseCapability,(x.renderTasks||=new Set).add(I),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(F)),x.opListReadCapability.promise}streamTextContent({includeMarkedContent:s=!1,disableNormalization:C=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:s===!0,disableNormalization:C===!0},{highWaterMark:100,size(u){return u.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>_xfa_text.XfaText.textContent(a));let C=this.streamTextContent(s);return new Promise(function(a,u){function F(){x.read().then(function({value:y,done:n}){if(n){a(I);return}Object.assign(I.styles,y.styles),I.items.push(...y.items),F()},u)}let x=C.getReader(),I={items:[],styles:Object.create(null)};F()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let s=[];for(let C of this._intentStates.values())if(this._abortOperatorList({intentState:C,reason:new Error("Page was destroyed."),force:!0}),!C.opListReadCapability)for(let a of C.renderTasks)s.push(a.completed),a.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(s)}cleanup(s=!1){this.#e=!0;let C=this.#n(!1);return s&&C&&(this._stats&&=new _display_utils.StatTimer),C}#n(s=!1){if(this.#s(),!this.#e)return!1;if(s)return this.#t=setTimeout(()=>{this.#t=null,this.#n(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(let{renderTasks:C,operatorList:a}of this._intentStates.values())if(C.size>0||!a.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(s,C){let a=this._intentStates.get(C);a&&(this._stats?.timeEnd("Page Request"),a.displayReadyCapability?.resolve(s))}_renderPageChunk(s,C){for(let a=0,u=s.length;a<u;a++)C.operatorList.fnArray.push(s.fnArray[a]),C.operatorList.argsArray.push(s.argsArray[a]);C.operatorList.lastChunk=s.lastChunk,C.operatorList.separateAnnots=s.separateAnnots;for(let a of C.renderTasks)a.operatorListChanged();s.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:s,cacheKey:C,annotationStorageMap:a}){let F=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:C,annotationStorage:a}).getReader(),x=this._intentStates.get(C);x.streamReader=F;let I=()=>{F.read().then(({value:y,done:n})=>{if(n){x.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,x),I())},y=>{if(x.streamReader=null,!this._transport.destroyed){if(x.operatorList){x.operatorList.lastChunk=!0;for(let n of x.renderTasks)n.operatorListChanged();this.#n(!0)}if(x.displayReadyCapability)x.displayReadyCapability.reject(y);else if(x.opListReadCapability)x.opListReadCapability.reject(y);else throw y}})};I()}_abortOperatorList({intentState:s,reason:C,force:a=!1}){if(s.streamReader){if(s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null),!a){if(s.renderTasks.size>0)return;if(C instanceof _display_utils.RenderingCancelledException){let u=RENDERING_CANCELLED_TIMEOUT;C.extraDelay>0&&C.extraDelay<1e3&&(u+=C.extraDelay),s.streamReaderCancelTimeout=setTimeout(()=>{s.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:s,reason:C,force:!0})},u);return}}if(s.streamReader.cancel(new _util.AbortException(C.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(let[u,F]of this._intentStates)if(F===s){this._intentStates.delete(u);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(s,C){let a={data:structuredClone(s,C?{transfer:C}:null)};this.#e.then(()=>{for(let u of this.#t)u.call(this,a)})}addEventListener(s,C){this.#t.add(C)}removeEventListener(s,C){this.#t.delete(C)}terminate(){this.#t.clear()}}exports.LoopbackPort=LoopbackPort;let PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof Ut=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){let D=document?.currentScript?.src;D&&(PDFWorkerUtil.fallbackWorkerSrc=D.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(D,s){let C;try{if(C=new URL(D),!C.origin||C.origin==="null")return!1}catch{return!1}let a=new URL(s,C);return C.origin===a.origin},PDFWorkerUtil.createCDNWrapper=function(D){let s=`importScripts("${D}");`;return URL.createObjectURL(new Blob([s]))}}class _PDFWorker{static#workerPorts=new WeakMap;constructor({name:D=null,port:s=null,verbosity:C=(0,_util.getVerbosityLevel)()}={}){if(s&&_PDFWorker.#workerPorts.has(s))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=D,this.destroyed=!1,this.verbosity=C,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,s){_PDFWorker.#workerPorts.set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(D){this._port=D,this._messageHandler=new _message_handler.MessageHandler("main","worker",D),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:D}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,D)||(D=PDFWorkerUtil.createCDNWrapper(new URL(D,window.location).href));let s=new Worker(D),C=new _message_handler.MessageHandler("main","worker",s),a=()=>{s.removeEventListener("error",u),C.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},u=()=>{this._webWorker||a()};s.addEventListener("error",u),C.on("test",x=>{if(s.removeEventListener("error",u),this.destroyed){a();return}x?(this._messageHandler=C,this._port=s,this._webWorker=s,this._readyCapability.resolve(),C.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),C.destroy(),s.terminate())}),C.on("ready",x=>{if(s.removeEventListener("error",u),this.destroyed){a();return}try{F()}catch{this._setupFakeWorker()}});let F=()=>{let x=new Uint8Array;C.send("test",x,[x.buffer])};F();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(D=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let s=new LoopbackPort;this._port=s;let C=`fake${PDFWorkerUtil.fakeWorkerId++}`,a=new _message_handler.MessageHandler(C+"_worker",C,s);D.setup(a,s);let u=new _message_handler.MessageHandler(C,C+"_worker",s);this._messageHandler=u,this._readyCapability.resolve(),u.send("configure",{verbosity:this.verbosity})}).catch(D=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${D.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(D){if(!D?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has(D.port)?this.#workerPorts.get(D.port):new _PDFWorker(D)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){let loader=async()=>{let mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof Ut=="function"){let worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=_PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#n=new Map;constructor(s,C,a,u,F){this.messageHandler=s,this.loadingTask=C,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:u.ownerDocument,styleElement:u.styleElement}),this._params=u,this.canvasFactory=F.canvasFactory,this.filterFactory=F.filterFactory,this.cMapReaderFactory=F.cMapReaderFactory,this.standardFontDataFactory=F.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#s(s,C=null){let a=this.#t.get(s);if(a)return a;let u=this.messageHandler.sendWithPromise(s,C);return this.#t.set(s,u),u}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(s,C=_util.AnnotationMode.ENABLE,a=null,u=!1){let F=_util.RenderingIntentFlag.DISPLAY,x=null;switch(s){case"any":F=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":F=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(C){case _util.AnnotationMode.DISABLE:F+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:F+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:F+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,x=(F&_util.RenderingIntentFlag.PRINT&&a instanceof _annotation_storage.PrintAnnotationStorage?a:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${C}`)}return u&&(F+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:F,cacheKey:`${F}_${_annotation_storage.AnnotationStorage.getHash(x)}`,annotationStorageMap:x}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));let s=[];for(let a of this.#e.values())s.push(a._destroy());this.#e.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let C=this.messageHandler.sendWithPromise("Terminate",null);return s.push(C),Promise.all(s).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:s,loadingTask:C}=this;s.on("GetReader",(a,u)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=F=>{this._lastProgress={loaded:F.loaded,total:F.total}},u.onPull=()=>{this._fullReader.read().then(function({value:F,done:x}){if(x){u.close();return}(0,_util.assert)(F instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),u.enqueue(new Uint8Array(F),1,[F])}).catch(F=>{u.error(F)})},u.onCancel=F=>{this._fullReader.cancel(F),u.ready.catch(x=>{if(!this.destroyed)throw x})}}),s.on("ReaderHeadersReady",a=>{let u=new _util.PromiseCapability,F=this._fullReader;return F.headersReady.then(()=>{(!F.isStreamingSupported||!F.isRangeSupported)&&(this._lastProgress&&C.onProgress?.(this._lastProgress),F.onProgress=x=>{C.onProgress?.({loaded:x.loaded,total:x.total})}),u.resolve({isStreamingSupported:F.isStreamingSupported,isRangeSupported:F.isRangeSupported,contentLength:F.contentLength})},u.reject),u.promise}),s.on("GetRangeReader",(a,u)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let F=this._networkStream.getRangeReader(a.begin,a.end);if(!F){u.close();return}u.onPull=()=>{F.read().then(function({value:x,done:I}){if(I){u.close();return}(0,_util.assert)(x instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),u.enqueue(new Uint8Array(x),1,[x])}).catch(x=>{u.error(x)})},u.onCancel=x=>{F.cancel(x),u.ready.catch(I=>{if(!this.destroyed)throw I})}}),s.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,C._capability.resolve(new PDFDocumentProxy(a,this))}),s.on("DocException",function(a){let u;switch(a.name){case"PasswordException":u=new _util.PasswordException(a.message,a.code);break;case"InvalidPDFException":u=new _util.InvalidPDFException(a.message);break;case"MissingPDFException":u=new _util.MissingPDFException(a.message);break;case"UnexpectedResponseException":u=new _util.UnexpectedResponseException(a.message,a.status);break;case"UnknownErrorException":u=new _util.UnknownErrorException(a.message,a.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}C._capability.reject(u)}),s.on("PasswordRequest",a=>{if(this._passwordCapability=new _util.PromiseCapability,C.onPassword){let u=F=>{F instanceof Error?this._passwordCapability.reject(F):this._passwordCapability.resolve({password:F})};try{C.onPassword(u,a.code)}catch(F){this._passwordCapability.reject(F)}}else this._passwordCapability.reject(new _util.PasswordException(a.message,a.code));return this._passwordCapability.promise}),s.on("DataLoaded",a=>{C.onProgress?.({loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),s.on("StartRenderPage",a=>{if(this.destroyed)return;this.#e.get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),s.on("commonobj",([a,u,F])=>{if(!this.destroyed&&!this.commonObjs.has(a))switch(u){case"Font":let x=this._params;if("error"in F){let n=F.error;(0,_util.warn)(`Error during font loading: ${n}`),this.commonObjs.resolve(a,n);break}let I=x.pdfBug&&globalThis.FontInspector?.enabled?(n,e)=>globalThis.FontInspector.fontAdded(n,e):null,y=new _font_loader.FontFaceObject(F,{isEvalSupported:x.isEvalSupported,disableFontFace:x.disableFontFace,ignoreErrors:x.ignoreErrors,inspectFont:I});this.fontLoader.bind(y).catch(n=>s.sendWithPromise("FontFallback",{id:a})).finally(()=>{!x.fontExtraProperties&&y.data&&(y.data=null),this.commonObjs.resolve(a,y)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(a,F);break;default:throw new Error(`Got unknown common object type ${u}`)}}),s.on("obj",([a,u,F,x])=>{if(this.destroyed)return;let I=this.#e.get(u);if(!I.objs.has(a))switch(F){case"Image":if(I.objs.resolve(a,x),x){let y;if(x.bitmap){let{width:n,height:e}=x;y=n*e*4}else y=x.data?.length||0;y>_util.MAX_IMAGE_SIZE_TO_CACHE&&(I._maybeCleanupAfterRender=!0)}break;case"Pattern":I.objs.resolve(a,x);break;default:throw new Error(`Got unknown object type ${F}`)}}),s.on("DocProgress",a=>{this.destroyed||C.onProgress?.({loaded:a.loaded,total:a.total})}),s.on("FetchBuiltInCMap",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(a):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(a):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));let C=s-1,a=this.#n.get(C);if(a)return a;let u=this.messageHandler.sendWithPromise("GetPage",{pageIndex:C}).then(F=>{if(this.destroyed)throw new Error("Transport destroyed");let x=new PDFPageProxy(C,F,this,this._params.pdfBug);return this.#e.set(C,x),x});return this.#n.set(C,u),u}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,C){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:C})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new _optional_content_config.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let s="GetMetadata",C=this.#t.get(s);if(C)return C;let a=this.messageHandler.sendWithPromise(s,null).then(u=>({info:u[0],metadata:u[1]?new _metadata.Metadata(u[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(s,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(s=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(let C of this.#e.values())if(!C.cleanup())throw new Error(`startCleanup: Page ${C.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){let{disableAutoFetch:s,enableXfa:C}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:s,enableXfa:C})}}class PDFObjects{#t=Object.create(null);#e(s){let C=this.#t[s];return C||(this.#t[s]={capability:new _util.PromiseCapability,data:null})}get(s,C=null){if(C){let u=this.#e(s);return u.capability.promise.then(()=>C(u.data)),null}let a=this.#t[s];if(!a?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${s}.`);return a.data}has(s){return this.#t[s]?.capability.settled||!1}resolve(s,C=null){let a=this.#e(s);a.data=C,a.capability.resolve()}clear(){for(let s in this.#t){let{data:C}=this.#t[s];C?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(s){this.#t=s,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(s=0){this.#t.cancel(null,s)}get separateAnnots(){let{separateAnnots:s}=this.#t.operatorList;if(!s)return!1;let{annotationCanvasMap:C}=this.#t;return s.form||s.canvas&&C?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:s,params:C,objs:a,commonObjs:u,annotationCanvasMap:F,operatorList:x,pageIndex:I,canvasFactory:y,filterFactory:n,useRequestAnimationFrame:e=!1,pdfBug:d=!1,pageColors:p=null}){this.callback=s,this.params=C,this.objs=a,this.commonObjs=u,this.annotationCanvasMap=F,this.operatorListIdx=null,this.operatorList=x,this._pageIndex=I,this.canvasFactory=y,this.filterFactory=n,this._pdfBug=d,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=e===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=C.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:C}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:a,viewport:u,transform:F,background:x}=this.params;this.gfx=new _canvas.CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:C},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:F,viewport:u,transparency:s,background:x}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(s=null,C=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback(s||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",C))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&InternalRenderTask.#t.delete(this._canvas),this.callback())))}}let version="3.7.107";exports.version=version;let build="036f855dc";exports.build=build},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PrintAnnotationStorage=s.AnnotationStorage=void 0;var a=C(1),u=C(4),F=C(8);class x{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(n,e){let d=this.#e.get(n);return d===void 0?e:Object.assign(e,d)}getRawValue(n){return this.#e.get(n)}remove(n){if(this.#e.delete(n),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let e of this.#e.values())if(e instanceof u.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(n,e){let d=this.#e.get(n),p=!1;if(d!==void 0)for(let[i,A]of Object.entries(e))d[i]!==A&&(p=!0,d[i]=A);else p=!0,this.#e.set(n,e);p&&this.#n(),e instanceof u.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(n){return this.#e.has(n)}getAll(){return this.#e.size>0?(0,a.objectFromMap)(this.#e):null}setAll(n){for(let[e,d]of Object.entries(n))this.setValue(e,d)}get size(){return this.#e.size}#n(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new I(this)}get serializable(){if(this.#e.size===0)return null;let n=new Map;for(let[e,d]of this.#e){let p=d instanceof u.AnnotationEditor?d.serialize():d;p&&n.set(e,p)}return n}static getHash(n){if(!n)return"";let e=new F.MurmurHash3_64;for(let[d,p]of n)e.update(`${d}:${JSON.stringify(p)}`);return e.hexdigest()}}s.AnnotationStorage=x;class I extends x{#t=null;constructor(n){super(),this.#t=structuredClone(n.serializable)}get print(){(0,a.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}s.PrintAnnotationStorage=I},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationEditor=void 0;var a=C(5),u=C(1);class F{#t=this.focusin.bind(this);#e=this.focusout.bind(this);#n=!1;#s=!1;#r=!1;_uiManager=null;#d=F._zIndex++;static _colorManager=new a.ColorManager;static _zIndex=1;constructor(I){this.constructor===F&&(0,u.unreachable)("Cannot initialize AnnotationEditor."),this.parent=I.parent,this.id=I.id,this.width=this.height=null,this.pageIndex=I.parent.pageIndex,this.name=I.name,this.div=null,this._uiManager=I.uiManager;let{rotation:y,rawDims:{pageWidth:n,pageHeight:e,pageX:d,pageY:p}}=this.parent.viewport;this.rotation=y,this.pageRotation=(360+y-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,e],this.pageTranslation=[d,p];let[i,A]=this.parentDimensions;this.x=I.x/i,this.y=I.y/A,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,u.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(I){this._uiManager.addCommands(I)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#d}setParent(I){I!==null&&(this.pageIndex=I.pageIndex,this.pageDimensions=I.pageDimensions),this.parent=I}focusin(I){this.#n?this.#n=!1:this.parent.setSelected(this)}focusout(I){!this.isAttachedToDOM||I.relatedTarget?.closest(`#${this.id}`)||(I.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(I){let y=this.parent.div.getBoundingClientRect();this.startX=I.clientX-y.x,this.startY=I.clientY-y.y,I.dataTransfer.setData("text/plain",this.id),I.dataTransfer.effectAllowed="move"}setAt(I,y,n,e){let[d,p]=this.parentDimensions;[n,e]=this.screenToPageTranslation(n,e),this.x=(I+n)/d,this.y=(y+e)/p,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(I,y){let[n,e]=this.parentDimensions;[I,y]=this.screenToPageTranslation(I,y),this.x+=I/n,this.y+=y/e,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(I,y){switch(this.parentRotation){case 90:return[y,-I];case 180:return[-I,-y];case 270:return[-y,I];default:return[I,y]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{realScale:I}=this._uiManager.viewParameters,[y,n]=this.pageDimensions;return[y*I,n*I]}setDims(I,y){let[n,e]=this.parentDimensions;this.div.style.width=`${100*I/n}%`,this.div.style.height=`${100*y/e}%`}fixDims(){let{style:I}=this.div,{height:y,width:n}=I,e=n.endsWith("%"),d=y.endsWith("%");if(e&&d)return;let[p,i]=this.parentDimensions;e||(I.width=`${100*parseFloat(n)/p}%`),d||(I.height=`${100*parseFloat(y)/i}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#t),this.div.addEventListener("focusout",this.#e);let[I,y]=this.getInitialTranslation();return this.translate(I,y),(0,a.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(I){let{isMac:y}=u.FeatureTest.platform;if(I.button!==0||I.ctrlKey&&y){I.preventDefault();return}I.ctrlKey&&!y||I.shiftKey||I.metaKey&&y?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#n=!0}getRect(I,y){let n=this.parentScale,[e,d]=this.pageDimensions,[p,i]=this.pageTranslation,A=I/n,T=y/n,_=this.x*e,b=this.y*d,M=this.width*e,N=this.height*d;switch(this.rotation){case 0:return[_+A+p,d-b-T-N+i,_+A+M+p,d-b-T+i];case 90:return[_+T+p,d-b+A+i,_+T+N+p,d-b+A+M+i];case 180:return[_-A-M+p,d-b+T+i,_-A+p,d-b+T+N+i];case 270:return[_-T-N+p,d-b-A-M+i,_-T+p,d-b-A+i];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(I,y){let[n,e,d,p]=I,i=d-n,A=p-e;switch(this.rotation){case 0:return[n,y-p,i,A];case 90:return[n,y-e,A,i];case 180:return[d,y-e,i,A];case 270:return[d,y-p,A,i];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#r=!0}disableEditMode(){this.#r=!1}isInEditMode(){return this.#r}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#t)}serialize(){(0,u.unreachable)("An editor must be serializable")}static deserialize(I,y,n){let e=new this.prototype.constructor({parent:y,id:y.getNextId(),uiManager:n});e.rotation=I.rotation;let[d,p]=e.pageDimensions,[i,A,T,_]=e.getRectInCurrentCoords(I.rect,p);return e.x=i/d,e.y=A/p,e.width=T/d,e.height=_/p,e}remove(){this.div.removeEventListener("focusin",this.#t),this.div.removeEventListener("focusout",this.#e),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(I,y){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#s}set isEditing(I){this.#s=I,I?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}s.AnnotationEditor=F},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.KeyboardManager=s.CommandManager=s.ColorManager=s.AnnotationEditorUIManager=void 0,s.bindEvents=F,s.opacityToHex=x;var a=C(1),u=C(6);function F(p,i,A){for(let T of A)i.addEventListener(T,p[T].bind(p))}function x(p){return Math.round(Math.min(255,Math.max(1,255*p))).toString(16).padStart(2,"0")}class I{#t=0;getId(){return`${a.AnnotationEditorPrefix}${this.#t++}`}}class y{#t=[];#e=!1;#n;#s=-1;constructor(i=128){this.#n=i}add({cmd:i,undo:A,mustExec:T,type:_=NaN,overwriteIfSameType:b=!1,keepUndo:M=!1}){if(T&&i(),this.#e)return;let N={cmd:i,undo:A,type:_};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(N);return}if(b&&this.#t[this.#s].type===_){M&&(N.undo=this.#t[this.#s].undo),this.#t[this.#s]=N;return}let P=this.#s+1;P===this.#n?this.#t.splice(0,1):(this.#s=P,P<this.#t.length&&this.#t.splice(P)),this.#t.push(N)}undo(){this.#s!==-1&&(this.#e=!0,this.#t[this.#s].undo(),this.#e=!1,this.#s-=1)}redo(){this.#s<this.#t.length-1&&(this.#s+=1,this.#e=!0,this.#t[this.#s].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}s.CommandManager=y;class n{constructor(i){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:A}=a.FeatureTest.platform;for(let[T,_]of i)for(let b of T){let M=b.startsWith("mac+");A&&M?(this.callbacks.set(b.slice(4),_),this.allKeys.add(b.split("+").at(-1))):!A&&!M&&(this.callbacks.set(b,_),this.allKeys.add(b.split("+").at(-1)))}}#t(i){i.altKey&&this.buffer.push("alt"),i.ctrlKey&&this.buffer.push("ctrl"),i.metaKey&&this.buffer.push("meta"),i.shiftKey&&this.buffer.push("shift"),this.buffer.push(i.key);let A=this.buffer.join("+");return this.buffer.length=0,A}exec(i,A){if(!this.allKeys.has(A.key))return;let T=this.callbacks.get(this.#t(A));T&&(T.bind(i)(),A.stopPropagation(),A.preventDefault())}}s.KeyboardManager=n;class e{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let i=new Map([["CanvasText",null],["Canvas",null]]);return(0,u.getColorValues)(i),(0,a.shadow)(this,"_colors",i)}convert(i){let A=(0,u.getRGB)(i);if(!window.matchMedia("(forced-colors: active)").matches)return A;for(let[T,_]of this._colors)if(_.every((b,M)=>b===A[M]))return e._colorsMapping.get(T);return A}getHexCode(i){let A=this._colors.get(i);return A?a.Util.makeHexColor(...A):i}}s.ColorManager=e;class d{#t=null;#e=new Map;#n=new Map;#s=null;#r=new y;#d=0;#c=null;#i=new Set;#a=null;#h=new I;#l=!1;#u=a.AnnotationEditorType.NONE;#o=new Set;#b=this.copy.bind(this);#A=this.cut.bind(this);#m=this.paste.bind(this);#T=this.keydown.bind(this);#P=this.onEditingAction.bind(this);#w=this.onPageChanging.bind(this);#x=this.onScaleChanging.bind(this);#v=this.onRotationChanging.bind(this);#k={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#_=null;static _keyboardManager=new n([[["ctrl+a","mac+meta+a"],d.prototype.selectAll],[["ctrl+z","mac+meta+z"],d.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],d.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],d.prototype.delete],[["Escape","mac+Escape"],d.prototype.unselectAll]]);constructor(i,A,T){this.#_=i,this.#a=A,this.#a._on("editingaction",this.#P),this.#a._on("pagechanging",this.#w),this.#a._on("scalechanging",this.#x),this.#a._on("rotationchanging",this.#v),this.#s=T,this.viewParameters={realScale:u.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#F(),this.#a._off("editingaction",this.#P),this.#a._off("pagechanging",this.#w),this.#a._off("scalechanging",this.#x),this.#a._off("rotationchanging",this.#v);for(let i of this.#n.values())i.destroy();this.#n.clear(),this.#e.clear(),this.#i.clear(),this.#t=null,this.#o.clear(),this.#r.destroy()}onPageChanging({pageNumber:i}){this.#d=i-1}focusMainContainer(){this.#_.focus()}addShouldRescale(i){this.#i.add(i)}removeShouldRescale(i){this.#i.delete(i)}onScaleChanging({scale:i}){this.commitOrRemove(),this.viewParameters.realScale=i*u.PixelsPerInch.PDF_TO_CSS_UNITS;for(let A of this.#i)A.onScaleChanging()}onRotationChanging({pagesRotation:i}){this.commitOrRemove(),this.viewParameters.rotation=i}addToAnnotationStorage(i){!i.isEmpty()&&this.#s&&!this.#s.has(i.id)&&this.#s.setValue(i.id,i)}#M(){this.#_.addEventListener("keydown",this.#T)}#F(){this.#_.removeEventListener("keydown",this.#T)}#D(){document.addEventListener("copy",this.#b),document.addEventListener("cut",this.#A),document.addEventListener("paste",this.#m)}#O(){document.removeEventListener("copy",this.#b),document.removeEventListener("cut",this.#A),document.removeEventListener("paste",this.#m)}copy(i){if(i.preventDefault(),this.#t&&this.#t.commitOrRemove(),!this.hasSelection)return;let A=[];for(let T of this.#o)T.isEmpty()||A.push(T.serialize());A.length!==0&&i.clipboardData.setData("application/pdfjs",JSON.stringify(A))}cut(i){this.copy(i),this.delete()}paste(i){i.preventDefault();let A=i.clipboardData.getData("application/pdfjs");if(!A)return;try{A=JSON.parse(A)}catch(_){(0,a.warn)(`paste: "${_.message}".`);return}if(!Array.isArray(A))return;this.unselectAll();let T=this.#n.get(this.#d);try{let _=[];for(let N of A){let P=T.deserialize(N);if(!P)return;_.push(P)}let b=()=>{for(let N of _)this.#y(N);this.#E(_)},M=()=>{for(let N of _)N.remove()};this.addCommands({cmd:b,undo:M,mustExec:!0})}catch(_){(0,a.warn)(`paste: "${_.message}".`)}}keydown(i){this.getActive()?.shouldGetKeyboardEvents()||d._keyboardManager.exec(this,i)}onEditingAction(i){["undo","redo","delete","selectAll"].includes(i.name)&&this[i.name]()}#f(i){Object.entries(i).some(([T,_])=>this.#k[T]!==_)&&this.#a.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#k,i)})}#p(i){this.#a.dispatch("annotationeditorparamschanged",{source:this,details:i})}setEditingState(i){i?(this.#M(),this.#D(),this.#f({isEditing:this.#u!==a.AnnotationEditorType.NONE,isEmpty:this.#g(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#F(),this.#O(),this.#f({isEditing:!1}))}registerEditorTypes(i){if(!this.#c){this.#c=i;for(let A of this.#c)this.#p(A.defaultPropertiesToUpdate)}}getId(){return this.#h.getId()}get currentLayer(){return this.#n.get(this.#d)}get currentPageIndex(){return this.#d}addLayer(i){this.#n.set(i.pageIndex,i),this.#l?i.enable():i.disable()}removeLayer(i){this.#n.delete(i.pageIndex)}updateMode(i){if(this.#u=i,i===a.AnnotationEditorType.NONE)this.setEditingState(!1),this.#S();else{this.setEditingState(!0),this.#R();for(let A of this.#n.values())A.updateMode(i)}}updateToolbar(i){i!==this.#u&&this.#a.dispatch("switchannotationeditormode",{source:this,mode:i})}updateParams(i,A){if(this.#c){for(let T of this.#o)T.updateParams(i,A);for(let T of this.#c)T.updateDefaultParams(i,A)}}#R(){if(!this.#l){this.#l=!0;for(let i of this.#n.values())i.enable()}}#S(){if(this.unselectAll(),this.#l){this.#l=!1;for(let i of this.#n.values())i.disable()}}getEditors(i){let A=[];for(let T of this.#e.values())T.pageIndex===i&&A.push(T);return A}getEditor(i){return this.#e.get(i)}addEditor(i){this.#e.set(i.id,i)}removeEditor(i){this.#e.delete(i.id),this.unselect(i),this.#s?.remove(i.id)}#y(i){let A=this.#n.get(i.pageIndex);A?A.addOrRebuild(i):this.addEditor(i)}setActiveEditor(i){this.#t!==i&&(this.#t=i,i&&this.#p(i.propertiesToUpdate))}toggleSelected(i){if(this.#o.has(i)){this.#o.delete(i),i.unselect(),this.#f({hasSelectedEditor:this.hasSelection});return}this.#o.add(i),i.select(),this.#p(i.propertiesToUpdate),this.#f({hasSelectedEditor:!0})}setSelected(i){for(let A of this.#o)A!==i&&A.unselect();this.#o.clear(),this.#o.add(i),i.select(),this.#p(i.propertiesToUpdate),this.#f({hasSelectedEditor:!0})}isSelected(i){return this.#o.has(i)}unselect(i){i.unselect(),this.#o.delete(i),this.#f({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#o.size!==0}undo(){this.#r.undo(),this.#f({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#g()})}redo(){this.#r.redo(),this.#f({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#g()})}addCommands(i){this.#r.add(i),this.#f({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#g()})}#g(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(let i of this.#e.values())return i.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let i=[...this.#o],A=()=>{for(let _ of i)_.remove()},T=()=>{for(let _ of i)this.#y(_)};this.addCommands({cmd:A,undo:T,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}#E(i){this.#o.clear();for(let A of i)A.isEmpty()||(this.#o.add(A),A.select());this.#f({hasSelectedEditor:!0})}selectAll(){for(let i of this.#o)i.commit();this.#E(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.#o.size!==0){for(let i of this.#o)i.unselect();this.#o.clear(),this.#f({hasSelectedEditor:!1})}}isActive(i){return this.#t===i}getActive(){return this.#t}getMode(){return this.#u}}s.AnnotationEditorUIManager=d},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.StatTimer=s.RenderingCancelledException=s.PixelsPerInch=s.PageViewport=s.PDFDateString=s.DOMStandardFontDataFactory=s.DOMSVGFactory=s.DOMFilterFactory=s.DOMCanvasFactory=s.DOMCMapReaderFactory=s.AnnotationPrefix=void 0,s.deprecated=k,s.getColorValues=K,s.getCurrentTransform=rt,s.getCurrentTransformInverse=Q,s.getFilenameFromUrl=M,s.getPdfFilenameFromUrl=N,s.getRGB=X,s.getXfaPageViewport=G,s.isDataScheme=_,s.isPdfFile=b,s.isValidFetchUrl=c,s.loadScript=f,s.setLayerDimensions=tt;var a=C(7),u=C(1);let F="http://www.w3.org/2000/svg",x="pdfjs_internal_id_";s.AnnotationPrefix=x;class I{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}s.PixelsPerInch=I;class y extends a.BaseFilterFactory{#t;#e;#n;#s;#r;#d;#c;#i=0;constructor({docId:U,ownerDocument:L=globalThis.document}={}){super(),this.#n=U,this.#s=L}get#a(){return this.#t||=new Map}get#h(){if(!this.#e){let U=this.#s.createElement("div"),{style:L}=U;L.visibility="hidden",L.contain="strict",L.width=L.height=0,L.position="absolute",L.top=L.left=0,L.zIndex=-1;let S=this.#s.createElementNS(F,"svg");S.setAttribute("width",0),S.setAttribute("height",0),this.#e=this.#s.createElementNS(F,"defs"),U.append(S),S.append(this.#e),this.#s.body.append(U)}return this.#e}#l(U,L,S){let o=this.#s.createElementNS(F,L);o.setAttribute("type","discrete"),o.setAttribute("tableValues",S),U.append(o)}addFilter(U){if(!U)return"none";let L=this.#a.get(U);if(L)return L;let S,o,l,m;if(U.length===1){let g=U[0],v=new Array(256);for(let w=0;w<256;w++)v[w]=g[w]/255;m=S=o=l=v.join(",")}else{let[g,v,w]=U,R=new Array(256),j=new Array(256),z=new Array(256);for(let W=0;W<256;W++)R[W]=g[W]/255,j[W]=v[W]/255,z[W]=w[W]/255;S=R.join(","),o=j.join(","),l=z.join(","),m=`${S}${o}${l}`}if(L=this.#a.get(m),L)return this.#a.set(U,L),L;let E=`g_${this.#n}_transfer_map_${this.#i++}`,t=`url(#${E})`;this.#a.set(U,t),this.#a.set(m,t);let r=this.#s.createElementNS(F,"filter",F);r.setAttribute("id",E),r.setAttribute("color-interpolation-filters","sRGB");let h=this.#s.createElementNS(F,"feComponentTransfer");return r.append(h),this.#l(h,"feFuncR",S),this.#l(h,"feFuncG",o),this.#l(h,"feFuncB",l),this.#h.append(r),t}addHCMFilter(U,L){let S=`${U}-${L}`;if(this.#d===S)return this.#c;if(this.#d=S,this.#c="none",this.#r?.remove(),!U||!L)return this.#c;this.#h.style.color=U,U=getComputedStyle(this.#h).getPropertyValue("color");let o=X(U);U=u.Util.makeHexColor(...o),this.#h.style.color=L,L=getComputedStyle(this.#h).getPropertyValue("color");let l=X(L);if(L=u.Util.makeHexColor(...l),this.#h.style.color="",U==="#000000"&&L==="#ffffff"||U===L)return this.#c;let m=new Array(256);for(let w=0;w<=255;w++){let R=w/255;m[w]=R<=.03928?R/12.92:((R+.055)/1.055)**2.4}let E=m.join(","),t=`g_${this.#n}_hcm_filter`,r=this.#r=this.#s.createElementNS(F,"filter",F);r.setAttribute("id",t),r.setAttribute("color-interpolation-filters","sRGB");let h=this.#s.createElementNS(F,"feComponentTransfer");r.append(h),this.#l(h,"feFuncR",E),this.#l(h,"feFuncG",E),this.#l(h,"feFuncB",E);let g=this.#s.createElementNS(F,"feColorMatrix");g.setAttribute("type","matrix"),g.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),r.append(g),h=this.#s.createElementNS(F,"feComponentTransfer"),r.append(h);let v=(w,R)=>{let j=o[w]/255,z=l[w]/255,W=new Array(R+1);for(let V=0;V<=R;V++)W[V]=j+V/R*(z-j);return W.join(",")};return this.#l(h,"feFuncR",v(0,5)),this.#l(h,"feFuncG",v(1,5)),this.#l(h,"feFuncB",v(2,5)),this.#h.append(r),this.#c=`url(#${t})`,this.#c}destroy(U=!1){U&&this.#c||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#i=0)}}s.DOMFilterFactory=y;class n extends a.BaseCanvasFactory{constructor({ownerDocument:U=globalThis.document}={}){super(),this._document=U}_createCanvas(U,L){let S=this._document.createElement("canvas");return S.width=U,S.height=L,S}}s.DOMCanvasFactory=n;async function e($,U=!1){if(c($,document.baseURI)){let L=await fetch($);if(!L.ok)throw new Error(L.statusText);return U?new Uint8Array(await L.arrayBuffer()):(0,u.stringToBytes)(await L.text())}return new Promise((L,S)=>{let o=new XMLHttpRequest;o.open("GET",$,!0),U&&(o.responseType="arraybuffer"),o.onreadystatechange=()=>{if(o.readyState===XMLHttpRequest.DONE){if(o.status===200||o.status===0){let l;if(U&&o.response?l=new Uint8Array(o.response):!U&&o.responseText&&(l=(0,u.stringToBytes)(o.responseText)),l){L(l);return}}S(new Error(o.statusText))}},o.send(null)})}class d extends a.BaseCMapReaderFactory{_fetchData(U,L){return e(U,this.isCompressed).then(S=>({cMapData:S,compressionType:L}))}}s.DOMCMapReaderFactory=d;class p extends a.BaseStandardFontDataFactory{_fetchData(U){return e(U,!0)}}s.DOMStandardFontDataFactory=p;class i extends a.BaseSVGFactory{_createSVG(U){return document.createElementNS(F,U)}}s.DOMSVGFactory=i;class A{constructor({viewBox:U,scale:L,rotation:S,offsetX:o=0,offsetY:l=0,dontFlip:m=!1}){this.viewBox=U,this.scale=L,this.rotation=S,this.offsetX=o,this.offsetY=l;let E=(U[2]+U[0])/2,t=(U[3]+U[1])/2,r,h,g,v;switch(S%=360,S<0&&(S+=360),S){case 180:r=-1,h=0,g=0,v=1;break;case 90:r=0,h=1,g=1,v=0;break;case 270:r=0,h=-1,g=-1,v=0;break;case 0:r=1,h=0,g=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}m&&(g=-g,v=-v);let w,R,j,z;r===0?(w=Math.abs(t-U[1])*L+o,R=Math.abs(E-U[0])*L+l,j=(U[3]-U[1])*L,z=(U[2]-U[0])*L):(w=Math.abs(E-U[0])*L+o,R=Math.abs(t-U[1])*L+l,j=(U[2]-U[0])*L,z=(U[3]-U[1])*L),this.transform=[r*L,h*L,g*L,v*L,w-r*L*E-g*L*t,R-h*L*E-v*L*t],this.width=j,this.height=z}get rawDims(){let{viewBox:U}=this;return(0,u.shadow)(this,"rawDims",{pageWidth:U[2]-U[0],pageHeight:U[3]-U[1],pageX:U[0],pageY:U[1]})}clone({scale:U=this.scale,rotation:L=this.rotation,offsetX:S=this.offsetX,offsetY:o=this.offsetY,dontFlip:l=!1}={}){return new A({viewBox:this.viewBox.slice(),scale:U,rotation:L,offsetX:S,offsetY:o,dontFlip:l})}convertToViewportPoint(U,L){return u.Util.applyTransform([U,L],this.transform)}convertToViewportRectangle(U){let L=u.Util.applyTransform([U[0],U[1]],this.transform),S=u.Util.applyTransform([U[2],U[3]],this.transform);return[L[0],L[1],S[0],S[1]]}convertToPdfPoint(U,L){return u.Util.applyInverseTransform([U,L],this.transform)}}s.PageViewport=A;class T extends u.BaseException{constructor(U,L,S=0){super(U,"RenderingCancelledException"),this.type=L,this.extraDelay=S}}s.RenderingCancelledException=T;function _($){let U=$.length,L=0;for(;L<U&&$[L].trim()==="";)L++;return $.substring(L,L+5).toLowerCase()==="data:"}function b($){return typeof $=="string"&&/\.pdf$/i.test($)}function M($,U=!1){return U||([$]=$.split(/[#?]/,1)),$.substring($.lastIndexOf("/")+1)}function N($,U="document.pdf"){if(typeof $!="string")return U;if(_($))return(0,u.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),U;let L=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,S=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,o=L.exec($),l=S.exec(o[1])||S.exec(o[2])||S.exec(o[3]);if(l&&(l=l[0],l.includes("%")))try{l=S.exec(decodeURIComponent(l))[0]}catch{}return l||U}class P{started=Object.create(null);times=[];time(U){U in this.started&&(0,u.warn)(`Timer is already running for ${U}`),this.started[U]=Date.now()}timeEnd(U){U in this.started||(0,u.warn)(`Timer has not been started for ${U}`),this.times.push({name:U,start:this.started[U],end:Date.now()}),delete this.started[U]}toString(){let U=[],L=0;for(let{name:S}of this.times)L=Math.max(S.length,L);for(let{name:S,start:o,end:l}of this.times)U.push(`${S.padEnd(L)} ${l-o}ms
`);return U.join("")}}s.StatTimer=P;function c($,U){try{let{protocol:L}=U?new URL($,U):new URL($);return L==="http:"||L==="https:"}catch{return!1}}function f($,U=!1){return new Promise((L,S)=>{let o=document.createElement("script");o.src=$,o.onload=function(l){U&&o.remove(),L(l)},o.onerror=function(){S(new Error(`Cannot load script at: ${o.src}`))},(document.head||document.documentElement).append(o)})}function k($){console.log("Deprecated API usage: "+$)}let B;class O{static toDateObject(U){if(!U||typeof U!="string")return null;B||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let L=B.exec(U);if(!L)return null;let S=parseInt(L[1],10),o=parseInt(L[2],10);o=o>=1&&o<=12?o-1:0;let l=parseInt(L[3],10);l=l>=1&&l<=31?l:1;let m=parseInt(L[4],10);m=m>=0&&m<=23?m:0;let E=parseInt(L[5],10);E=E>=0&&E<=59?E:0;let t=parseInt(L[6],10);t=t>=0&&t<=59?t:0;let r=L[7]||"Z",h=parseInt(L[8],10);h=h>=0&&h<=23?h:0;let g=parseInt(L[9],10)||0;return g=g>=0&&g<=59?g:0,r==="-"?(m+=h,E+=g):r==="+"&&(m-=h,E-=g),new Date(Date.UTC(S,o,l,m,E,t))}}s.PDFDateString=O;function G($,{scale:U=1,rotation:L=0}){let{width:S,height:o}=$.attributes.style,l=[0,0,parseInt(S),parseInt(o)];return new A({viewBox:l,scale:U,rotation:L})}function X($){if($.startsWith("#")){let U=parseInt($.slice(1),16);return[(U&16711680)>>16,(U&65280)>>8,U&255]}return $.startsWith("rgb(")?$.slice(4,-1).split(",").map(U=>parseInt(U)):$.startsWith("rgba(")?$.slice(5,-1).split(",").map(U=>parseInt(U)).slice(0,3):((0,u.warn)(`Not a valid color format: "${$}"`),[0,0,0])}function K($){let U=document.createElement("span");U.style.visibility="hidden",document.body.append(U);for(let L of $.keys()){U.style.color=L;let S=window.getComputedStyle(U).color;$.set(L,X(S))}U.remove()}function rt($){let{a:U,b:L,c:S,d:o,e:l,f:m}=$.getTransform();return[U,L,S,o,l,m]}function Q($){let{a:U,b:L,c:S,d:o,e:l,f:m}=$.getTransform().invertSelf();return[U,L,S,o,l,m]}function tt($,U,L=!1,S=!0){if(U instanceof A){let{pageWidth:o,pageHeight:l}=U.rawDims,{style:m}=$,E=`calc(var(--scale-factor) * ${o}px)`,t=`calc(var(--scale-factor) * ${l}px)`;!L||U.rotation%180===0?(m.width=E,m.height=t):(m.width=t,m.height=E)}S&&$.setAttribute("data-main-rotation",U.rotation)}},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BaseStandardFontDataFactory=s.BaseSVGFactory=s.BaseFilterFactory=s.BaseCanvasFactory=s.BaseCMapReaderFactory=void 0;var a=C(1);class u{constructor(){this.constructor===u&&(0,a.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(e){return"none"}addHCMFilter(e,d){return"none"}destroy(e=!1){}}s.BaseFilterFactory=u;class F{constructor(){this.constructor===F&&(0,a.unreachable)("Cannot initialize BaseCanvasFactory.")}create(e,d){if(e<=0||d<=0)throw new Error("Invalid canvas size");let p=this._createCanvas(e,d);return{canvas:p,context:p.getContext("2d")}}reset(e,d,p){if(!e.canvas)throw new Error("Canvas is not specified");if(d<=0||p<=0)throw new Error("Invalid canvas size");e.canvas.width=d,e.canvas.height=p}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,d){(0,a.unreachable)("Abstract method `_createCanvas` called.")}}s.BaseCanvasFactory=F;class x{constructor({baseUrl:e=null,isCompressed:d=!0}){this.constructor===x&&(0,a.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=e,this.isCompressed=d}async fetch({name:e}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!e)throw new Error("CMap name must be specified.");let d=this.baseUrl+e+(this.isCompressed?".bcmap":""),p=this.isCompressed?a.CMapCompressionType.BINARY:a.CMapCompressionType.NONE;return this._fetchData(d,p).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${d}`)})}_fetchData(e,d){(0,a.unreachable)("Abstract method `_fetchData` called.")}}s.BaseCMapReaderFactory=x;class I{constructor({baseUrl:e=null}){this.constructor===I&&(0,a.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!e)throw new Error("Font filename must be specified.");let d=`${this.baseUrl}${e}`;return this._fetchData(d).catch(p=>{throw new Error(`Unable to load font data at: ${d}`)})}_fetchData(e){(0,a.unreachable)("Abstract method `_fetchData` called.")}}s.BaseStandardFontDataFactory=I;class y{constructor(){this.constructor===y&&(0,a.unreachable)("Cannot initialize BaseSVGFactory.")}create(e,d,p=!1){if(e<=0||d<=0)throw new Error("Invalid SVG dimensions");let i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),p||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${d}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${d}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){(0,a.unreachable)("Abstract method `_createSVG` called.")}}s.BaseSVGFactory=y},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.MurmurHash3_64=void 0;var a=C(1);let u=3285377520,F=4294901760,x=65535;class I{constructor(n){this.h1=n?n&4294967295:u,this.h2=n?n&4294967295:u}update(n){let e,d;if(typeof n=="string"){e=new Uint8Array(n.length*2),d=0;for(let k=0,B=n.length;k<B;k++){let O=n.charCodeAt(k);O<=255?e[d++]=O:(e[d++]=O>>>8,e[d++]=O&255)}}else if((0,a.isArrayBuffer)(n))e=n.slice(),d=e.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");let p=d>>2,i=d-p*4,A=new Uint32Array(e.buffer,0,p),T=0,_=0,b=this.h1,M=this.h2,N=3432918353,P=461845907,c=N&x,f=P&x;for(let k=0;k<p;k++)k&1?(T=A[k],T=T*N&F|T*c&x,T=T<<15|T>>>17,T=T*P&F|T*f&x,b^=T,b=b<<13|b>>>19,b=b*5+3864292196):(_=A[k],_=_*N&F|_*c&x,_=_<<15|_>>>17,_=_*P&F|_*f&x,M^=_,M=M<<13|M>>>19,M=M*5+3864292196);switch(T=0,i){case 3:T^=e[p*4+2]<<16;case 2:T^=e[p*4+1]<<8;case 1:T^=e[p*4],T=T*N&F|T*c&x,T=T<<15|T>>>17,T=T*P&F|T*f&x,p&1?b^=T:M^=T}this.h1=b,this.h2=M}hexdigest(){let n=this.h1,e=this.h2;return n^=e>>>1,n=n*3981806797&F|n*36045&x,e=e*4283543511&F|((e<<16|n>>>16)*2950163797&F)>>>16,n^=e>>>1,n=n*444984403&F|n*60499&x,e=e*3301882366&F|((e<<16|n>>>16)*3120437893&F)>>>16,n^=e>>>1,(n>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}s.MurmurHash3_64=I},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FontLoader=s.FontFaceObject=void 0;var a=C(1),u=C(10);class F{#t=new Set;constructor({ownerDocument:y=globalThis.document,styleElement:n=null}){this._document=y,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(y){this.nativeFontFaces.add(y),this._document.fonts.add(y)}removeNativeFontFace(y){this.nativeFontFaces.delete(y),this._document.fonts.delete(y)}insertRule(y){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let n=this.styleElement.sheet;n.insertRule(y,n.cssRules.length)}clear(){for(let y of this.nativeFontFaces)this._document.fonts.delete(y);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(y){if(!(!y||this.#t.has(y.loadedName))){if((0,a.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:n,src:e,style:d}=y,p=new FontFace(n,e,d);this.addNativeFontFace(p);try{await p.load(),this.#t.add(n)}catch{(0,a.warn)(`Cannot load system font: ${y.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(p)}return}(0,a.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(y){if(y.attached||y.missingFile&&!y.systemFontInfo)return;if(y.attached=!0,y.systemFontInfo){await this.loadSystemFont(y.systemFontInfo);return}if(this.isFontLoadingAPISupported){let e=y.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(d){throw(0,a.warn)(`Failed to load font '${e.family}': '${d}'.`),y.disableFontFace=!0,d}}return}let n=y.createFontFaceRule();if(n){if(this.insertRule(n),this.isSyncFontLoadingSupported)return;await new Promise(e=>{let d=this._queueLoadingCallback(e);this._prepareFontLoadEvent(y,d)})}}get isFontLoadingAPISupported(){let y=!!this._document?.fonts;return(0,a.shadow)(this,"isFontLoadingAPISupported",y)}get isSyncFontLoadingSupported(){let y=!1;return(u.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(y=!0),(0,a.shadow)(this,"isSyncFontLoadingSupported",y)}_queueLoadingCallback(y){function n(){for((0,a.assert)(!d.done,"completeRequest() cannot be called twice."),d.done=!0;e.length>0&&e[0].done;){let p=e.shift();setTimeout(p.callback,0)}}let{loadingRequests:e}=this,d={done:!1,complete:n,callback:y};return e.push(d),d}get _loadTestFont(){let y=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,a.shadow)(this,"_loadTestFont",y)}_prepareFontLoadEvent(y,n){function e(X,K){return X.charCodeAt(K)<<24|X.charCodeAt(K+1)<<16|X.charCodeAt(K+2)<<8|X.charCodeAt(K+3)&255}function d(X,K,rt,Q){let tt=X.substring(0,K),$=X.substring(K+rt);return tt+Q+$}let p,i,A=this._document.createElement("canvas");A.width=1,A.height=1;let T=A.getContext("2d"),_=0;function b(X,K){if(++_>30){(0,a.warn)("Load test font never loaded."),K();return}if(T.font="30px "+X,T.fillText(".",0,20),T.getImageData(0,0,1,1).data[3]>0){K();return}setTimeout(b.bind(null,X,K))}let M=`lt${Date.now()}${this.loadTestFontId++}`,N=this._loadTestFont;N=d(N,976,M.length,M);let c=16,f=1482184792,k=e(N,c);for(p=0,i=M.length-3;p<i;p+=4)k=k-f+e(M,p)|0;p<M.length&&(k=k-f+e(M+"XXX",p)|0),N=d(N,c,4,(0,a.string32)(k));let B=`url(data:font/opentype;base64,${btoa(N)});`,O=`@font-face {font-family:"${M}";src:${B}}`;this.insertRule(O);let G=this._document.createElement("div");G.style.visibility="hidden",G.style.width=G.style.height="10px",G.style.position="absolute",G.style.top=G.style.left="0px";for(let X of[y.loadedName,M]){let K=this._document.createElement("span");K.textContent="Hi",K.style.fontFamily=X,G.append(K)}this._document.body.append(G),b(M,()=>{G.remove(),n.complete()})}}s.FontLoader=F;class x{constructor(y,{isEvalSupported:n=!0,disableFontFace:e=!1,ignoreErrors:d=!1,inspectFont:p=null}){this.compiledGlyphs=Object.create(null);for(let i in y)this[i]=y[i];this.isEvalSupported=n!==!1,this.disableFontFace=e===!0,this.ignoreErrors=d===!0,this._inspectFont=p}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let y;if(!this.cssFontInfo)y=new FontFace(this.loadedName,this.data,{});else{let n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),y=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return this._inspectFont?.(this),y}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let y=(0,a.bytesToString)(this.data),n=`url(data:${this.mimetype};base64,${btoa(y)});`,e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${n}}`;else{let d=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(d+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${d}src:${n}}`}return this._inspectFont?.(this,n),e}getPathGenerator(y,n){if(this.compiledGlyphs[n]!==void 0)return this.compiledGlyphs[n];let e;try{e=y.get(this.loadedName+"_path_"+n)}catch(d){if(!this.ignoreErrors)throw d;return(0,a.warn)(`getPathGenerator - ignoring character: "${d}".`),this.compiledGlyphs[n]=function(p,i){}}if(this.isEvalSupported&&a.FeatureTest.isEvalSupported){let d=[];for(let p of e){let i=p.args!==void 0?p.args.join(","):"";d.push("c.",p.cmd,"(",i,`);
`)}return this.compiledGlyphs[n]=new Function("c","size",d.join(""))}return this.compiledGlyphs[n]=function(d,p){for(let i of e)i.cmd==="scale"&&(i.args=[p,-p]),d[i.cmd].apply(d,i.args)}}}s.FontFaceObject=x},(D,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isNodeJS=void 0;let C=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");s.isNodeJS=C},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CanvasGraphics=void 0;var a=C(1),u=C(6),F=C(12),x=C(13),I=C(10);let y=16,n=100,e=4096,d=15,p=10,i=1e3,A=16;function T(S,o){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){o.save(),this.__originalSave()},S.restore=function(){o.restore(),this.__originalRestore()},S.translate=function(m,E){o.translate(m,E),this.__originalTranslate(m,E)},S.scale=function(m,E){o.scale(m,E),this.__originalScale(m,E)},S.transform=function(m,E,t,r,h,g){o.transform(m,E,t,r,h,g),this.__originalTransform(m,E,t,r,h,g)},S.setTransform=function(m,E,t,r,h,g){o.setTransform(m,E,t,r,h,g),this.__originalSetTransform(m,E,t,r,h,g)},S.resetTransform=function(){o.resetTransform(),this.__originalResetTransform()},S.rotate=function(m){o.rotate(m),this.__originalRotate(m)},S.clip=function(m){o.clip(m),this.__originalClip(m)},S.moveTo=function(l,m){o.moveTo(l,m),this.__originalMoveTo(l,m)},S.lineTo=function(l,m){o.lineTo(l,m),this.__originalLineTo(l,m)},S.bezierCurveTo=function(l,m,E,t,r,h){o.bezierCurveTo(l,m,E,t,r,h),this.__originalBezierCurveTo(l,m,E,t,r,h)},S.rect=function(l,m,E,t){o.rect(l,m,E,t),this.__originalRect(l,m,E,t)},S.closePath=function(){o.closePath(),this.__originalClosePath()},S.beginPath=function(){o.beginPath(),this.__originalBeginPath()}}class _{constructor(o){this.canvasFactory=o,this.cache=Object.create(null)}getCanvas(o,l,m){let E;return this.cache[o]!==void 0?(E=this.cache[o],this.canvasFactory.reset(E,l,m)):(E=this.canvasFactory.create(l,m),this.cache[o]=E),E}delete(o){delete this.cache[o]}clear(){for(let o in this.cache){let l=this.cache[o];this.canvasFactory.destroy(l),delete this.cache[o]}}}function b(S,o,l,m,E,t,r,h,g,v){let[w,R,j,z,W,V]=(0,u.getCurrentTransform)(S);if(R===0&&j===0){let st=r*w+W,nt=Math.round(st),et=h*z+V,at=Math.round(et),ot=(r+g)*w+W,lt=Math.abs(Math.round(ot)-nt)||1,ct=(h+v)*z+V,gt=Math.abs(Math.round(ct)-at)||1;return S.setTransform(Math.sign(w),0,0,Math.sign(z),nt,at),S.drawImage(o,l,m,E,t,0,0,lt,gt),S.setTransform(w,R,j,z,W,V),[lt,gt]}if(w===0&&z===0){let st=h*j+W,nt=Math.round(st),et=r*R+V,at=Math.round(et),ot=(h+v)*j+W,lt=Math.abs(Math.round(ot)-nt)||1,ct=(r+g)*R+V,gt=Math.abs(Math.round(ct)-at)||1;return S.setTransform(0,Math.sign(R),Math.sign(j),0,nt,at),S.drawImage(o,l,m,E,t,0,0,gt,lt),S.setTransform(w,R,j,z,W,V),[gt,lt]}S.drawImage(o,l,m,E,t,r,h,g,v);let Z=Math.hypot(w,R),Y=Math.hypot(j,z);return[Z*g,Y*v]}function M(S){let{width:o,height:l}=S;if(o>i||l>i)return null;let m=1e3,E=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),t=o+1,r=new Uint8Array(t*(l+1)),h,g,v,w=o+7&-8,R=new Uint8Array(w*l),j=0;for(let Y of S.data){let st=128;for(;st>0;)R[j++]=Y&st?0:255,st>>=1}let z=0;for(j=0,R[j]!==0&&(r[0]=1,++z),g=1;g<o;g++)R[j]!==R[j+1]&&(r[g]=R[j]?2:1,++z),j++;for(R[j]!==0&&(r[g]=2,++z),h=1;h<l;h++){j=h*w,v=h*t,R[j-w]!==R[j]&&(r[v]=R[j]?1:8,++z);let Y=(R[j]?4:0)+(R[j-w]?8:0);for(g=1;g<o;g++)Y=(Y>>2)+(R[j+1]?4:0)+(R[j-w+1]?8:0),E[Y]&&(r[v+g]=E[Y],++z),j++;if(R[j-w]!==R[j]&&(r[v+g]=R[j]?2:4,++z),z>m)return null}for(j=w*(l-1),v=h*t,R[j]!==0&&(r[v]=8,++z),g=1;g<o;g++)R[j]!==R[j+1]&&(r[v+g]=R[j]?4:8,++z),j++;if(R[j]!==0&&(r[v+g]=4,++z),z>m)return null;let W=new Int32Array([0,t,-1,0,-t,0,0,0,1]),V=new Path2D;for(h=0;z&&h<=l;h++){let Y=h*t,st=Y+o;for(;Y<st&&!r[Y];)Y++;if(Y===st)continue;V.moveTo(Y%t,h);let nt=Y,et=r[Y];do{let at=W[et];do Y+=at;while(!r[Y]);let ot=r[Y];ot!==5&&ot!==10?(et=ot,r[Y]=0):(et=ot&51*et>>4,r[Y]&=et>>2|et<<2),V.lineTo(Y%t,Y/t|0),r[Y]||--z}while(nt!==Y);--h}return R=null,r=null,function(Y){Y.save(),Y.scale(1/o,-1/l),Y.translate(0,-l),Y.fill(V),Y.beginPath(),Y.restore()}}class N{constructor(o,l){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,o,l])}clone(){let o=Object.create(this);return o.clipBox=this.clipBox.slice(),o}setCurrentPoint(o,l){this.x=o,this.y=l}updatePathMinMax(o,l,m){[l,m]=a.Util.applyTransform([l,m],o),this.minX=Math.min(this.minX,l),this.minY=Math.min(this.minY,m),this.maxX=Math.max(this.maxX,l),this.maxY=Math.max(this.maxY,m)}updateRectMinMax(o,l){let m=a.Util.applyTransform(l,o),E=a.Util.applyTransform(l.slice(2),o);this.minX=Math.min(this.minX,m[0],E[0]),this.minY=Math.min(this.minY,m[1],E[1]),this.maxX=Math.max(this.maxX,m[0],E[0]),this.maxY=Math.max(this.maxY,m[1],E[1])}updateScalingPathMinMax(o,l){a.Util.scaleMinMax(o,l),this.minX=Math.min(this.minX,l[0]),this.maxX=Math.max(this.maxX,l[1]),this.minY=Math.min(this.minY,l[2]),this.maxY=Math.max(this.maxY,l[3])}updateCurvePathMinMax(o,l,m,E,t,r,h,g,v,w){let R=a.Util.bezierBoundingBox(l,m,E,t,r,h,g,v);if(w){w[0]=Math.min(w[0],R[0],R[2]),w[1]=Math.max(w[1],R[0],R[2]),w[2]=Math.min(w[2],R[1],R[3]),w[3]=Math.max(w[3],R[1],R[3]);return}this.updateRectMinMax(o,R)}getPathBoundingBox(o=F.PathType.FILL,l=null){let m=[this.minX,this.minY,this.maxX,this.maxY];if(o===F.PathType.STROKE){l||(0,a.unreachable)("Stroke bounding box must include transform.");let E=a.Util.singularValueDecompose2dScale(l),t=E[0]*this.lineWidth/2,r=E[1]*this.lineWidth/2;m[0]-=t,m[1]-=r,m[2]+=t,m[3]+=r}return m}updateClipFromPath(){let o=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(o||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(o){this.clipBox=o,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(o=F.PathType.FILL,l=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(o,l))}}function P(S,o){if(typeof ImageData<"u"&&o instanceof ImageData){S.putImageData(o,0,0);return}let l=o.height,m=o.width,E=l%A,t=(l-E)/A,r=E===0?t:t+1,h=S.createImageData(m,A),g=0,v,w=o.data,R=h.data,j,z,W,V;if(o.kind===a.ImageKind.GRAYSCALE_1BPP){let Z=w.byteLength,Y=new Uint32Array(R.buffer,0,R.byteLength>>2),st=Y.length,nt=m+7>>3,et=4294967295,at=a.FeatureTest.isLittleEndian?4278190080:255;for(j=0;j<r;j++){for(W=j<t?A:E,v=0,z=0;z<W;z++){let ot=Z-g,lt=0,ct=ot>nt?m:ot*8-7,gt=ct&-8,mt=0,dt=0;for(;lt<gt;lt+=8)dt=w[g++],Y[v++]=dt&128?et:at,Y[v++]=dt&64?et:at,Y[v++]=dt&32?et:at,Y[v++]=dt&16?et:at,Y[v++]=dt&8?et:at,Y[v++]=dt&4?et:at,Y[v++]=dt&2?et:at,Y[v++]=dt&1?et:at;for(;lt<ct;lt++)mt===0&&(dt=w[g++],mt=128),Y[v++]=dt&mt?et:at,mt>>=1}for(;v<st;)Y[v++]=0;S.putImageData(h,0,j*A)}}else if(o.kind===a.ImageKind.RGBA_32BPP){for(z=0,V=m*A*4,j=0;j<t;j++)R.set(w.subarray(g,g+V)),g+=V,S.putImageData(h,0,z),z+=A;j<r&&(V=m*E*4,R.set(w.subarray(g,g+V)),S.putImageData(h,0,z))}else if(o.kind===a.ImageKind.RGB_24BPP)for(W=A,V=m*W,j=0;j<r;j++){for(j>=t&&(W=E,V=m*W),v=0,z=V;z--;)R[v++]=w[g++],R[v++]=w[g++],R[v++]=w[g++],R[v++]=255;S.putImageData(h,0,j*A)}else throw new Error(`bad image kind: ${o.kind}`)}function c(S,o){if(o.bitmap){S.drawImage(o.bitmap,0,0);return}let l=o.height,m=o.width,E=l%A,t=(l-E)/A,r=E===0?t:t+1,h=S.createImageData(m,A),g=0,v=o.data,w=h.data;for(let R=0;R<r;R++){let j=R<t?A:E;({srcPos:g}=(0,x.convertBlackAndWhiteToRGBA)({src:v,srcPos:g,dest:w,width:m,height:j,nonBlackColor:0})),S.putImageData(h,0,R*A)}}function f(S,o){let l=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let m of l)S[m]!==void 0&&(o[m]=S[m]);S.setLineDash!==void 0&&(o.setLineDash(S.getLineDash()),o.lineDashOffset=S.lineDashOffset)}function k(S){S.strokeStyle=S.fillStyle="#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0),I.isNodeJS||(S.filter="none")}function B(S,o,l,m){let E=S.length;for(let t=3;t<E;t+=4){let r=S[t];if(r===0)S[t-3]=o,S[t-2]=l,S[t-1]=m;else if(r<255){let h=255-r;S[t-3]=S[t-3]*r+o*h>>8,S[t-2]=S[t-2]*r+l*h>>8,S[t-1]=S[t-1]*r+m*h>>8}}}function O(S,o,l){let m=S.length,E=1/255;for(let t=3;t<m;t+=4){let r=l?l[S[t]]:S[t];o[t]=o[t]*r*E|0}}function G(S,o,l){let m=S.length;for(let E=3;E<m;E+=4){let t=S[E-3]*77+S[E-2]*152+S[E-1]*28;o[E]=l?o[E]*l[t>>8]>>8:o[E]*t>>16}}function X(S,o,l,m,E,t,r,h,g,v,w){let R=!!t,j=R?t[0]:0,z=R?t[1]:0,W=R?t[2]:0,V;E==="Luminosity"?V=G:V=O;let Y=Math.min(m,Math.ceil(1048576/l));for(let st=0;st<m;st+=Y){let nt=Math.min(Y,m-st),et=S.getImageData(h-v,st+(g-w),l,nt),at=o.getImageData(h,st+g,l,nt);R&&B(et.data,j,z,W),V(et.data,at.data,r),o.putImageData(at,h,st+g)}}function K(S,o,l,m){let E=m[0],t=m[1],r=m[2]-E,h=m[3]-t;r===0||h===0||(X(o.context,l,r,h,o.subtype,o.backdrop,o.transferMap,E,t,o.offsetX,o.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(l.canvas,0,0),S.restore())}function rt(S,o){let l=a.Util.singularValueDecompose2dScale(S);l[0]=Math.fround(l[0]),l[1]=Math.fround(l[1]);let m=Math.fround((globalThis.devicePixelRatio||1)*u.PixelsPerInch.PDF_TO_CSS_UNITS);return o!==void 0?o:l[0]<=m||l[1]<=m}let Q=["butt","round","square"],tt=["miter","round","bevel"],$={},U={};class L{constructor(o,l,m,E,t,{optionalContentConfig:r,markedContentStack:h=null},g,v){this.ctx=o,this.current=new N(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=l,this.objs=m,this.canvasFactory=E,this.filterFactory=t,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=h||[],this.optionalContentConfig=r,this.cachedCanvases=new _(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=g,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=v,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(o,l=null){return typeof o=="string"?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):l}beginDrawing({transform:o,viewport:l,transparency:m=!1,background:E=null}){let t=this.ctx.canvas.width,r=this.ctx.canvas.height,h=this.ctx.fillStyle;if(this.ctx.fillStyle=E||"#ffffff",this.ctx.fillRect(0,0,t,r),this.ctx.fillStyle=h,m){let g=this.cachedCanvases.getCanvas("transparent",t,r);this.compositeCtx=this.ctx,this.transparentCanvas=g.canvas,this.ctx=g.context,this.ctx.save(),this.ctx.transform(...(0,u.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),k(this.ctx),o&&(this.ctx.transform(...o),this.outputScaleX=o[0],this.outputScaleY=o[0]),this.ctx.transform(...l.transform),this.viewportScale=l.scale,this.baseTransform=(0,u.getCurrentTransform)(this.ctx)}executeOperatorList(o,l,m,E){let t=o.argsArray,r=o.fnArray,h=l||0,g=t.length;if(g===h)return h;let v=g-h>p&&typeof m=="function",w=v?Date.now()+d:0,R=0,j=this.commonObjs,z=this.objs,W;for(;;){if(E!==void 0&&h===E.nextBreakPoint)return E.breakIt(h,m),h;if(W=r[h],W!==a.OPS.dependency)this[W].apply(this,t[h]);else for(let V of t[h]){let Z=V.startsWith("g_")?j:z;if(!Z.has(V))return Z.get(V,m),h}if(h++,h===g)return h;if(v&&++R>p){if(Date.now()>w)return m(),h;R=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let o of this._cachedBitmapsMap.values()){for(let l of o.values())typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement&&(l.width=l.height=0);o.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){let o=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(o!=="none"){let l=this.ctx.filter;this.ctx.filter=o,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=l}}}_scaleImage(o,l){let m=o.width,E=o.height,t=Math.max(Math.hypot(l[0],l[1]),1),r=Math.max(Math.hypot(l[2],l[3]),1),h=m,g=E,v="prescale1",w,R;for(;t>2&&h>1||r>2&&g>1;){let j=h,z=g;t>2&&h>1&&(j=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h/2),t/=h/j),r>2&&g>1&&(z=g>=16384?Math.floor(g/2)-1||1:Math.ceil(g)/2,r/=g/z),w=this.cachedCanvases.getCanvas(v,j,z),R=w.context,R.clearRect(0,0,j,z),R.drawImage(o,0,0,h,g,0,0,j,z),o=w.canvas,h=j,g=z,v=v==="prescale1"?"prescale2":"prescale1"}return{img:o,paintWidth:h,paintHeight:g}}_createMaskCanvas(o){let l=this.ctx,{width:m,height:E}=o,t=this.current.fillColor,r=this.current.patternFill,h=(0,u.getCurrentTransform)(l),g,v,w,R;if((o.bitmap||o.data)&&o.count>1){let lt=o.bitmap||o.data.buffer;v=JSON.stringify(r?h:[h.slice(0,4),t]),g=this._cachedBitmapsMap.get(lt),g||(g=new Map,this._cachedBitmapsMap.set(lt,g));let ct=g.get(v);if(ct&&!r){let gt=Math.round(Math.min(h[0],h[2])+h[4]),mt=Math.round(Math.min(h[1],h[3])+h[5]);return{canvas:ct,offsetX:gt,offsetY:mt}}w=ct}w||(R=this.cachedCanvases.getCanvas("maskCanvas",m,E),c(R.context,o));let j=a.Util.transform(h,[1/m,0,0,-1/E,0,0]);j=a.Util.transform(j,[1,0,0,1,0,-E]);let z=a.Util.applyTransform([0,0],j),W=a.Util.applyTransform([m,E],j),V=a.Util.normalizeRect([z[0],z[1],W[0],W[1]]),Z=Math.round(V[2]-V[0])||1,Y=Math.round(V[3]-V[1])||1,st=this.cachedCanvases.getCanvas("fillCanvas",Z,Y),nt=st.context,et=Math.min(z[0],W[0]),at=Math.min(z[1],W[1]);nt.translate(-et,-at),nt.transform(...j),w||(w=this._scaleImage(R.canvas,(0,u.getCurrentTransformInverse)(nt)),w=w.img,g&&r&&g.set(v,w)),nt.imageSmoothingEnabled=rt((0,u.getCurrentTransform)(nt),o.interpolate),b(nt,w,0,0,w.width,w.height,0,0,m,E),nt.globalCompositeOperation="source-in";let ot=a.Util.transform((0,u.getCurrentTransformInverse)(nt),[1,0,0,1,-et,-at]);return nt.fillStyle=r?t.getPattern(l,this,ot,F.PathType.FILL):t,nt.fillRect(0,0,m,E),g&&!r&&(this.cachedCanvases.delete("fillCanvas"),g.set(v,st.canvas)),{canvas:st.canvas,offsetX:Math.round(et),offsetY:Math.round(at)}}setLineWidth(o){o!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=o,this.ctx.lineWidth=o}setLineCap(o){this.ctx.lineCap=Q[o]}setLineJoin(o){this.ctx.lineJoin=tt[o]}setMiterLimit(o){this.ctx.miterLimit=o}setDash(o,l){let m=this.ctx;m.setLineDash!==void 0&&(m.setLineDash(o),m.lineDashOffset=l)}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(let[l,m]of o)switch(l){case"LW":this.setLineWidth(m);break;case"LC":this.setLineCap(m);break;case"LJ":this.setLineJoin(m);break;case"ML":this.setMiterLimit(m);break;case"D":this.setDash(m[0],m[1]);break;case"RI":this.setRenderingIntent(m);break;case"FL":this.setFlatness(m);break;case"Font":this.setFont(m[0],m[1]);break;case"CA":this.current.strokeAlpha=m;break;case"ca":this.current.fillAlpha=m,this.ctx.globalAlpha=m;break;case"BM":this.ctx.globalCompositeOperation=m;break;case"SMask":this.current.activeSMask=m?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(m);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let o=this.inSMaskMode;this.current.activeSMask&&!o?this.beginSMaskMode():!this.current.activeSMask&&o&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let o=this.ctx.canvas.width,l=this.ctx.canvas.height,m="smaskGroupAt"+this.groupLevel,E=this.cachedCanvases.getCanvas(m,o,l);this.suspendedCtx=this.ctx,this.ctx=E.context;let t=this.ctx;t.setTransform(...(0,u.getCurrentTransform)(this.suspendedCtx)),f(this.suspendedCtx,t),T(t,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),f(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(o){if(!this.current.activeSMask)return;o?(o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]),o[2]=Math.ceil(o[2]),o[3]=Math.ceil(o[3])):o=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let l=this.current.activeSMask,m=this.suspendedCtx;K(m,l,this.ctx,o),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(f(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let o=this.current;this.stateStack.push(o),this.current=o.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),f(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(o,l,m,E,t,r){this.ctx.transform(o,l,m,E,t,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(o,l,m){let E=this.ctx,t=this.current,r=t.x,h=t.y,g,v,w=(0,u.getCurrentTransform)(E),R=w[0]===0&&w[3]===0||w[1]===0&&w[2]===0,j=R?m.slice(0):null;for(let z=0,W=0,V=o.length;z<V;z++)switch(o[z]|0){case a.OPS.rectangle:r=l[W++],h=l[W++];let Z=l[W++],Y=l[W++],st=r+Z,nt=h+Y;E.moveTo(r,h),Z===0||Y===0?E.lineTo(st,nt):(E.lineTo(st,h),E.lineTo(st,nt),E.lineTo(r,nt)),R||t.updateRectMinMax(w,[r,h,st,nt]),E.closePath();break;case a.OPS.moveTo:r=l[W++],h=l[W++],E.moveTo(r,h),R||t.updatePathMinMax(w,r,h);break;case a.OPS.lineTo:r=l[W++],h=l[W++],E.lineTo(r,h),R||t.updatePathMinMax(w,r,h);break;case a.OPS.curveTo:g=r,v=h,r=l[W+4],h=l[W+5],E.bezierCurveTo(l[W],l[W+1],l[W+2],l[W+3],r,h),t.updateCurvePathMinMax(w,g,v,l[W],l[W+1],l[W+2],l[W+3],r,h,j),W+=6;break;case a.OPS.curveTo2:g=r,v=h,E.bezierCurveTo(r,h,l[W],l[W+1],l[W+2],l[W+3]),t.updateCurvePathMinMax(w,g,v,r,h,l[W],l[W+1],l[W+2],l[W+3],j),r=l[W+2],h=l[W+3],W+=4;break;case a.OPS.curveTo3:g=r,v=h,r=l[W+2],h=l[W+3],E.bezierCurveTo(l[W],l[W+1],r,h,r,h),t.updateCurvePathMinMax(w,g,v,l[W],l[W+1],r,h,r,h,j),W+=4;break;case a.OPS.closePath:E.closePath();break}R&&t.updateScalingPathMinMax(w,j),t.setCurrentPoint(r,h)}closePath(){this.ctx.closePath()}stroke(o=!0){let l=this.ctx,m=this.current.strokeColor;l.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof m=="object"&&m?.getPattern?(l.save(),l.strokeStyle=m.getPattern(l,this,(0,u.getCurrentTransformInverse)(l),F.PathType.STROKE),this.rescaleAndStroke(!1),l.restore()):this.rescaleAndStroke(!0)),o&&this.consumePath(this.current.getClippedPathBoundingBox()),l.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(o=!0){let l=this.ctx,m=this.current.fillColor,E=this.current.patternFill,t=!1;E&&(l.save(),l.fillStyle=m.getPattern(l,this,(0,u.getCurrentTransformInverse)(l),F.PathType.FILL),t=!0);let r=this.current.getClippedPathBoundingBox();this.contentVisible&&r!==null&&(this.pendingEOFill?(l.fill("evenodd"),this.pendingEOFill=!1):l.fill()),t&&l.restore(),o&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=$}eoClip(){this.pendingClip=U}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let o=this.pendingTextPaths,l=this.ctx;if(o===void 0){l.beginPath();return}l.save(),l.beginPath();for(let m of o)l.setTransform(...m.transform),l.translate(m.x,m.y),m.addToPath(l,m.fontSize);l.restore(),l.clip(),l.beginPath(),delete this.pendingTextPaths}setCharSpacing(o){this.current.charSpacing=o}setWordSpacing(o){this.current.wordSpacing=o}setHScale(o){this.current.textHScale=o/100}setLeading(o){this.current.leading=-o}setFont(o,l){let m=this.commonObjs.get(o),E=this.current;if(!m)throw new Error(`Can't find font for ${o}`);if(E.fontMatrix=m.fontMatrix||a.FONT_IDENTITY_MATRIX,(E.fontMatrix[0]===0||E.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+o),l<0?(l=-l,E.fontDirection=-1):E.fontDirection=1,this.current.font=m,this.current.fontSize=l,m.isType3Font)return;let t=m.loadedName||"sans-serif",r=m.systemFontInfo?.css||`"${t}", ${m.fallbackName}`,h="normal";m.black?h="900":m.bold&&(h="bold");let g=m.italic?"italic":"normal",v=l;l<y?v=y:l>n&&(v=n),this.current.fontSizeScale=l/v,this.ctx.font=`${g} ${h} ${v}px ${r}`}setTextRenderingMode(o){this.current.textRenderingMode=o}setTextRise(o){this.current.textRise=o}moveText(o,l){this.current.x=this.current.lineX+=o,this.current.y=this.current.lineY+=l}setLeadingMoveText(o,l){this.setLeading(-l),this.moveText(o,l)}setTextMatrix(o,l,m,E,t,r){this.current.textMatrix=[o,l,m,E,t,r],this.current.textMatrixScale=Math.hypot(o,l),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(o,l,m,E){let t=this.ctx,r=this.current,h=r.font,g=r.textRenderingMode,v=r.fontSize/r.fontSizeScale,w=g&a.TextRenderingMode.FILL_STROKE_MASK,R=!!(g&a.TextRenderingMode.ADD_TO_PATH_FLAG),j=r.patternFill&&!h.missingFile,z;(h.disableFontFace||R||j)&&(z=h.getPathGenerator(this.commonObjs,o)),h.disableFontFace||j?(t.save(),t.translate(l,m),t.beginPath(),z(t,v),E&&t.setTransform(...E),(w===a.TextRenderingMode.FILL||w===a.TextRenderingMode.FILL_STROKE)&&t.fill(),(w===a.TextRenderingMode.STROKE||w===a.TextRenderingMode.FILL_STROKE)&&t.stroke(),t.restore()):((w===a.TextRenderingMode.FILL||w===a.TextRenderingMode.FILL_STROKE)&&t.fillText(o,l,m),(w===a.TextRenderingMode.STROKE||w===a.TextRenderingMode.FILL_STROKE)&&t.strokeText(o,l,m)),R&&(this.pendingTextPaths||=[]).push({transform:(0,u.getCurrentTransform)(t),x:l,y:m,fontSize:v,addToPath:z})}get isFontSubpixelAAEnabled(){let{context:o}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);o.scale(1.5,1),o.fillText("I",0,10);let l=o.getImageData(0,0,10,10).data,m=!1;for(let E=3;E<l.length;E+=4)if(l[E]>0&&l[E]<255){m=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",m)}showText(o){let l=this.current,m=l.font;if(m.isType3Font)return this.showType3Text(o);let E=l.fontSize;if(E===0)return;let t=this.ctx,r=l.fontSizeScale,h=l.charSpacing,g=l.wordSpacing,v=l.fontDirection,w=l.textHScale*v,R=o.length,j=m.vertical,z=j?1:-1,W=m.defaultVMetrics,V=E*l.fontMatrix[0],Z=l.textRenderingMode===a.TextRenderingMode.FILL&&!m.disableFontFace&&!l.patternFill;t.save(),t.transform(...l.textMatrix),t.translate(l.x,l.y+l.textRise),v>0?t.scale(w,-1):t.scale(w,1);let Y;if(l.patternFill){t.save();let ot=l.fillColor.getPattern(t,this,(0,u.getCurrentTransformInverse)(t),F.PathType.FILL);Y=(0,u.getCurrentTransform)(t),t.restore(),t.fillStyle=ot}let st=l.lineWidth,nt=l.textMatrixScale;if(nt===0||st===0){let ot=l.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(ot===a.TextRenderingMode.STROKE||ot===a.TextRenderingMode.FILL_STROKE)&&(st=this.getSinglePixelWidth())}else st/=nt;if(r!==1&&(t.scale(r,r),st/=r),t.lineWidth=st,m.isInvalidPDFjsFont){let ot=[],lt=0;for(let ct of o)ot.push(ct.unicode),lt+=ct.width;t.fillText(ot.join(""),0,0),l.x+=lt*V*w,t.restore(),this.compose();return}let et=0,at;for(at=0;at<R;++at){let ot=o[at];if(typeof ot=="number"){et+=z*ot*E/1e3;continue}let lt=!1,ct=(ot.isSpace?g:0)+h,gt=ot.fontChar,mt=ot.accent,dt,Et,yt=ot.width;if(j){let At=ot.vmetric||W,vt=-(ot.vmetric?At[1]:yt*.5)*V,Mt=At[2]*V;yt=At?-At[0]:yt,dt=vt/r,Et=(et+Mt)/r}else dt=et/r,Et=0;if(m.remeasure&&yt>0){let At=t.measureText(gt).width*1e3/E*r;if(yt<At&&this.isFontSubpixelAAEnabled){let vt=yt/At;lt=!0,t.save(),t.scale(vt,1),dt/=vt}else yt!==At&&(dt+=(yt-At)/2e3*E/r)}if(this.contentVisible&&(ot.isInFont||m.missingFile)){if(Z&&!mt)t.fillText(gt,dt,Et);else if(this.paintChar(gt,dt,Et,Y),mt){let At=dt+E*mt.offset.x/r,vt=Et-E*mt.offset.y/r;this.paintChar(mt.fontChar,At,vt,Y)}}let kt;j?kt=yt*V-ct*v:kt=yt*V+ct*v,et+=kt,lt&&t.restore()}j?l.y-=et:l.x+=et*w,t.restore(),this.compose()}showType3Text(o){let l=this.ctx,m=this.current,E=m.font,t=m.fontSize,r=m.fontDirection,h=E.vertical?1:-1,g=m.charSpacing,v=m.wordSpacing,w=m.textHScale*r,R=m.fontMatrix||a.FONT_IDENTITY_MATRIX,j=o.length,z=m.textRenderingMode===a.TextRenderingMode.INVISIBLE,W,V,Z,Y;if(!(z||t===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,l.save(),l.transform(...m.textMatrix),l.translate(m.x,m.y),l.scale(w,r),W=0;W<j;++W){if(V=o[W],typeof V=="number"){Y=h*V*t/1e3,this.ctx.translate(Y,0),m.x+=Y*w;continue}let st=(V.isSpace?v:0)+g,nt=E.charProcOperatorList[V.operatorListId];if(!nt){(0,a.warn)(`Type3 character "${V.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=V,this.save(),l.scale(t,t),l.transform(...R),this.executeOperatorList(nt),this.restore()),Z=a.Util.applyTransform([V.width,0],R)[0]*t+st,l.translate(Z,0),m.x+=Z*w}l.restore(),this.processingType3=null}}setCharWidth(o,l){}setCharWidthAndBounds(o,l,m,E,t,r){this.ctx.rect(m,E,t-m,r-E),this.ctx.clip(),this.endPath()}getColorN_Pattern(o){let l;if(o[0]==="TilingPattern"){let m=o[1],E=this.baseTransform||(0,u.getCurrentTransform)(this.ctx),t={createCanvasGraphics:r=>new L(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};l=new F.TilingPattern(o,m,this.ctx,t,E)}else l=this._getPattern(o[1],o[2]);return l}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(o,l,m){let E=a.Util.makeHexColor(o,l,m);this.ctx.strokeStyle=E,this.current.strokeColor=E}setFillRGBColor(o,l,m){let E=a.Util.makeHexColor(o,l,m);this.ctx.fillStyle=E,this.current.fillColor=E,this.current.patternFill=!1}_getPattern(o,l=null){let m;return this.cachedPatterns.has(o)?m=this.cachedPatterns.get(o):(m=(0,F.getShadingPattern)(this.getObject(o)),this.cachedPatterns.set(o,m)),l&&(m.matrix=l),m}shadingFill(o){if(!this.contentVisible)return;let l=this.ctx;this.save();let m=this._getPattern(o);l.fillStyle=m.getPattern(l,this,(0,u.getCurrentTransformInverse)(l),F.PathType.SHADING);let E=(0,u.getCurrentTransformInverse)(l);if(E){let t=l.canvas,r=t.width,h=t.height,g=a.Util.applyTransform([0,0],E),v=a.Util.applyTransform([0,h],E),w=a.Util.applyTransform([r,0],E),R=a.Util.applyTransform([r,h],E),j=Math.min(g[0],v[0],w[0],R[0]),z=Math.min(g[1],v[1],w[1],R[1]),W=Math.max(g[0],v[0],w[0],R[0]),V=Math.max(g[1],v[1],w[1],R[1]);this.ctx.fillRect(j,z,W-j,V-z)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(o,l){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(o)&&o.length===6&&this.transform(...o),this.baseTransform=(0,u.getCurrentTransform)(this.ctx),l)){let m=l[2]-l[0],E=l[3]-l[1];this.ctx.rect(l[0],l[1],m,E),this.current.updateRectMinMax((0,u.getCurrentTransform)(this.ctx),l),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(o){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let l=this.ctx;o.isolated||(0,a.info)("TODO: Support non-isolated groups."),o.knockout&&(0,a.warn)("Knockout groups not supported.");let m=(0,u.getCurrentTransform)(l);if(o.matrix&&l.transform(...o.matrix),!o.bbox)throw new Error("Bounding box is required.");let E=a.Util.getAxialAlignedBoundingBox(o.bbox,(0,u.getCurrentTransform)(l)),t=[0,0,l.canvas.width,l.canvas.height];E=a.Util.intersect(E,t)||[0,0,0,0];let r=Math.floor(E[0]),h=Math.floor(E[1]),g=Math.max(Math.ceil(E[2])-r,1),v=Math.max(Math.ceil(E[3])-h,1),w=1,R=1;g>e&&(w=g/e,g=e),v>e&&(R=v/e,v=e),this.current.startNewPathAndClipBox([0,0,g,v]);let j="groupAt"+this.groupLevel;o.smask&&(j+="_smask_"+this.smaskCounter++%2);let z=this.cachedCanvases.getCanvas(j,g,v),W=z.context;W.scale(1/w,1/R),W.translate(-r,-h),W.transform(...m),o.smask?this.smaskStack.push({canvas:z.canvas,context:W,offsetX:r,offsetY:h,scaleX:w,scaleY:R,subtype:o.smask.subtype,backdrop:o.smask.backdrop,transferMap:o.smask.transferMap||null,startTransformInverse:null}):(l.setTransform(1,0,0,1,0,0),l.translate(r,h),l.scale(w,R),l.save()),f(l,W),this.ctx=W,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(l),this.groupLevel++}endGroup(o){if(!this.contentVisible)return;this.groupLevel--;let l=this.ctx,m=this.groupStack.pop();if(this.ctx=m,this.ctx.imageSmoothingEnabled=!1,o.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let E=(0,u.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...E);let t=a.Util.getAxialAlignedBoundingBox([0,0,l.canvas.width,l.canvas.height],E);this.ctx.drawImage(l.canvas,0,0),this.ctx.restore(),this.compose(t)}}beginAnnotation(o,l,m,E,t){if(this.#t(),k(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(l)&&l.length===4){let r=l[2]-l[0],h=l[3]-l[1];if(t&&this.annotationCanvasMap){m=m.slice(),m[4]-=l[0],m[5]-=l[1],l=l.slice(),l[0]=l[1]=0,l[2]=r,l[3]=h;let[g,v]=a.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(this.ctx)),{viewportScale:w}=this,R=Math.ceil(r*this.outputScaleX*w),j=Math.ceil(h*this.outputScaleY*w);this.annotationCanvas=this.canvasFactory.create(R,j);let{canvas:z,context:W}=this.annotationCanvas;this.annotationCanvasMap.set(o,z),this.annotationCanvas.savedCtx=this.ctx,this.ctx=W,this.ctx.save(),this.ctx.setTransform(g,0,0,-v,0,h*v),k(this.ctx)}else k(this.ctx),this.ctx.rect(l[0],l[1],r,h),this.ctx.clip(),this.endPath()}this.current=new N(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...m),this.transform(...E)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(o){if(!this.contentVisible)return;let l=o.count;o=this.getObject(o.data,o),o.count=l;let m=this.ctx,E=this.processingType3;if(E&&(E.compiled===void 0&&(E.compiled=M(o)),E.compiled)){E.compiled(m);return}let t=this._createMaskCanvas(o),r=t.canvas;m.save(),m.setTransform(1,0,0,1,0,0),m.drawImage(r,t.offsetX,t.offsetY),m.restore(),this.compose()}paintImageMaskXObjectRepeat(o,l,m=0,E=0,t,r){if(!this.contentVisible)return;o=this.getObject(o.data,o);let h=this.ctx;h.save();let g=(0,u.getCurrentTransform)(h);h.transform(l,m,E,t,0,0);let v=this._createMaskCanvas(o);h.setTransform(1,0,0,1,v.offsetX-g[4],v.offsetY-g[5]);for(let w=0,R=r.length;w<R;w+=2){let j=a.Util.transform(g,[l,m,E,t,r[w],r[w+1]]),[z,W]=a.Util.applyTransform([0,0],j);h.drawImage(v.canvas,z,W)}h.restore(),this.compose()}paintImageMaskXObjectGroup(o){if(!this.contentVisible)return;let l=this.ctx,m=this.current.fillColor,E=this.current.patternFill;for(let t of o){let{data:r,width:h,height:g,transform:v}=t,w=this.cachedCanvases.getCanvas("maskCanvas",h,g),R=w.context;R.save();let j=this.getObject(r,t);c(R,j),R.globalCompositeOperation="source-in",R.fillStyle=E?m.getPattern(R,this,(0,u.getCurrentTransformInverse)(l),F.PathType.FILL):m,R.fillRect(0,0,h,g),R.restore(),l.save(),l.transform(...v),l.scale(1,-1),b(l,w.canvas,0,0,h,g,0,-1,1,1),l.restore()}this.compose()}paintImageXObject(o){if(!this.contentVisible)return;let l=this.getObject(o);if(!l){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(l)}paintImageXObjectRepeat(o,l,m,E){if(!this.contentVisible)return;let t=this.getObject(o);if(!t){(0,a.warn)("Dependent image isn't ready yet");return}let r=t.width,h=t.height,g=[];for(let v=0,w=E.length;v<w;v+=2)g.push({transform:[l,0,0,m,E[v],E[v+1]],x:0,y:0,w:r,h});this.paintInlineImageXObjectGroup(t,g)}applyTransferMapsToCanvas(o){return this.current.transferMaps!=="none"&&(o.filter=this.current.transferMaps,o.drawImage(o.canvas,0,0),o.filter="none"),o.canvas}applyTransferMapsToBitmap(o){if(this.current.transferMaps==="none")return o.bitmap;let{bitmap:l,width:m,height:E}=o,t=this.cachedCanvases.getCanvas("inlineImage",m,E),r=t.context;return r.filter=this.current.transferMaps,r.drawImage(l,0,0),r.filter="none",t.canvas}paintInlineImageXObject(o){if(!this.contentVisible)return;let l=o.width,m=o.height,E=this.ctx;this.save(),I.isNodeJS||(E.filter="none"),E.scale(1/l,-1/m);let t;if(o.bitmap)t=this.applyTransferMapsToBitmap(o);else if(typeof HTMLElement=="function"&&o instanceof HTMLElement||!o.data)t=o;else{let g=this.cachedCanvases.getCanvas("inlineImage",l,m).context;P(g,o),t=this.applyTransferMapsToCanvas(g)}let r=this._scaleImage(t,(0,u.getCurrentTransformInverse)(E));E.imageSmoothingEnabled=rt((0,u.getCurrentTransform)(E),o.interpolate),b(E,r.img,0,0,r.paintWidth,r.paintHeight,0,-m,l,m),this.compose(),this.restore()}paintInlineImageXObjectGroup(o,l){if(!this.contentVisible)return;let m=this.ctx,E;if(o.bitmap)E=o.bitmap;else{let t=o.width,r=o.height,g=this.cachedCanvases.getCanvas("inlineImage",t,r).context;P(g,o),E=this.applyTransferMapsToCanvas(g)}for(let t of l)m.save(),m.transform(...t.transform),m.scale(1,-1),b(m,E,t.x,t.y,t.w,t.h,0,-1,1,1),m.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(o){}markPointProps(o,l){}beginMarkedContent(o){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(o,l){o==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(l)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(o){let l=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(o);let m=this.ctx;this.pendingClip&&(l||(this.pendingClip===U?m.clip("evenodd"):m.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),m.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let o=(0,u.getCurrentTransform)(this.ctx);if(o[1]===0&&o[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(o[0]),Math.abs(o[3]));else{let l=Math.abs(o[0]*o[3]-o[2]*o[1]),m=Math.hypot(o[0],o[2]),E=Math.hypot(o[1],o[3]);this._cachedGetSinglePixelWidth=Math.max(m,E)/l}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:o}=this.current,{a:l,b:m,c:E,d:t}=this.ctx.getTransform(),r,h;if(m===0&&E===0){let g=Math.abs(l),v=Math.abs(t);if(g===v)if(o===0)r=h=1/g;else{let w=g*o;r=h=w<1?1/w:1}else if(o===0)r=1/g,h=1/v;else{let w=g*o,R=v*o;r=w<1?1/w:1,h=R<1?1/R:1}}else{let g=Math.abs(l*t-m*E),v=Math.hypot(l,m),w=Math.hypot(E,t);if(o===0)r=w/g,h=v/g;else{let R=o*g;r=w>R?w/R:1,h=v>R?v/R:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=h}return this._cachedScaleForStroking}rescaleAndStroke(o){let{ctx:l}=this,{lineWidth:m}=this.current,[E,t]=this.getScaleForStroking();if(l.lineWidth=m||1,E===1&&t===1){l.stroke();return}let r=l.getLineDash();if(o&&l.save(),l.scale(E,t),r.length>0){let h=Math.max(E,t);l.setLineDash(r.map(g=>g/h)),l.lineDashOffset/=h}l.stroke(),o&&l.restore()}isContentVisible(){for(let o=this.markedContentStack.length-1;o>=0;o--)if(!this.markedContentStack[o].visible)return!1;return!0}}s.CanvasGraphics=L;for(let S in a.OPS)L.prototype[S]!==void 0&&(L.prototype[a.OPS[S]]=L.prototype[S])},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TilingPattern=s.PathType=void 0,s.getShadingPattern=i;var a=C(1),u=C(6);let F={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};s.PathType=F;function x(_,b){if(!b)return;let M=b[2]-b[0],N=b[3]-b[1],P=new Path2D;P.rect(b[0],b[1],M,N),_.clip(P)}class I{constructor(){this.constructor===I&&(0,a.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,a.unreachable)("Abstract method `getPattern` called.")}}class y extends I{constructor(b){super(),this._type=b[1],this._bbox=b[2],this._colorStops=b[3],this._p0=b[4],this._p1=b[5],this._r0=b[6],this._r1=b[7],this.matrix=null}_createGradient(b){let M;this._type==="axial"?M=b.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(M=b.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let N of this._colorStops)M.addColorStop(N[0],N[1]);return M}getPattern(b,M,N,P){let c;if(P===F.STROKE||P===F.FILL){let f=M.current.getClippedPathBoundingBox(P,(0,u.getCurrentTransform)(b))||[0,0,0,0],k=Math.ceil(f[2]-f[0])||1,B=Math.ceil(f[3]-f[1])||1,O=M.cachedCanvases.getCanvas("pattern",k,B,!0),G=O.context;G.clearRect(0,0,G.canvas.width,G.canvas.height),G.beginPath(),G.rect(0,0,G.canvas.width,G.canvas.height),G.translate(-f[0],-f[1]),N=a.Util.transform(N,[1,0,0,1,f[0],f[1]]),G.transform(...M.baseTransform),this.matrix&&G.transform(...this.matrix),x(G,this._bbox),G.fillStyle=this._createGradient(G),G.fill(),c=b.createPattern(O.canvas,"no-repeat");let X=new DOMMatrix(N);c.setTransform(X)}else x(b,this._bbox),c=this._createGradient(b);return c}}function n(_,b,M,N,P,c,f,k){let B=b.coords,O=b.colors,G=_.data,X=_.width*4,K;B[M+1]>B[N+1]&&(K=M,M=N,N=K,K=c,c=f,f=K),B[N+1]>B[P+1]&&(K=N,N=P,P=K,K=f,f=k,k=K),B[M+1]>B[N+1]&&(K=M,M=N,N=K,K=c,c=f,f=K);let rt=(B[M]+b.offsetX)*b.scaleX,Q=(B[M+1]+b.offsetY)*b.scaleY,tt=(B[N]+b.offsetX)*b.scaleX,$=(B[N+1]+b.offsetY)*b.scaleY,U=(B[P]+b.offsetX)*b.scaleX,L=(B[P+1]+b.offsetY)*b.scaleY;if(Q>=L)return;let S=O[c],o=O[c+1],l=O[c+2],m=O[f],E=O[f+1],t=O[f+2],r=O[k],h=O[k+1],g=O[k+2],v=Math.round(Q),w=Math.round(L),R,j,z,W,V,Z,Y,st;for(let nt=v;nt<=w;nt++){if(nt<$){let ct;nt<Q?ct=0:ct=(Q-nt)/(Q-$),R=rt-(rt-tt)*ct,j=S-(S-m)*ct,z=o-(o-E)*ct,W=l-(l-t)*ct}else{let ct;nt>L?ct=1:$===L?ct=0:ct=($-nt)/($-L),R=tt-(tt-U)*ct,j=m-(m-r)*ct,z=E-(E-h)*ct,W=t-(t-g)*ct}let et;nt<Q?et=0:nt>L?et=1:et=(Q-nt)/(Q-L),V=rt-(rt-U)*et,Z=S-(S-r)*et,Y=o-(o-h)*et,st=l-(l-g)*et;let at=Math.round(Math.min(R,V)),ot=Math.round(Math.max(R,V)),lt=X*nt+at*4;for(let ct=at;ct<=ot;ct++)et=(R-ct)/(R-V),et<0?et=0:et>1&&(et=1),G[lt++]=j-(j-Z)*et|0,G[lt++]=z-(z-Y)*et|0,G[lt++]=W-(W-st)*et|0,G[lt++]=255}}function e(_,b,M){let N=b.coords,P=b.colors,c,f;switch(b.type){case"lattice":let k=b.verticesPerRow,B=Math.floor(N.length/k)-1,O=k-1;for(c=0;c<B;c++){let G=c*k;for(let X=0;X<O;X++,G++)n(_,M,N[G],N[G+1],N[G+k],P[G],P[G+1],P[G+k]),n(_,M,N[G+k+1],N[G+1],N[G+k],P[G+k+1],P[G+1],P[G+k])}break;case"triangles":for(c=0,f=N.length;c<f;c+=3)n(_,M,N[c],N[c+1],N[c+2],P[c],P[c+1],P[c+2]);break;default:throw new Error("illegal figure")}}class d extends I{constructor(b){super(),this._coords=b[2],this._colors=b[3],this._figures=b[4],this._bounds=b[5],this._bbox=b[7],this._background=b[8],this.matrix=null}_createMeshCanvas(b,M,N){let k=Math.floor(this._bounds[0]),B=Math.floor(this._bounds[1]),O=Math.ceil(this._bounds[2])-k,G=Math.ceil(this._bounds[3])-B,X=Math.min(Math.ceil(Math.abs(O*b[0]*1.1)),3e3),K=Math.min(Math.ceil(Math.abs(G*b[1]*1.1)),3e3),rt=O/X,Q=G/K,tt={coords:this._coords,colors:this._colors,offsetX:-k,offsetY:-B,scaleX:1/rt,scaleY:1/Q},$=X+2*2,U=K+2*2,L=N.getCanvas("mesh",$,U,!1),S=L.context,o=S.createImageData(X,K);if(M){let m=o.data;for(let E=0,t=m.length;E<t;E+=4)m[E]=M[0],m[E+1]=M[1],m[E+2]=M[2],m[E+3]=255}for(let m of this._figures)e(o,m,tt);return S.putImageData(o,2,2),{canvas:L.canvas,offsetX:k-2*rt,offsetY:B-2*Q,scaleX:rt,scaleY:Q}}getPattern(b,M,N,P){x(b,this._bbox);let c;if(P===F.SHADING)c=a.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(b));else if(c=a.Util.singularValueDecompose2dScale(M.baseTransform),this.matrix){let k=a.Util.singularValueDecompose2dScale(this.matrix);c=[c[0]*k[0],c[1]*k[1]]}let f=this._createMeshCanvas(c,P===F.SHADING?null:this._background,M.cachedCanvases);return P!==F.SHADING&&(b.setTransform(...M.baseTransform),this.matrix&&b.transform(...this.matrix)),b.translate(f.offsetX,f.offsetY),b.scale(f.scaleX,f.scaleY),b.createPattern(f.canvas,"no-repeat")}}class p extends I{getPattern(){return"hotpink"}}function i(_){switch(_[0]){case"RadialAxial":return new y(_);case"Mesh":return new d(_);case"Dummy":return new p}throw new Error(`Unknown IR type: ${_[0]}`)}let A={COLORED:1,UNCOLORED:2};class T{static MAX_PATTERN_SIZE=3e3;constructor(b,M,N,P,c){this.operatorList=b[2],this.matrix=b[3]||[1,0,0,1,0,0],this.bbox=b[4],this.xstep=b[5],this.ystep=b[6],this.paintType=b[7],this.tilingType=b[8],this.color=M,this.ctx=N,this.canvasGraphicsFactory=P,this.baseTransform=c}createPatternCanvas(b){let M=this.operatorList,N=this.bbox,P=this.xstep,c=this.ystep,f=this.paintType,k=this.tilingType,B=this.color,O=this.canvasGraphicsFactory;(0,a.info)("TilingType: "+k);let G=N[0],X=N[1],K=N[2],rt=N[3],Q=a.Util.singularValueDecompose2dScale(this.matrix),tt=a.Util.singularValueDecompose2dScale(this.baseTransform),$=[Q[0]*tt[0],Q[1]*tt[1]],U=this.getSizeAndScale(P,this.ctx.canvas.width,$[0]),L=this.getSizeAndScale(c,this.ctx.canvas.height,$[1]),S=b.cachedCanvases.getCanvas("pattern",U.size,L.size,!0),o=S.context,l=O.createCanvasGraphics(o);l.groupLevel=b.groupLevel,this.setFillAndStrokeStyleToContext(l,f,B);let m=G,E=X,t=K,r=rt;return G<0&&(m=0,t+=Math.abs(G)),X<0&&(E=0,r+=Math.abs(X)),o.translate(-(U.scale*m),-(L.scale*E)),l.transform(U.scale,0,0,L.scale,0,0),o.save(),this.clipBbox(l,m,E,t,r),l.baseTransform=(0,u.getCurrentTransform)(l.ctx),l.executeOperatorList(M),l.endDrawing(),{canvas:S.canvas,scaleX:U.scale,scaleY:L.scale,offsetX:m,offsetY:E}}getSizeAndScale(b,M,N){b=Math.abs(b);let P=Math.max(T.MAX_PATTERN_SIZE,M),c=Math.ceil(b*N);return c>=P?c=P:N=c/b,{scale:N,size:c}}clipBbox(b,M,N,P,c){let f=P-M,k=c-N;b.ctx.rect(M,N,f,k),b.current.updateRectMinMax((0,u.getCurrentTransform)(b.ctx),[M,N,P,c]),b.clip(),b.endPath()}setFillAndStrokeStyleToContext(b,M,N){let P=b.ctx,c=b.current;switch(M){case A.COLORED:let f=this.ctx;P.fillStyle=f.fillStyle,P.strokeStyle=f.strokeStyle,c.fillColor=f.fillStyle,c.strokeColor=f.strokeStyle;break;case A.UNCOLORED:let k=a.Util.makeHexColor(N[0],N[1],N[2]);P.fillStyle=k,P.strokeStyle=k,c.fillColor=k,c.strokeColor=k;break;default:throw new a.FormatError(`Unsupported paint type: ${M}`)}}getPattern(b,M,N,P){let c=N;P!==F.SHADING&&(c=a.Util.transform(c,M.baseTransform),this.matrix&&(c=a.Util.transform(c,this.matrix)));let f=this.createPatternCanvas(M),k=new DOMMatrix(c);k=k.translate(f.offsetX,f.offsetY),k=k.scale(1/f.scaleX,1/f.scaleY);let B=b.createPattern(f.canvas,"repeat");return B.setTransform(k),B}}s.TilingPattern=T},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.convertBlackAndWhiteToRGBA=F,s.convertToRGBA=u,s.grayToRGBA=I;var a=C(1);function u(y){switch(y.kind){case a.ImageKind.GRAYSCALE_1BPP:return F(y);case a.ImageKind.RGB_24BPP:return x(y)}return null}function F({src:y,srcPos:n=0,dest:e,width:d,height:p,nonBlackColor:i=4294967295,inverseDecode:A=!1}){let T=a.FeatureTest.isLittleEndian?4278190080:255,[_,b]=A?[i,T]:[T,i],M=d>>3,N=d&7,P=y.length;e=new Uint32Array(e.buffer);let c=0;for(let f=0;f<p;f++){for(let B=n+M;n<B;n++){let O=n<P?y[n]:255;e[c++]=O&128?b:_,e[c++]=O&64?b:_,e[c++]=O&32?b:_,e[c++]=O&16?b:_,e[c++]=O&8?b:_,e[c++]=O&4?b:_,e[c++]=O&2?b:_,e[c++]=O&1?b:_}if(N===0)continue;let k=n<P?y[n++]:255;for(let B=0;B<N;B++)e[c++]=k&1<<7-B?b:_}return{srcPos:n,destPos:c}}function x({src:y,srcPos:n=0,dest:e,destPos:d=0,width:p,height:i}){let A=0,T=y.length>>2,_=new Uint32Array(y.buffer,n,T);if(a.FeatureTest.isLittleEndian){for(;A<T-2;A+=3,d+=4){let b=_[A],M=_[A+1],N=_[A+2];e[d]=b|4278190080,e[d+1]=b>>>24|M<<8|4278190080,e[d+2]=M>>>16|N<<16|4278190080,e[d+3]=N>>>8|4278190080}for(let b=A*4,M=y.length;b<M;b+=3)e[d++]=y[b]|y[b+1]<<8|y[b+2]<<16|4278190080}else{for(;A<T-2;A+=3,d+=4){let b=_[A],M=_[A+1],N=_[A+2];e[d]=b|255,e[d+1]=b<<24|M>>>8|255,e[d+2]=M<<16|N>>>16|255,e[d+3]=N<<8|255}for(let b=A*4,M=y.length;b<M;b+=3)e[d++]=y[b]<<24|y[b+1]<<16|y[b+2]<<8|255}return{srcPos:n,destPos:d}}function I(y,n){if(a.FeatureTest.isLittleEndian)for(let e=0,d=y.length;e<d;e++)n[e]=y[e]*65793|4278190080;else for(let e=0,d=y.length;e<d;e++)n[e]=y[e]*16843008|255}},(D,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.GlobalWorkerOptions=void 0;let C=Object.create(null);s.GlobalWorkerOptions=C,C.workerPort=null,C.workerSrc=""},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.MessageHandler=void 0;var a=C(1);let u={UNKNOWN:0,DATA:1,ERROR:2},F={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function x(y){switch(y instanceof Error||typeof y=="object"&&y!==null||(0,a.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),y.name){case"AbortException":return new a.AbortException(y.message);case"MissingPDFException":return new a.MissingPDFException(y.message);case"PasswordException":return new a.PasswordException(y.message,y.code);case"UnexpectedResponseException":return new a.UnexpectedResponseException(y.message,y.status);case"UnknownErrorException":return new a.UnknownErrorException(y.message,y.details);default:return new a.UnknownErrorException(y.message,y.toString())}}class I{constructor(n,e,d){this.sourceName=n,this.targetName=e,this.comObj=d,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=p=>{let i=p.data;if(i.targetName!==this.sourceName)return;if(i.stream){this.#e(i);return}if(i.callback){let T=i.callbackId,_=this.callbackCapabilities[T];if(!_)throw new Error(`Cannot resolve callback ${T}`);if(delete this.callbackCapabilities[T],i.callback===u.DATA)_.resolve(i.data);else if(i.callback===u.ERROR)_.reject(x(i.reason));else throw new Error("Unexpected callback case");return}let A=this.actionHandler[i.action];if(!A)throw new Error(`Unknown action from worker: ${i.action}`);if(i.callbackId){let T=this.sourceName,_=i.sourceName;new Promise(function(b){b(A(i.data))}).then(function(b){d.postMessage({sourceName:T,targetName:_,callback:u.DATA,callbackId:i.callbackId,data:b})},function(b){d.postMessage({sourceName:T,targetName:_,callback:u.ERROR,callbackId:i.callbackId,reason:x(b)})});return}if(i.streamId){this.#t(i);return}A(i.data)},d.addEventListener("message",this._onComObjOnMessage)}on(n,e){let d=this.actionHandler;if(d[n])throw new Error(`There is already an actionName called "${n}"`);d[n]=e}send(n,e,d){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:n,data:e},d)}sendWithPromise(n,e,d){let p=this.callbackId++,i=new a.PromiseCapability;this.callbackCapabilities[p]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:n,callbackId:p,data:e},d)}catch(A){i.reject(A)}return i.promise}sendWithStream(n,e,d,p){let i=this.streamId++,A=this.sourceName,T=this.targetName,_=this.comObj;return new ReadableStream({start:b=>{let M=new a.PromiseCapability;return this.streamControllers[i]={controller:b,startCall:M,pullCall:null,cancelCall:null,isClosed:!1},_.postMessage({sourceName:A,targetName:T,action:n,streamId:i,data:e,desiredSize:b.desiredSize},p),M.promise},pull:b=>{let M=new a.PromiseCapability;return this.streamControllers[i].pullCall=M,_.postMessage({sourceName:A,targetName:T,stream:F.PULL,streamId:i,desiredSize:b.desiredSize}),M.promise},cancel:b=>{(0,a.assert)(b instanceof Error,"cancel must have a valid reason");let M=new a.PromiseCapability;return this.streamControllers[i].cancelCall=M,this.streamControllers[i].isClosed=!0,_.postMessage({sourceName:A,targetName:T,stream:F.CANCEL,streamId:i,reason:x(b)}),M.promise}},d)}#t(n){let e=n.streamId,d=this.sourceName,p=n.sourceName,i=this.comObj,A=this,T=this.actionHandler[n.action],_={enqueue(b,M=1,N){if(this.isCancelled)return;let P=this.desiredSize;this.desiredSize-=M,P>0&&this.desiredSize<=0&&(this.sinkCapability=new a.PromiseCapability,this.ready=this.sinkCapability.promise),i.postMessage({sourceName:d,targetName:p,stream:F.ENQUEUE,streamId:e,chunk:b},N)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:d,targetName:p,stream:F.CLOSE,streamId:e}),delete A.streamSinks[e])},error(b){(0,a.assert)(b instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:d,targetName:p,stream:F.ERROR,streamId:e,reason:x(b)}))},sinkCapability:new a.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:n.desiredSize,ready:null};_.sinkCapability.resolve(),_.ready=_.sinkCapability.promise,this.streamSinks[e]=_,new Promise(function(b){b(T(n.data,_))}).then(function(){i.postMessage({sourceName:d,targetName:p,stream:F.START_COMPLETE,streamId:e,success:!0})},function(b){i.postMessage({sourceName:d,targetName:p,stream:F.START_COMPLETE,streamId:e,reason:x(b)})})}#e(n){let e=n.streamId,d=this.sourceName,p=n.sourceName,i=this.comObj,A=this.streamControllers[e],T=this.streamSinks[e];switch(n.stream){case F.START_COMPLETE:n.success?A.startCall.resolve():A.startCall.reject(x(n.reason));break;case F.PULL_COMPLETE:n.success?A.pullCall.resolve():A.pullCall.reject(x(n.reason));break;case F.PULL:if(!T){i.postMessage({sourceName:d,targetName:p,stream:F.PULL_COMPLETE,streamId:e,success:!0});break}T.desiredSize<=0&&n.desiredSize>0&&T.sinkCapability.resolve(),T.desiredSize=n.desiredSize,new Promise(function(_){_(T.onPull?.())}).then(function(){i.postMessage({sourceName:d,targetName:p,stream:F.PULL_COMPLETE,streamId:e,success:!0})},function(_){i.postMessage({sourceName:d,targetName:p,stream:F.PULL_COMPLETE,streamId:e,reason:x(_)})});break;case F.ENQUEUE:if((0,a.assert)(A,"enqueue should have stream controller"),A.isClosed)break;A.controller.enqueue(n.chunk);break;case F.CLOSE:if((0,a.assert)(A,"close should have stream controller"),A.isClosed)break;A.isClosed=!0,A.controller.close(),this.#n(A,e);break;case F.ERROR:(0,a.assert)(A,"error should have stream controller"),A.controller.error(x(n.reason)),this.#n(A,e);break;case F.CANCEL_COMPLETE:n.success?A.cancelCall.resolve():A.cancelCall.reject(x(n.reason)),this.#n(A,e);break;case F.CANCEL:if(!T)break;new Promise(function(_){_(T.onCancel?.(x(n.reason)))}).then(function(){i.postMessage({sourceName:d,targetName:p,stream:F.CANCEL_COMPLETE,streamId:e,success:!0})},function(_){i.postMessage({sourceName:d,targetName:p,stream:F.CANCEL_COMPLETE,streamId:e,reason:x(_)})}),T.sinkCapability.reject(x(n.reason)),T.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#n(n,e){await Promise.allSettled([n.startCall?.promise,n.pullCall?.promise,n.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}s.MessageHandler=I},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Metadata=void 0;var a=C(1);class u{#t;#e;constructor({parsedData:x,rawData:I}){this.#t=x,this.#e=I}getRaw(){return this.#e}get(x){return this.#t.get(x)??null}getAll(){return(0,a.objectFromMap)(this.#t)}has(x){return this.#t.has(x)}}s.Metadata=u},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionalContentConfig=void 0;var a=C(1),u=C(8);let F=Symbol("INTERNAL");class x{#t=!0;constructor(n,e){this.name=n,this.intent=e}get visible(){return this.#t}_setVisible(n,e){n!==F&&(0,a.unreachable)("Internal method `_setVisible` called."),this.#t=e}}class I{#t=null;#e=new Map;#n=null;#s=null;constructor(n){if(this.name=null,this.creator=null,n!==null){this.name=n.name,this.creator=n.creator,this.#s=n.order;for(let e of n.groups)this.#e.set(e.id,new x(e.name,e.intent));if(n.baseState==="OFF")for(let e of this.#e.values())e._setVisible(F,!1);for(let e of n.on)this.#e.get(e)._setVisible(F,!0);for(let e of n.off)this.#e.get(e)._setVisible(F,!1);this.#n=this.getHash()}}#r(n){let e=n.length;if(e<2)return!0;let d=n[0];for(let p=1;p<e;p++){let i=n[p],A;if(Array.isArray(i))A=this.#r(i);else if(this.#e.has(i))A=this.#e.get(i).visible;else return(0,a.warn)(`Optional content group not found: ${i}`),!0;switch(d){case"And":if(!A)return!1;break;case"Or":if(A)return!0;break;case"Not":return!A;default:return!0}}return d==="And"}isVisible(n){if(this.#e.size===0)return!0;if(!n)return(0,a.warn)("Optional content group not defined."),!0;if(n.type==="OCG")return this.#e.has(n.id)?this.#e.get(n.id).visible:((0,a.warn)(`Optional content group not found: ${n.id}`),!0);if(n.type==="OCMD"){if(n.expression)return this.#r(n.expression);if(!n.policy||n.policy==="AnyOn"){for(let e of n.ids){if(!this.#e.has(e))return(0,a.warn)(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(n.policy==="AllOn"){for(let e of n.ids){if(!this.#e.has(e))return(0,a.warn)(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(n.policy==="AnyOff"){for(let e of n.ids){if(!this.#e.has(e))return(0,a.warn)(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(n.policy==="AllOff"){for(let e of n.ids){if(!this.#e.has(e))return(0,a.warn)(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return(0,a.warn)(`Unknown optional content policy ${n.policy}.`),!0}return(0,a.warn)(`Unknown group type ${n.type}.`),!0}setVisibility(n,e=!0){if(!this.#e.has(n)){(0,a.warn)(`Optional content group not found: ${n}`);return}this.#e.get(n)._setVisible(F,!!e),this.#t=null}get hasInitialVisibility(){return this.getHash()===this.#n}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,a.objectFromMap)(this.#e):null}getGroup(n){return this.#e.get(n)||null}getHash(){if(this.#t!==null)return this.#t;let n=new u.MurmurHash3_64;for(let[e,d]of this.#e)n.update(`${e}:${d.visible}`);return this.#t=n.hexdigest()}}s.OptionalContentConfig=I},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFDataTransportStream=void 0;var a=C(1),u=C(6);class F{constructor({length:n,initialData:e,progressiveDone:d=!1,contentDispositionFilename:p=null,disableRange:i=!1,disableStream:A=!1},T){if((0,a.assert)(T,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=d,this._contentDispositionFilename=p,e?.length>0){let _=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;this._queuedChunks.push(_)}this._pdfDataRangeTransport=T,this._isStreamingSupported=!A,this._isRangeSupported=!i,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((_,b)=>{this._onReceiveData({begin:_,chunk:b})}),this._pdfDataRangeTransport.addProgressListener((_,b)=>{this._onProgress({loaded:_,total:b})}),this._pdfDataRangeTransport.addProgressiveReadListener(_=>{this._onReceiveData({chunk:_})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:n,chunk:e}){let d=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(n===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(d):this._queuedChunks.push(d);else{let p=this._rangeReaders.some(function(i){return i._begin!==n?!1:(i._enqueue(d),!0)});(0,a.assert)(p,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(n){n.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:n.loaded}):this._fullRequestReader?.onProgress?.({loaded:n.loaded,total:n.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(n){let e=this._rangeReaders.indexOf(n);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){(0,a.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let n=this._queuedChunks;return this._queuedChunks=null,new x(this,n,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(n,e){if(e<=this._progressiveDataLength)return null;let d=new I(this,n,e);return this._pdfDataRangeTransport.requestDataRange(n,e),this._rangeReaders.push(d),d}cancelAllRequests(n){this._fullRequestReader?.cancel(n);for(let e of this._rangeReaders.slice(0))e.cancel(n);this._pdfDataRangeTransport.abort()}}s.PDFDataTransportStream=F;class x{constructor(n,e,d=!1,p=null){this._stream=n,this._done=d||!1,this._filename=(0,u.isPdfFile)(p)?p:null,this._queuedChunks=e||[],this._loaded=0;for(let i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),n._fullRequestReader=this,this.onProgress=null}_enqueue(n){this._done||(this._requests.length>0?this._requests.shift().resolve({value:n,done:!1}):this._queuedChunks.push(n),this._loaded+=n.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let n=new a.PromiseCapability;return this._requests.push(n),n.promise}cancel(n){this._done=!0;for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class I{constructor(n,e,d){this._stream=n,this._begin=e,this._end=d,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(n){if(!this._done){if(this._requests.length===0)this._queuedChunk=n;else{this._requests.shift().resolve({value:n,done:!1});for(let d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){let e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};let n=new a.PromiseCapability;return this._requests.push(n),n.promise}cancel(n){this._done=!0;for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(D,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.XfaText=void 0;class C{static textContent(u){let F=[],x={items:F,styles:Object.create(null)};function I(y){if(!y)return;let n=null,e=y.name;if(e==="#text")n=y.value;else if(C.shouldBuildText(e))y?.attributes?.textContent?n=y.attributes.textContent:y.value&&(n=y.value);else return;if(n!==null&&F.push({str:n}),!!y.children)for(let d of y.children)I(d)}return I(u),x}static shouldBuildText(u){return!(u==="textarea"||u==="input"||u==="option"||u==="select")}}s.XfaText=C},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NodeStandardFontDataFactory=s.NodeFilterFactory=s.NodeCanvasFactory=s.NodeCMapReaderFactory=void 0;var a=C(7);let u=function(n){return new Promise((e,d)=>{Wt().readFile(n,(i,A)=>{if(i||!A){d(new Error(i));return}e(new Uint8Array(A))})})};class F extends a.BaseFilterFactory{}s.NodeFilterFactory=F;class x extends a.BaseCanvasFactory{_createCanvas(e,d){return Gt().createCanvas(e,d)}}s.NodeCanvasFactory=x;class I extends a.BaseCMapReaderFactory{_fetchData(e,d){return u(e).then(p=>({cMapData:p,compressionType:d}))}}s.NodeCMapReaderFactory=I;class y extends a.BaseStandardFontDataFactory{_fetchData(e){return u(e)}}s.NodeStandardFontDataFactory=y},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFNodeStream=void 0;var a=C(1),u=C(22);let F=Wt(),x=qt(),I=Xt(),y=Vt(),n=/^file:\/\/\/[a-zA-Z]:\//;function e(N){let P=y.parse(N);return P.protocol==="file:"||P.host?P:/^[a-z]:[/\\]/i.test(N)?y.parse(`file:///${N}`):(P.host||(P.protocol="file:"),P)}class d{constructor(P){this.source=P,this.url=e(P.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&P.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new b(this):new T(this),this._fullRequestReader}getRangeReader(P,c){if(c<=this._progressiveDataLength)return null;let f=this.isFsUrl?new M(this,P,c):new _(this,P,c);return this._rangeRequestReaders.push(f),f}cancelAllRequests(P){this._fullRequestReader?.cancel(P);for(let c of this._rangeRequestReaders.slice(0))c.cancel(P)}}s.PDFNodeStream=d;class p{constructor(P){this._url=P.url,this._done=!1,this._storedError=null,this.onProgress=null;let c=P.source;this._contentLength=c.length,this._loaded=0,this._filename=null,this._disableRange=c.disableRange||!1,this._rangeChunkSize=c.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!c.disableStream,this._isRangeSupported=!c.disableRange,this._readableStream=null,this._readCapability=new a.PromiseCapability,this._headersCapability=new a.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let P=this._readableStream.read();return P===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=P.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(P).buffer,done:!1})}cancel(P){if(!this._readableStream){this._error(P);return}this._readableStream.destroy(P)}_error(P){this._storedError=P,this._readCapability.resolve()}_setReadableStream(P){this._readableStream=P,P.on("readable",()=>{this._readCapability.resolve()}),P.on("end",()=>{P.destroy(),this._done=!0,this._readCapability.resolve()}),P.on("error",c=>{this._error(c)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class i{constructor(P){this._url=P.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new a.PromiseCapability;let c=P.source;this._isStreamingSupported=!c.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let P=this._readableStream.read();return P===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=P.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(P).buffer,done:!1})}cancel(P){if(!this._readableStream){this._error(P);return}this._readableStream.destroy(P)}_error(P){this._storedError=P,this._readCapability.resolve()}_setReadableStream(P){this._readableStream=P,P.on("readable",()=>{this._readCapability.resolve()}),P.on("end",()=>{P.destroy(),this._done=!0,this._readCapability.resolve()}),P.on("error",c=>{this._error(c)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function A(N,P){return{protocol:N.protocol,auth:N.auth,host:N.hostname,port:N.port,path:N.path,method:"GET",headers:P}}class T extends p{constructor(P){super(P);let c=f=>{if(f.statusCode===404){let G=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=G,this._headersCapability.reject(G);return}this._headersCapability.resolve(),this._setReadableStream(f);let k=G=>this._readableStream.headers[G.toLowerCase()],{allowRangeRequests:B,suggestedLength:O}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:k,isHttp:P.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=B,this._contentLength=O||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(k)};this._request=null,this._url.protocol==="http:"?this._request=x.request(A(this._url,P.httpHeaders),c):this._request=I.request(A(this._url,P.httpHeaders),c),this._request.on("error",f=>{this._storedError=f,this._headersCapability.reject(f)}),this._request.end()}}class _ extends i{constructor(P,c,f){super(P),this._httpHeaders={};for(let B in P.httpHeaders){let O=P.httpHeaders[B];O!==void 0&&(this._httpHeaders[B]=O)}this._httpHeaders.Range=`bytes=${c}-${f-1}`;let k=B=>{if(B.statusCode===404){let O=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=O;return}this._setReadableStream(B)};this._request=null,this._url.protocol==="http:"?this._request=x.request(A(this._url,this._httpHeaders),k):this._request=I.request(A(this._url,this._httpHeaders),k),this._request.on("error",B=>{this._storedError=B}),this._request.end()}}class b extends p{constructor(P){super(P);let c=decodeURIComponent(this._url.path);n.test(this._url.href)&&(c=c.replace(/^\//,"")),F.lstat(c,(f,k)=>{if(f){f.code==="ENOENT"&&(f=new a.MissingPDFException(`Missing PDF "${c}".`)),this._storedError=f,this._headersCapability.reject(f);return}this._contentLength=k.size,this._setReadableStream(F.createReadStream(c)),this._headersCapability.resolve()})}}class M extends i{constructor(P,c,f){super(P);let k=decodeURIComponent(this._url.path);n.test(this._url.href)&&(k=k.replace(/^\//,"")),this._setReadableStream(F.createReadStream(k,{start:c,end:f-1}))}}},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createResponseStatusError=y,s.extractFilenameFromHeader=I,s.validateRangeRequestCapabilities=x,s.validateResponseStatus=n;var a=C(1),u=C(23),F=C(6);function x({getResponseHeader:e,isHttp:d,rangeChunkSize:p,disableRange:i}){let A={allowRangeRequests:!1,suggestedLength:void 0},T=parseInt(e("Content-Length"),10);return!Number.isInteger(T)||(A.suggestedLength=T,T<=2*p)||i||!d||e("Accept-Ranges")!=="bytes"||(e("Content-Encoding")||"identity")!=="identity"||(A.allowRangeRequests=!0),A}function I(e){let d=e("Content-Disposition");if(d){let p=(0,u.getFilenameFromContentDispositionHeader)(d);if(p.includes("%"))try{p=decodeURIComponent(p)}catch{}if((0,F.isPdfFile)(p))return p}return null}function y(e,d){return e===404||e===0&&d.startsWith("file:")?new a.MissingPDFException('Missing PDF "'+d+'".'):new a.UnexpectedResponseException(`Unexpected server response (${e}) while retrieving PDF "${d}".`,e)}function n(e){return e===200||e===206}},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getFilenameFromContentDispositionHeader=u;var a=C(1);function u(F){let x=!0,I=y("filename\\*","i").exec(F);if(I){I=I[1];let T=p(I);return T=unescape(T),T=i(T),T=A(T),e(T)}if(I=d(F),I){let T=A(I);return e(T)}if(I=y("filename","i").exec(F),I){I=I[1];let T=p(I);return T=A(T),e(T)}function y(T,_){return new RegExp("(?:^|;)\\s*"+T+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',_)}function n(T,_){if(T){if(!/^[\x00-\xFF]+$/.test(_))return _;try{let b=new TextDecoder(T,{fatal:!0}),M=(0,a.stringToBytes)(_);_=b.decode(M),x=!1}catch{}}return _}function e(T){return x&&/[\x80-\xff]/.test(T)&&(T=n("utf-8",T),x&&(T=n("iso-8859-1",T))),T}function d(T){let _=[],b,M=y("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=M.exec(T))!==null;){let[,P,c,f]=b;if(P=parseInt(P,10),P in _){if(P===0)break;continue}_[P]=[c,f]}let N=[];for(let P=0;P<_.length&&P in _;++P){let[c,f]=_[P];f=p(f),c&&(f=unescape(f),P===0&&(f=i(f))),N.push(f)}return N.join("")}function p(T){if(T.startsWith('"')){let _=T.slice(1).split('\\"');for(let b=0;b<_.length;++b){let M=_[b].indexOf('"');M!==-1&&(_[b]=_[b].slice(0,M),_.length=b+1),_[b]=_[b].replaceAll(/\\(.)/g,"$1")}T=_.join('"')}return T}function i(T){let _=T.indexOf("'");if(_===-1)return T;let b=T.slice(0,_),N=T.slice(_+1).replace(/^[^']*'/,"");return n(b,N)}function A(T){return!T.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(T)?T:T.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(_,b,M,N){if(M==="q"||M==="Q")return N=N.replaceAll("_"," "),N=N.replaceAll(/=([0-9a-fA-F]{2})/g,function(P,c){return String.fromCharCode(parseInt(c,16))}),n(b,N);try{N=atob(N)}catch{}return n(b,N)})}return""}},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFNetworkStream=void 0;var a=C(1),u=C(22);let F=200,x=206;function I(p){let i=p.response;return typeof i!="string"?i:(0,a.stringToBytes)(i).buffer}class y{constructor(i,A={}){this.url=i,this.isHttp=/^https?:/i.test(i),this.httpHeaders=this.isHttp&&A.httpHeaders||Object.create(null),this.withCredentials=A.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(i,A,T){let _={begin:i,end:A};for(let b in T)_[b]=T[b];return this.request(_)}requestFull(i){return this.request(i)}request(i){let A=new XMLHttpRequest,T=this.currXhrId++,_=this.pendingRequests[T]={xhr:A};A.open("GET",this.url),A.withCredentials=this.withCredentials;for(let b in this.httpHeaders){let M=this.httpHeaders[b];M!==void 0&&A.setRequestHeader(b,M)}return this.isHttp&&"begin"in i&&"end"in i?(A.setRequestHeader("Range",`bytes=${i.begin}-${i.end-1}`),_.expectedStatus=x):_.expectedStatus=F,A.responseType="arraybuffer",i.onError&&(A.onerror=function(b){i.onError(A.status)}),A.onreadystatechange=this.onStateChange.bind(this,T),A.onprogress=this.onProgress.bind(this,T),_.onHeadersReceived=i.onHeadersReceived,_.onDone=i.onDone,_.onError=i.onError,_.onProgress=i.onProgress,A.send(null),T}onProgress(i,A){let T=this.pendingRequests[i];T&&T.onProgress?.(A)}onStateChange(i,A){let T=this.pendingRequests[i];if(!T)return;let _=T.xhr;if(_.readyState>=2&&T.onHeadersReceived&&(T.onHeadersReceived(),delete T.onHeadersReceived),_.readyState!==4||!(i in this.pendingRequests))return;if(delete this.pendingRequests[i],_.status===0&&this.isHttp){T.onError?.(_.status);return}let b=_.status||F;if(!(b===F&&T.expectedStatus===x)&&b!==T.expectedStatus){T.onError?.(_.status);return}let N=I(_);if(b===x){let P=_.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(P);T.onDone({begin:parseInt(c[1],10),chunk:N})}else N?T.onDone({begin:0,chunk:N}):T.onError?.(_.status)}getRequestXhr(i){return this.pendingRequests[i].xhr}isPendingRequest(i){return i in this.pendingRequests}abortRequest(i){let A=this.pendingRequests[i].xhr;delete this.pendingRequests[i],A.abort()}}class n{constructor(i){this._source=i,this._manager=new y(i.url,{httpHeaders:i.httpHeaders,withCredentials:i.withCredentials}),this._rangeChunkSize=i.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(i){let A=this._rangeRequestReaders.indexOf(i);A>=0&&this._rangeRequestReaders.splice(A,1)}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new e(this._manager,this._source),this._fullRequestReader}getRangeReader(i,A){let T=new d(this._manager,i,A);return T.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(T),T}cancelAllRequests(i){this._fullRequestReader?.cancel(i);for(let A of this._rangeRequestReaders.slice(0))A.cancel(i)}}s.PDFNetworkStream=n;class e{constructor(i,A){this._manager=i;let T={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._fullRequestId=i.requestFull(T),this._headersReceivedCapability=new a.PromiseCapability,this._disableRange=A.disableRange||!1,this._contentLength=A.length,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let i=this._fullRequestId,A=this._manager.getRequestXhr(i),T=M=>A.getResponseHeader(M),{allowRangeRequests:_,suggestedLength:b}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:T,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});_&&(this._isRangeSupported=!0),this._contentLength=b||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(T),this._isRangeSupported&&this._manager.abortRequest(i),this._headersReceivedCapability.resolve()}_onDone(i){if(i&&(this._requests.length>0?this._requests.shift().resolve({value:i.chunk,done:!1}):this._cachedChunks.push(i.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(i){this._storedError=(0,u.createResponseStatusError)(i,this._url),this._headersReceivedCapability.reject(this._storedError);for(let A of this._requests)A.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(i){this.onProgress?.({loaded:i.loaded,total:i.lengthComputable?i.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let i=new a.PromiseCapability;return this._requests.push(i),i.promise}cancel(i){this._done=!0,this._headersReceivedCapability.reject(i);for(let A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class d{constructor(i,A,T){this._manager=i;let _={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=i.url,this._requestId=i.requestRange(A,T,_),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(i){let A=i.chunk;this._requests.length>0?this._requests.shift().resolve({value:A,done:!1}):this._queuedChunk=A,this._done=!0;for(let T of this._requests)T.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(i){this._storedError=(0,u.createResponseStatusError)(i,this._url);for(let A of this._requests)A.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(i){this.isStreamingSupported||this.onProgress?.({loaded:i.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let A=this._queuedChunk;return this._queuedChunk=null,{value:A,done:!1}}if(this._done)return{value:void 0,done:!0};let i=new a.PromiseCapability;return this._requests.push(i),i.promise}cancel(i){this._done=!0;for(let A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFFetchStream=void 0;var a=C(1),u=C(22);function F(d,p,i){return{method:"GET",headers:d,signal:i.signal,mode:"cors",credentials:p?"include":"same-origin",redirect:"follow"}}function x(d){let p=new Headers;for(let i in d){let A=d[i];A!==void 0&&p.append(i,A)}return p}function I(d){return d instanceof Uint8Array?d.buffer:d instanceof ArrayBuffer?d:((0,a.warn)(`getArrayBuffer - unexpected data format: ${d}`),new Uint8Array(d).buffer)}class y{constructor(p){this.source=p,this.isHttp=/^https?:/i.test(p.url),this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new n(this),this._fullRequestReader}getRangeReader(p,i){if(i<=this._progressiveDataLength)return null;let A=new e(this,p,i);return this._rangeRequestReaders.push(A),A}cancelAllRequests(p){this._fullRequestReader?.cancel(p);for(let i of this._rangeRequestReaders.slice(0))i.cancel(p)}}s.PDFFetchStream=y;class n{constructor(p){this._stream=p,this._reader=null,this._loaded=0,this._filename=null;let i=p.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=new a.PromiseCapability,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._headers=x(this._stream.httpHeaders);let A=i.url;fetch(A,F(this._headers,this._withCredentials,this._abortController)).then(T=>{if(!(0,u.validateResponseStatus)(T.status))throw(0,u.createResponseStatusError)(T.status,A);this._reader=T.body.getReader(),this._headersCapability.resolve();let _=N=>T.headers.get(N),{allowRangeRequests:b,suggestedLength:M}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=b,this._contentLength=M||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(_),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new a.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;let{value:p,done:i}=await this._reader.read();return i?{value:p,done:i}:(this._loaded+=p.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:I(p),done:!1})}cancel(p){this._reader?.cancel(p),this._abortController.abort()}}class e{constructor(p,i,A){this._stream=p,this._reader=null,this._loaded=0;let T=p.source;this._withCredentials=T.withCredentials||!1,this._readCapability=new a.PromiseCapability,this._isStreamingSupported=!T.disableStream,this._abortController=new AbortController,this._headers=x(this._stream.httpHeaders),this._headers.append("Range",`bytes=${i}-${A-1}`);let _=T.url;fetch(_,F(this._headers,this._withCredentials,this._abortController)).then(b=>{if(!(0,u.validateResponseStatus)(b.status))throw(0,u.createResponseStatusError)(b.status,_);this._readCapability.resolve(),this._reader=b.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;let{value:p,done:i}=await this._reader.read();return i?{value:p,done:i}:(this._loaded+=p.byteLength,this.onProgress?.({loaded:this._loaded}),{value:I(p),done:!1})}cancel(p){this._reader?.cancel(p),this._abortController.abort()}}},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TextLayerRenderTask=void 0,s.renderTextLayer=T,s.updateTextLayer=_;var a=C(1),u=C(6);let F=1e5,x=30,I=.8,y=new Map;function n(b,M){let N;if(M&&a.FeatureTest.isOffscreenCanvasSupported)N=new OffscreenCanvas(b,b).getContext("2d",{alpha:!1});else{let P=document.createElement("canvas");P.width=P.height=b,N=P.getContext("2d",{alpha:!1})}return N}function e(b,M){let N=y.get(b);if(N)return N;let P=n(x,M);P.font=`${x}px ${b}`;let c=P.measureText(""),f=c.fontBoundingBoxAscent,k=Math.abs(c.fontBoundingBoxDescent);if(f){let O=f/(f+k);return y.set(b,O),P.canvas.width=P.canvas.height=0,O}P.strokeStyle="red",P.clearRect(0,0,x,x),P.strokeText("g",0,0);let B=P.getImageData(0,0,x,x).data;k=0;for(let O=B.length-1-3;O>=0;O-=4)if(B[O]>0){k=Math.ceil(O/4/x);break}P.clearRect(0,0,x,x),P.strokeText("A",0,x),B=P.getImageData(0,0,x,x).data,f=0;for(let O=0,G=B.length;O<G;O+=4)if(B[O]>0){f=x-Math.floor(O/4/x);break}if(P.canvas.width=P.canvas.height=0,f){let O=f/(f+k);return y.set(b,O),O}return y.set(b,I),I}function d(b,M,N){let P=document.createElement("span"),c={angle:0,canvasWidth:0,hasText:M.str!=="",hasEOL:M.hasEOL,fontSize:0};b._textDivs.push(P);let f=a.Util.transform(b._transform,M.transform),k=Math.atan2(f[1],f[0]),B=N[M.fontName];B.vertical&&(k+=Math.PI/2);let O=Math.hypot(f[2],f[3]),G=O*e(B.fontFamily,b._isOffscreenCanvasSupported),X,K;k===0?(X=f[4],K=f[5]-G):(X=f[4]+G*Math.sin(k),K=f[5]-G*Math.cos(k));let rt="calc(var(--scale-factor)*",Q=P.style;b._container===b._rootContainer?(Q.left=`${(100*X/b._pageWidth).toFixed(2)}%`,Q.top=`${(100*K/b._pageHeight).toFixed(2)}%`):(Q.left=`${rt}${X.toFixed(2)}px)`,Q.top=`${rt}${K.toFixed(2)}px)`),Q.fontSize=`${rt}${O.toFixed(2)}px)`,Q.fontFamily=B.fontFamily,c.fontSize=O,P.setAttribute("role","presentation"),P.textContent=M.str,P.dir=M.dir,b._fontInspectorEnabled&&(P.dataset.fontName=M.fontName),k!==0&&(c.angle=k*(180/Math.PI));let tt=!1;if(M.str.length>1)tt=!0;else if(M.str!==" "&&M.transform[0]!==M.transform[3]){let $=Math.abs(M.transform[0]),U=Math.abs(M.transform[3]);$!==U&&Math.max($,U)/Math.min($,U)>1.5&&(tt=!0)}tt&&(c.canvasWidth=B.vertical?M.height:M.width),b._textDivProperties.set(P,c),b._isReadableStream&&b._layoutText(P)}function p(b){let{div:M,scale:N,properties:P,ctx:c,prevFontSize:f,prevFontFamily:k}=b,{style:B}=M,O="";if(P.canvasWidth!==0&&P.hasText){let{fontFamily:G}=B,{canvasWidth:X,fontSize:K}=P;(f!==K||k!==G)&&(c.font=`${K*N}px ${G}`,b.prevFontSize=K,b.prevFontFamily=G);let{width:rt}=c.measureText(M.textContent);rt>0&&(O=`scaleX(${X*N/rt})`)}P.angle!==0&&(O=`rotate(${P.angle}deg) ${O}`),O.length>0&&(B.transform=O)}function i(b){if(b._canceled)return;let M=b._textDivs,N=b._capability;if(M.length>F){N.resolve();return}if(!b._isReadableStream)for(let c of M)b._layoutText(c);N.resolve()}class A{constructor({textContentSource:M,container:N,viewport:P,textDivs:c,textDivProperties:f,textContentItemsStr:k,isOffscreenCanvasSupported:B}){this._textContentSource=M,this._isReadableStream=M instanceof ReadableStream,this._container=this._rootContainer=N,this._textDivs=c||[],this._textContentItemsStr=k||[],this._isOffscreenCanvasSupported=B,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=f||new WeakMap,this._canceled=!1,this._capability=new a.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:P.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:n(0,B)};let{pageWidth:O,pageHeight:G,pageX:X,pageY:K}=P.rawDims;this._transform=[1,0,0,-1,-X,K+G],this._pageWidth=O,this._pageHeight=G,(0,u.setLayerDimensions)(N,P),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new a.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new a.AbortException("TextLayer task cancelled."))}_processItems(M,N){for(let P of M){if(P.str===void 0){if(P.type==="beginMarkedContentProps"||P.type==="beginMarkedContent"){let c=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),P.id!==null&&this._container.setAttribute("id",`${P.id}`),c.append(this._container)}else P.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(P.str),d(this,P,N)}}_layoutText(M){let N=this._layoutTextParams.properties=this._textDivProperties.get(M);if(this._layoutTextParams.div=M,p(this._layoutTextParams),N.hasText&&this._container.append(M),N.hasEOL){let P=document.createElement("br");P.setAttribute("role","presentation"),this._container.append(P)}}_render(){let M=new a.PromiseCapability,N=Object.create(null);if(this._isReadableStream){let P=()=>{this._reader.read().then(({value:c,done:f})=>{if(f){M.resolve();return}Object.assign(N,c.styles),this._processItems(c.items,N),P()},M.reject)};this._reader=this._textContentSource.getReader(),P()}else if(this._textContentSource){let{items:P,styles:c}=this._textContentSource;this._processItems(P,c),M.resolve()}else throw new Error('No "textContentSource" parameter specified.');M.promise.then(()=>{N=null,i(this)},this._capability.reject)}}s.TextLayerRenderTask=A;function T(b){!b.textContentSource&&(b.textContent||b.textContentStream)&&((0,u.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),b.textContentSource=b.textContent||b.textContentStream);let{container:M,viewport:N}=b,P=getComputedStyle(M),c=P.getPropertyValue("visibility"),f=parseFloat(P.getPropertyValue("--scale-factor"));c==="visible"&&(!f||Math.abs(f-N.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");let k=new A(b);return k._render(),k}function _({container:b,viewport:M,textDivs:N,textDivProperties:P,isOffscreenCanvasSupported:c,mustRotate:f=!0,mustRescale:k=!0}){if(f&&(0,u.setLayerDimensions)(b,{rotation:M.rotation}),k){let B=n(0,c),G={prevFontSize:null,prevFontFamily:null,div:null,scale:M.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:B};for(let X of N)G.properties=P.get(X),G.div=X,p(G)}}},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationEditorLayer=void 0;var a=C(1),u=C(5),F=C(28),x=C(29),I=C(6);class y{#t;#e=!1;#n=this.pointerup.bind(this);#s=this.pointerdown.bind(this);#r=new Map;#d=!1;#c=!1;#i;static _initialized=!1;constructor(e){y._initialized||(y._initialized=!0,F.FreeTextEditor.initialize(e.l10n),x.InkEditor.initialize(e.l10n)),e.uiManager.registerEditorTypes([F.FreeTextEditor,x.InkEditor]),this.#i=e.uiManager,this.pageIndex=e.pageIndex,this.div=e.div,this.#t=e.accessibilityManager,this.#i.addLayer(this)}get isEmpty(){return this.#r.size===0}updateToolbar(e){this.#i.updateToolbar(e)}updateMode(e=this.#i.getMode()){this.#u(),e===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#i.unselectAll(),e!==a.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",e===a.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",e===a.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(e){if(!e&&this.#i.getMode()!==a.AnnotationEditorType.INK)return;if(!e){for(let p of this.#r.values())if(p.isEmpty()){p.setInBackground();return}}this.#l({offsetX:0,offsetY:0}).setInBackground()}setEditingState(e){this.#i.setEditingState(e)}addCommands(e){this.#i.addCommands(e)}enable(){this.div.style.pointerEvents="auto";for(let e of this.#r.values())e.enableEditing()}disable(){this.div.style.pointerEvents="none";for(let e of this.#r.values())e.disableEditing();this.#u(),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(e){this.#i.getActive()!==e&&this.#i.setActiveEditor(e)}enableClick(){this.div.addEventListener("pointerdown",this.#s),this.div.addEventListener("pointerup",this.#n)}disableClick(){this.div.removeEventListener("pointerdown",this.#s),this.div.removeEventListener("pointerup",this.#n)}attach(e){this.#r.set(e.id,e)}detach(e){this.#r.delete(e.id),this.#t?.removePointerInTextLayer(e.contentDiv)}remove(e){this.#i.removeEditor(e),this.detach(e),e.div.style.display="none",setTimeout(()=>{e.div.style.display="",e.div.remove(),e.isAttachedToDOM=!1,document.activeElement===document.body&&this.#i.focusMainContainer()},0),this.#c||this.addInkEditorIfNeeded(!1)}#a(e){e.parent!==this&&(this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(this.#a(e),this.#i.addEditor(e),this.attach(e),!e.isAttachedToDOM){let d=e.render();this.div.append(d),e.isAttachedToDOM=!0}this.moveEditorInDOM(e),e.onceAdded(),this.#i.addToAnnotationStorage(e)}moveEditorInDOM(e){this.#t?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?e.rebuild():this.add(e)}addANewEditor(e){let d=()=>{this.addOrRebuild(e)},p=()=>{e.remove()};this.addCommands({cmd:d,undo:p,mustExec:!0})}addUndoableEditor(e){let d=()=>{this.addOrRebuild(e)},p=()=>{e.remove()};this.addCommands({cmd:d,undo:p,mustExec:!1})}getNextId(){return this.#i.getId()}#h(e){switch(this.#i.getMode()){case a.AnnotationEditorType.FREETEXT:return new F.FreeTextEditor(e);case a.AnnotationEditorType.INK:return new x.InkEditor(e)}return null}deserialize(e){switch(e.annotationType){case a.AnnotationEditorType.FREETEXT:return F.FreeTextEditor.deserialize(e,this,this.#i);case a.AnnotationEditorType.INK:return x.InkEditor.deserialize(e,this,this.#i)}return null}#l(e){let d=this.getNextId(),p=this.#h({parent:this,id:d,x:e.offsetX,y:e.offsetY,uiManager:this.#i});return p&&this.add(p),p}setSelected(e){this.#i.setSelected(e)}toggleSelected(e){this.#i.toggleSelected(e)}isSelected(e){return this.#i.isSelected(e)}unselect(e){this.#i.unselect(e)}pointerup(e){let{isMac:d}=a.FeatureTest.platform;if(!(e.button!==0||e.ctrlKey&&d)&&e.target===this.div&&this.#d){if(this.#d=!1,!this.#e){this.#e=!0;return}this.#l(e)}}pointerdown(e){let{isMac:d}=a.FeatureTest.platform;if(e.button!==0||e.ctrlKey&&d||e.target!==this.div)return;this.#d=!0;let p=this.#i.getActive();this.#e=!p||p.isEmpty()}drop(e){let d=e.dataTransfer.getData("text/plain"),p=this.#i.getEditor(d);if(!p)return;e.preventDefault(),e.dataTransfer.dropEffect="move",this.#a(p);let i=this.div.getBoundingClientRect(),A=e.clientX-i.x,T=e.clientY-i.y;p.translate(A-p.startX,T-p.startY),this.moveEditorInDOM(p),p.div.focus()}dragover(e){e.preventDefault()}destroy(){this.#i.getActive()?.parent===this&&this.#i.setActiveEditor(null);for(let e of this.#r.values())this.#t?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#r.clear(),this.#i.removeLayer(this)}#u(){this.#c=!0;for(let e of this.#r.values())e.isEmpty()&&e.remove();this.#c=!1}render({viewport:e}){this.viewport=e,(0,I.setLayerDimensions)(this.div,e),(0,u.bindEvents)(this,this.div,["dragover","drop"]);for(let d of this.#i.getEditors(this.pageIndex))this.add(d);this.updateMode()}update({viewport:e}){this.#i.commitOrRemove(),this.viewport=e,(0,I.setLayerDimensions)(this.div,{rotation:e.rotation}),this.updateMode()}get pageDimensions(){let{pageWidth:e,pageHeight:d}=this.viewport.rawDims;return[e,d]}}s.AnnotationEditorLayer=y},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FreeTextEditor=void 0;var a=C(1),u=C(5),F=C(4);class x extends F.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#n=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#r;#d="";#c=`${this.id}-editor`;#i=!1;#a;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new u.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],x.prototype.commitOrRemove]]);static _type="freetext";constructor(y){super({...y,name:"freeTextEditor"}),this.#r=y.color||x._defaultColor||F.AnnotationEditor._defaultLineColor,this.#a=y.fontSize||x._defaultFontSize}static initialize(y){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(e=>[e,y.get(e)]));let n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(y,n){switch(y){case a.AnnotationEditorParamsType.FREETEXT_SIZE:x._defaultFontSize=n;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:x._defaultColor=n;break}}updateParams(y,n){switch(y){case a.AnnotationEditorParamsType.FREETEXT_SIZE:this.#h(n);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:this.#l(n);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,x._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,x._defaultColor||F.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,this.#a],[a.AnnotationEditorParamsType.FREETEXT_COLOR,this.#r]]}#h(y){let n=d=>{this.editorDiv.style.fontSize=`calc(${d}px * var(--scale-factor))`,this.translate(0,-(d-this.#a)*this.parentScale),this.#a=d,this.#o()},e=this.#a;this.addCommands({cmd:()=>{n(y)},undo:()=>{n(e)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(y){let n=this.#r;this.addCommands({cmd:()=>{this.#r=this.editorDiv.style.color=y},undo:()=>{this.#r=this.editorDiv.style.color=n},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){let y=this.parentScale;return[-x._internalPadding*y,-(x._internalPadding+this.#a)*y]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#s),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#n))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#c),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#n),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(y){super.focusin(y),y.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}#u(){let y=this.editorDiv.getElementsByTagName("div");if(y.length===0)return this.editorDiv.innerText;let n=[];for(let e of y)n.push(e.innerText.replace(/\r\n?|\n/,""));return n.join(`
`)}#o(){let[y,n]=this.parentDimensions,e;if(this.isAttachedToDOM)e=this.div.getBoundingClientRect();else{let{currentLayer:d,div:p}=this,i=p.style.display;p.style.display="hidden",d.div.append(this.div),e=p.getBoundingClientRect(),p.remove(),p.style.display=i}this.width=e.width/y,this.height=e.height/n}commit(){this.isInEditMode()&&(super.commit(),this.#i||(this.#i=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#d=this.#u().trimEnd(),this.#o())}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(y){this.enableEditMode(),this.editorDiv.focus()}keydown(y){y.target===this.div&&y.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(y){x._keyboardManager.exec(this,y)}editorDivFocus(y){this.isEditing=!0}editorDivBlur(y){this.isEditing=!1}editorDivInput(y){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let y,n;this.width&&(y=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#c),this.enableEditing(),x._l10nPromise.get("editor_free_text2_aria_label").then(d=>this.editorDiv?.setAttribute("aria-label",d)),x._l10nPromise.get("free_text2_default_content").then(d=>this.editorDiv?.setAttribute("default-content",d)),this.editorDiv.contentEditable=!0;let{style:e}=this.editorDiv;if(e.fontSize=`calc(${this.#a}px * var(--scale-factor))`,e.color=this.#r,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,u.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){let[d,p]=this.parentDimensions;this.setAt(y*d,n*p,this.width*d,this.height*p);for(let i of this.#d.split(`
`)){let A=document.createElement("div");A.append(i?document.createTextNode(i):document.createElement("br")),this.editorDiv.append(A)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(y,n,e){let d=super.deserialize(y,n,e);return d.#a=y.fontSize,d.#r=a.Util.makeHexColor(...y.color),d.#d=y.value,d}serialize(){if(this.isEmpty())return null;let y=x._internalPadding*this.parentScale,n=this.getRect(y,y),e=F.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#r);return{annotationType:a.AnnotationEditorType.FREETEXT,color:e,fontSize:this.#a,value:this.#d,pageIndex:this.pageIndex,rect:n,rotation:this.rotation}}}s.FreeTextEditor=x},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InkEditor=void 0;var a=C(1),u=C(4),F=C(5);let x=16;class I extends u.AnnotationEditor{#t=0;#e=0;#n=0;#s=this.canvasContextMenu.bind(this);#r=this.canvasPointermove.bind(this);#d=this.canvasPointerleave.bind(this);#c=this.canvasPointerup.bind(this);#i=this.canvasPointerdown.bind(this);#a=new Path2D;#h=!1;#l=!1;#u=!1;#o=null;#b=0;#A=0;#m=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(n){super({...n,name:"inkEditor"}),this.color=n.color||null,this.thickness=n.thickness||null,this.opacity=n.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(n){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(e=>[e,n.get(e)]))}static updateDefaultParams(n,e){switch(n){case a.AnnotationEditorParamsType.INK_THICKNESS:I._defaultThickness=e;break;case a.AnnotationEditorParamsType.INK_COLOR:I._defaultColor=e;break;case a.AnnotationEditorParamsType.INK_OPACITY:I._defaultOpacity=e/100;break}}updateParams(n,e){switch(n){case a.AnnotationEditorParamsType.INK_THICKNESS:this.#T(e);break;case a.AnnotationEditorParamsType.INK_COLOR:this.#P(e);break;case a.AnnotationEditorParamsType.INK_OPACITY:this.#w(e);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,I._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,I._defaultColor||u.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(I._defaultOpacity*100)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||I._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||I._defaultColor||u.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??I._defaultOpacity))]]}#T(n){let e=this.thickness;this.addCommands({cmd:()=>{this.thickness=n,this.#C()},undo:()=>{this.thickness=e,this.#C()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#P(n){let e=this.color;this.addCommands({cmd:()=>{this.color=n,this.#p()},undo:()=>{this.color=e,this.#p()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#w(n){n/=100;let e=this.opacity;this.addCommands({cmd:()=>{this.opacity=n,this.#p()},undo:()=>{this.opacity=e,this.#p()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(this.#S(),this.#y()),this.isAttachedToDOM||(this.parent.add(this),this.#g()),this.#C())}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#o.disconnect(),this.#o=null,super.remove())}setParent(n){!this.parent&&n?this._uiManager.removeShouldRescale(this):this.parent&&n===null&&this._uiManager.addShouldRescale(this),super.setParent(n)}onScaleChanging(){let[n,e]=this.parentDimensions,d=this.width*n,p=this.height*e;this.setDimensions(d,p)}enableEditMode(){this.#h||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#i))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#i))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#x(){let{parentRotation:n,parentDimensions:[e,d]}=this;switch(n){case 90:return[0,d,d,e];case 180:return[e,d,e,d];case 270:return[e,0,d,e];default:return[0,0,e,d]}}#v(){let{ctx:n,color:e,opacity:d,thickness:p,parentScale:i,scaleFactor:A}=this;n.lineWidth=p*i/A,n.lineCap="round",n.lineJoin="round",n.miterLimit=10,n.strokeStyle=`${e}${(0,F.opacityToHex)(d)}`}#k(n,e){this.canvas.addEventListener("contextmenu",this.#s),this.canvas.addEventListener("pointerleave",this.#d),this.canvas.addEventListener("pointermove",this.#r),this.canvas.addEventListener("pointerup",this.#c),this.canvas.removeEventListener("pointerdown",this.#i),this.isEditing=!0,this.#u||(this.#u=!0,this.#g(),this.thickness||=I._defaultThickness,this.color||=I._defaultColor||u.AnnotationEditor._defaultLineColor,this.opacity??=I._defaultOpacity),this.currentPath.push([n,e]),this.#l=!1,this.#v(),this.#m=()=>{this.#D(),this.#m&&window.requestAnimationFrame(this.#m)},window.requestAnimationFrame(this.#m)}#_(n,e){let[d,p]=this.currentPath.at(-1);if(this.currentPath.length>1&&n===d&&e===p)return;let i=this.currentPath,A=this.#a;if(i.push([n,e]),this.#l=!0,i.length<=2){A.moveTo(...i[0]),A.lineTo(n,e);return}i.length===3&&(this.#a=A=new Path2D,A.moveTo(...i[0])),this.#O(A,...i.at(-3),...i.at(-2),n,e)}#M(){if(this.currentPath.length===0)return;let n=this.currentPath.at(-1);this.#a.lineTo(...n)}#F(n,e){this.#m=null,n=Math.min(Math.max(n,0),this.canvas.width),e=Math.min(Math.max(e,0),this.canvas.height),this.#_(n,e),this.#M();let d;if(this.currentPath.length!==1)d=this.#f();else{let _=[n,e];d=[[_,_.slice(),_.slice(),_]]}let p=this.#a,i=this.currentPath;this.currentPath=[],this.#a=new Path2D;let A=()=>{this.allRawPaths.push(i),this.paths.push(d),this.bezierPath2D.push(p),this.rebuild()},T=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#S(),this.#y()),this.#C())};this.addCommands({cmd:A,undo:T,mustExec:!0})}#D(){if(!this.#l)return;this.#l=!1;let n=Math.ceil(this.thickness*this.parentScale),e=this.currentPath.slice(-3),d=e.map(M=>M[0]),p=e.map(M=>M[1]),i=Math.min(...d)-n,A=Math.max(...d)+n,T=Math.min(...p)-n,_=Math.max(...p)+n,{ctx:b}=this;b.save(),b.clearRect(0,0,this.canvas.width,this.canvas.height);for(let M of this.bezierPath2D)b.stroke(M);b.stroke(this.#a),b.restore()}#O(n,e,d,p,i,A,T){let _=(e+p)/2,b=(d+i)/2,M=(p+A)/2,N=(i+T)/2;n.bezierCurveTo(_+2*(p-_)/3,b+2*(i-b)/3,M+2*(p-M)/3,N+2*(i-N)/3,M,N)}#f(){let n=this.currentPath;if(n.length<=2)return[[n[0],n[0],n.at(-1),n.at(-1)]];let e=[],d,[p,i]=n[0];for(d=1;d<n.length-2;d++){let[P,c]=n[d],[f,k]=n[d+1],B=(P+f)/2,O=(c+k)/2,G=[p+2*(P-p)/3,i+2*(c-i)/3],X=[B+2*(P-B)/3,O+2*(c-O)/3];e.push([[p,i],G,X,[B,O]]),[p,i]=[B,O]}let[A,T]=n[d],[_,b]=n[d+1],M=[p+2*(A-p)/3,i+2*(T-i)/3],N=[_+2*(A-_)/3,b+2*(T-b)/3];return e.push([[p,i],M,N,[_,b]]),e}#p(){if(this.isEmpty()){this.#I();return}this.#v();let{canvas:n,ctx:e}=this;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,n.width,n.height),this.#I();for(let d of this.bezierPath2D)e.stroke(d)}commit(){this.#h||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#h=!0,this.div.classList.add("disabled"),this.#C(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(n){super.focusin(n),this.enableEditMode()}canvasPointerdown(n){n.button!==0||!this.isInEditMode()||this.#h||(this.setInForeground(),n.preventDefault(),n.type!=="mouse"&&this.div.focus(),this.#k(n.offsetX,n.offsetY))}canvasContextMenu(n){n.preventDefault()}canvasPointermove(n){n.preventDefault(),this.#_(n.offsetX,n.offsetY)}canvasPointerup(n){n.preventDefault(),this.#R(n)}canvasPointerleave(n){this.#R(n)}#R(n){this.canvas.removeEventListener("pointerleave",this.#d),this.canvas.removeEventListener("pointermove",this.#r),this.canvas.removeEventListener("pointerup",this.#c),this.canvas.addEventListener("pointerdown",this.#i),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",this.#s)},10),this.#F(n.offsetX,n.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#S(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",I._l10nPromise.get("editor_ink_canvas_aria_label").then(n=>this.canvas?.setAttribute("aria-label",n)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#y(){this.#o=new ResizeObserver(n=>{let e=n[0].contentRect;e.width&&e.height&&this.setDimensions(e.width,e.height)}),this.#o.observe(this.div)}render(){if(this.div)return this.div;let n,e;this.width&&(n=this.x,e=this.y),super.render(),I._l10nPromise.get("editor_ink2_aria_label").then(T=>this.div?.setAttribute("aria-label",T));let[d,p,i,A]=this.#x();if(this.setAt(d,p,0,0),this.setDims(i,A),this.#S(),this.width){let[T,_]=this.parentDimensions;this.setAt(n*T,e*_,this.width*T,this.height*_),this.#u=!0,this.#g(),this.setDims(this.width*T,this.height*_),this.#p(),this.#j(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#y(),this.div}#g(){if(!this.#u)return;let[n,e]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*n),this.canvas.height=Math.ceil(this.height*e),this.#I()}setDimensions(n,e){let d=Math.round(n),p=Math.round(e);if(this.#b===d&&this.#A===p)return;this.#b=d,this.#A=p,this.canvas.style.visibility="hidden",this.#t&&Math.abs(this.#t-n/e)>.01&&(e=Math.ceil(n/this.#t),this.setDims(n,e));let[i,A]=this.parentDimensions;this.width=n/i,this.height=e/A,this.#h&&this.#E(n,e),this.#g(),this.#p(),this.canvas.style.visibility="visible",this.fixDims()}#E(n,e){let d=this.#L(),p=(n-d)/this.#n,i=(e-d)/this.#e;this.scaleFactor=Math.min(p,i)}#I(){let n=this.#L()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+n,this.translationY*this.scaleFactor+n)}static#B(n){let e=new Path2D;for(let d=0,p=n.length;d<p;d++){let[i,A,T,_]=n[d];d===0&&e.moveTo(...i),e.bezierCurveTo(A[0],A[1],T[0],T[1],_[0],_[1])}return e}#U(n,e,d,p){let A=[],T=this.thickness/2,_,b;for(let M of this.paths){_=[],b=[];for(let N=0,P=M.length;N<P;N++){let[c,f,k,B]=M[N],O=n*(c[0]+e)+T,G=p-n*(c[1]+d)-T,X=n*(f[0]+e)+T,K=p-n*(f[1]+d)-T,rt=n*(k[0]+e)+T,Q=p-n*(k[1]+d)-T,tt=n*(B[0]+e)+T,$=p-n*(B[1]+d)-T;N===0&&(_.push(O,G),b.push(O,G)),_.push(X,K,rt,Q,tt,$),this.#W(O,G,X,K,rt,Q,tt,$,4,b)}A.push({bezier:_,points:b})}return A}#W(n,e,d,p,i,A,T,_,b,M){if(this.#H(n,e,d,p,i,A,T,_)){M.push(T,_);return}for(let N=1;N<b-1;N++){let P=N/b,c=1-P,f=P*n+c*d,k=P*e+c*p,B=P*d+c*i,O=P*p+c*A,G=P*i+c*T,X=P*A+c*_;f=P*f+c*B,k=P*k+c*O,B=P*B+c*G,O=P*O+c*X,f=P*f+c*B,k=P*k+c*O,M.push(f,k)}M.push(T,_)}#H(n,e,d,p,i,A,T,_){let M=(3*d-2*n-T)**2,N=(3*p-2*e-_)**2,P=(3*i-n-2*T)**2,c=(3*A-e-2*_)**2;return Math.max(M,P)+Math.max(N,c)<=10}#N(){let n=1/0,e=-1/0,d=1/0,p=-1/0;for(let i of this.paths)for(let[A,T,_,b]of i){let M=a.Util.bezierBoundingBox(...A,...T,..._,...b);n=Math.min(n,M[0]),d=Math.min(d,M[1]),e=Math.max(e,M[2]),p=Math.max(p,M[3])}return[n,d,e,p]}#L(){return this.#h?Math.ceil(this.thickness*this.parentScale):0}#C(n=!1){if(this.isEmpty())return;if(!this.#h){this.#p();return}let e=this.#N(),d=this.#L();this.#n=Math.max(x,e[2]-e[0]),this.#e=Math.max(x,e[3]-e[1]);let p=Math.ceil(d+this.#n*this.scaleFactor),i=Math.ceil(d+this.#e*this.scaleFactor),[A,T]=this.parentDimensions;this.width=p/A,this.height=i/T,this.#t=p/i,this.#j();let _=this.translationX,b=this.translationY;this.translationX=-e[0],this.translationY=-e[1],this.#g(),this.#p(),this.#b=p,this.#A=i,this.setDims(p,i);let M=n?d/this.scaleFactor/2:0;this.translate(_-this.translationX-M,b-this.translationY-M)}#j(){let{style:n}=this.div;this.#t>=1?(n.minHeight=`${x}px`,n.minWidth=`${Math.round(this.#t*x)}px`):(n.minWidth=`${x}px`,n.minHeight=`${Math.round(x/this.#t)}px`)}static deserialize(n,e,d){let p=super.deserialize(n,e,d);p.thickness=n.thickness,p.color=a.Util.makeHexColor(...n.color),p.opacity=n.opacity;let[i,A]=p.pageDimensions,T=p.width*i,_=p.height*A,b=p.parentScale,M=n.thickness/2;p.#t=T/_,p.#h=!0,p.#b=Math.round(T),p.#A=Math.round(_);for(let{bezier:P}of n.paths){let c=[];p.paths.push(c);let f=b*(P[0]-M),k=b*(_-P[1]-M);for(let O=2,G=P.length;O<G;O+=6){let X=b*(P[O]-M),K=b*(_-P[O+1]-M),rt=b*(P[O+2]-M),Q=b*(_-P[O+3]-M),tt=b*(P[O+4]-M),$=b*(_-P[O+5]-M);c.push([[f,k],[X,K],[rt,Q],[tt,$]]),f=tt,k=$}let B=this.#B(c);p.bezierPath2D.push(B)}let N=p.#N();return p.#n=Math.max(x,N[2]-N[0]),p.#e=Math.max(x,N[3]-N[1]),p.#E(T,_),p}serialize(){if(this.isEmpty())return null;let n=this.getRect(0,0),e=this.rotation%180===0?n[3]-n[1]:n[2]-n[0],d=u.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:d,thickness:this.thickness,opacity:this.opacity,paths:this.#U(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:n,rotation:this.rotation}}}s.InkEditor=I},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationLayer=void 0;var a=C(1),u=C(6),F=C(3),x=C(31),I=C(32);let y=1e3,n=9,e=new WeakSet;function d(E){return{width:E[2]-E[0],height:E[3]-E[1]}}class p{static create(t){switch(t.data.annotationType){case a.AnnotationType.LINK:return new A(t);case a.AnnotationType.TEXT:return new T(t);case a.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new b(t);case"Btn":return t.data.radioButton?new N(t):t.data.checkBox?new M(t):new P(t);case"Ch":return new c(t)}return new _(t);case a.AnnotationType.POPUP:return new f(t);case a.AnnotationType.FREETEXT:return new B(t);case a.AnnotationType.LINE:return new O(t);case a.AnnotationType.SQUARE:return new G(t);case a.AnnotationType.CIRCLE:return new X(t);case a.AnnotationType.POLYLINE:return new K(t);case a.AnnotationType.CARET:return new Q(t);case a.AnnotationType.INK:return new tt(t);case a.AnnotationType.POLYGON:return new rt(t);case a.AnnotationType.HIGHLIGHT:return new $(t);case a.AnnotationType.UNDERLINE:return new U(t);case a.AnnotationType.SQUIGGLY:return new L(t);case a.AnnotationType.STRIKEOUT:return new S(t);case a.AnnotationType.STAMP:return new o(t);case a.AnnotationType.FILEATTACHMENT:return new l(t);default:return new i(t)}}}class i{constructor(t,{isRenderable:r=!1,ignoreBorder:h=!1,createQuadrilaterals:g=!1}={}){this.isRenderable=r,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,r&&(this.container=this._createContainer(h)),g&&(this.quadrilaterals=this._createQuadrilaterals(h))}_createContainer(t=!1){let{data:r,page:h,viewport:g}=this,v=document.createElement("section");v.setAttribute("data-annotation-id",r.id),r.noRotate&&v.classList.add("norotate");let{pageWidth:w,pageHeight:R,pageX:j,pageY:z}=g.rawDims,{width:W,height:V}=d(r.rect),Z=a.Util.normalizeRect([r.rect[0],h.view[3]-r.rect[1]+h.view[1],r.rect[2],h.view[3]-r.rect[3]+h.view[1]]);if(!t&&r.borderStyle.width>0){v.style.borderWidth=`${r.borderStyle.width}px`;let st=r.borderStyle.horizontalCornerRadius,nt=r.borderStyle.verticalCornerRadius;if(st>0||nt>0){let at=`calc(${st}px * var(--scale-factor)) / calc(${nt}px * var(--scale-factor))`;v.style.borderRadius=at}else if(this instanceof N){let at=`calc(${W}px * var(--scale-factor)) / calc(${V}px * var(--scale-factor))`;v.style.borderRadius=at}switch(r.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:v.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:v.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:v.style.borderBottomStyle="solid";break;default:break}let et=r.borderColor||null;et?v.style.borderColor=a.Util.makeHexColor(et[0]|0,et[1]|0,et[2]|0):v.style.borderWidth=0}v.style.left=`${100*(Z[0]-j)/w}%`,v.style.top=`${100*(Z[1]-z)/R}%`;let{rotation:Y}=r;return r.hasOwnCanvas||Y===0?(v.style.width=`${100*W/w}%`,v.style.height=`${100*V/R}%`):this.setRotation(Y,v),v}setRotation(t,r=this.container){let{pageWidth:h,pageHeight:g}=this.viewport.rawDims,{width:v,height:w}=d(this.data.rect),R,j;t%180===0?(R=100*v/h,j=100*w/g):(R=100*w/h,j=100*v/g),r.style.width=`${R}%`,r.style.height=`${j}%`,r.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){let t=(r,h,g)=>{let v=g.detail[r];g.target.style[h]=x.ColorConverters[`${v[0]}_HTML`](v.slice(1))};return(0,a.shadow)(this,"_commonActions",{display:r=>{let h=r.detail.display%2===1;this.container.style.visibility=h?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:h,print:r.detail.display===0||r.detail.display===3})},print:r=>{this.annotationStorage.setValue(this.data.id,{print:r.detail.print})},hidden:r=>{this.container.style.visibility=r.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:r.detail.hidden})},focus:r=>{setTimeout(()=>r.target.focus({preventScroll:!1}),0)},userName:r=>{r.target.title=r.detail.userName},readonly:r=>{r.detail.readonly?r.target.setAttribute("readonly",""):r.target.removeAttribute("readonly")},required:r=>{this._setRequired(r.target,r.detail.required)},bgColor:r=>{t("bgColor","backgroundColor",r)},fillColor:r=>{t("fillColor","backgroundColor",r)},fgColor:r=>{t("fgColor","color",r)},textColor:r=>{t("textColor","color",r)},borderColor:r=>{t("borderColor","borderColor",r)},strokeColor:r=>{t("strokeColor","borderColor",r)},rotation:r=>{let h=r.detail.rotation;this.setRotation(h),this.annotationStorage.setValue(this.data.id,{rotation:h})}})}_dispatchEventFromSandbox(t,r){let h=this._commonActions;for(let g of Object.keys(r.detail))(t[g]||h[g])?.(r)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;let r=this.annotationStorage.getRawValue(this.data.id);if(!r)return;let h=this._commonActions;for(let[g,v]of Object.entries(r)){let w=h[g];if(w){let R={detail:{[g]:v},target:t};w(R),delete r[g]}}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;let r=[],h=this.data.rect;for(let g of this.data.quadPoints)this.data.rect=[g[2].x,g[2].y,g[1].x,g[1].y],r.push(this._createContainer(t));return this.data.rect=h,r}_createPopup(t,r){let h=this.container;this.quadrilaterals&&(t||=this.quadrilaterals,h=this.quadrilaterals[0]),t||(t=document.createElement("div"),t.classList.add("popupTriggerArea"),h.append(t));let v=new k({container:h,trigger:t,color:r.color,titleObj:r.titleObj,modificationDate:r.modificationDate,contentsObj:r.contentsObj,richText:r.richText,hideWrapper:!0}).render();v.style.left="100%",h.append(v)}_renderQuadrilaterals(t){for(let r of this.quadrilaterals)r.classList.add(t);return this.quadrilaterals}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,r=null){let h=[];if(this._fieldObjects){let g=this._fieldObjects[t];if(g)for(let{page:v,id:w,exportValues:R}of g){if(v===-1||w===r)continue;let j=typeof R=="string"?R:null,z=document.querySelector(`[data-element-id="${w}"]`);if(z&&!e.has(z)){(0,a.warn)(`_getElementsByName - element not allowed: ${w}`);continue}h.push({id:w,exportValue:j,domElement:z})}return h}for(let g of document.getElementsByName(t)){let{exportValue:v}=g,w=g.getAttribute("data-element-id");w!==r&&e.has(g)&&h.push({id:w,exportValue:v,domElement:g})}return h}}class A extends i{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!r?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){let{data:t,linkService:r}=this,h=document.createElement("a");h.setAttribute("data-element-id",t.id);let g=!1;return t.url?(r.addLinkAttributes(h,t.url,t.newWindow),g=!0):t.action?(this._bindNamedAction(h,t.action),g=!0):t.attachment?(this._bindAttachment(h,t.attachment),g=!0):t.setOCGState?(this.#e(h,t.setOCGState),g=!0):t.dest?(this._bindLink(h,t.dest),g=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(h,t),g=!0),t.resetForm?(this._bindResetFormAction(h,t.resetForm),g=!0):this.isTooltipOnly&&!g&&(this._bindLink(h,""),g=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((v,w)=>{let R=w===0?h:h.cloneNode();return v.append(R),v}):(this.container.classList.add("linkAnnotation"),g&&this.container.append(h),this.container)}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,r){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&this.#t()}_bindNamedAction(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),this.#t()}_bindAttachment(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,r.content,r.filename),!1),this.#t()}#e(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),this.#t()}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");let h=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let g of Object.keys(r.actions)){let v=h.get(g);v&&(t[v]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:g}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,r){let h=t.onclick;if(h||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,a.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),h||(t.onclick=()=>!1);return}t.onclick=()=>{h?.();let{fields:g,refs:v,include:w}=r,R=[];if(g.length!==0||v.length!==0){let W=new Set(v);for(let V of g){let Z=this._fieldObjects[V]||[];for(let{id:Y}of Z)W.add(Y)}for(let V of Object.values(this._fieldObjects))for(let Z of V)W.has(Z.id)===w&&R.push(Z)}else for(let W of Object.values(this._fieldObjects))R.push(...W);let j=this.annotationStorage,z=[];for(let W of R){let{id:V}=W;switch(z.push(V),W.type){case"text":{let Y=W.defaultValue||"";j.setValue(V,{value:Y});break}case"checkbox":case"radiobutton":{let Y=W.defaultValue===W.exportValues;j.setValue(V,{value:Y});break}case"combobox":case"listbox":{let Y=W.defaultValue||"";j.setValue(V,{value:Y});break}default:continue}let Z=document.querySelector(`[data-element-id="${V}"]`);if(Z){if(!e.has(Z)){(0,a.warn)(`_bindResetFormAction - element not allowed: ${V}`);continue}}else continue;Z.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:z,name:"ResetForm"}}),!1}}}class T extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r})}render(){this.container.classList.add("textAnnotation");let t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.append(t),this.container}}class _ extends i{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){let{isWin:r,isMac:h}=a.FeatureTest.platform;return r&&t.ctrlKey||h&&t.metaKey}_setEventListener(t,r,h,g){r.includes("mouse")?t.addEventListener(r,v=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:h,value:g(v),shift:v.shiftKey,modifier:this._getKeyModifier(v)}})}):t.addEventListener(r,v=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:h,value:g(v)}})})}_setEventListeners(t,r,h){for(let[g,v]of r)(v==="Action"||this.data.actions?.[v])&&this._setEventListener(t,g,v,h)}_setBackgroundColor(t){let r=this.data.backgroundColor||null;t.style.backgroundColor=r===null?"transparent":a.Util.makeHexColor(r[0],r[1],r[2])}_setTextStyle(t){let r=["left","center","right"],{fontColor:h}=this.data.defaultAppearanceData,g=this.data.defaultAppearanceData.fontSize||n,v=t.style,w,R=2,j=z=>Math.round(10*z)/10;if(this.data.multiLine){let z=Math.abs(this.data.rect[3]-this.data.rect[1]-R),W=Math.round(z/(a.LINE_FACTOR*g))||1,V=z/W;w=Math.min(g,j(V/a.LINE_FACTOR))}else{let z=Math.abs(this.data.rect[3]-this.data.rect[1]-R);w=Math.min(g,j(z/a.LINE_FACTOR))}v.fontSize=`calc(${w}px * var(--scale-factor))`,v.color=a.Util.makeHexColor(h[0],h[1],h[2]),this.data.textAlignment!==null&&(v.textAlign=r[this.data.textAlignment])}_setRequired(t,r){r?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",r)}}class b extends _{constructor(t){let r=t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:r})}setPropertyOnSiblings(t,r,h,g){let v=this.annotationStorage;for(let w of this._getElementsByName(t.name,t.id))w.domElement&&(w.domElement[r]=h),v.setValue(w.id,{[g]:h})}render(){let t=this.annotationStorage,r=this.data.id;this.container.classList.add("textWidgetAnnotation");let h=null;if(this.renderForms){let g=t.getValue(r,{value:this.data.fieldValue}),v=g.value||"",w=t.getValue(r,{charLimit:this.data.maxLen}).charLimit;w&&v.length>w&&(v=v.slice(0,w));let R=g.formattedValue||this.data.textContent?.join(`
`)||null;R&&this.data.comb&&(R=R.replaceAll(/\s+/g,""));let j={userValue:v,formattedValue:R,lastCommittedValue:null,commitKey:1};this.data.multiLine?(h=document.createElement("textarea"),h.textContent=R??v,this.data.doNotScroll&&(h.style.overflowY="hidden")):(h=document.createElement("input"),h.type="text",h.setAttribute("value",R??v),this.data.doNotScroll&&(h.style.overflowX="hidden")),this.data.hasOwnCanvas&&(h.hidden=!0),e.add(h),h.setAttribute("data-element-id",r),h.disabled=this.data.readOnly,h.name=this.data.fieldName,h.tabIndex=y,this._setRequired(h,this.data.required),w&&(h.maxLength=w),h.addEventListener("input",W=>{t.setValue(r,{value:W.target.value}),this.setPropertyOnSiblings(h,"value",W.target.value,"value"),j.formattedValue=null}),h.addEventListener("resetform",W=>{let V=this.data.defaultFieldValue??"";h.value=j.userValue=V,j.formattedValue=null});let z=W=>{let{formattedValue:V}=j;V!=null&&(W.target.value=V),W.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){h.addEventListener("focus",V=>{let{target:Z}=V;j.userValue&&(Z.value=j.userValue),j.lastCommittedValue=Z.value,j.commitKey=1}),h.addEventListener("updatefromsandbox",V=>{this.showElementAndHideCanvas(V.target);let Z={value(Y){j.userValue=Y.detail.value??"",t.setValue(r,{value:j.userValue.toString()}),Y.target.value=j.userValue},formattedValue(Y){let{formattedValue:st}=Y.detail;j.formattedValue=st,st!=null&&Y.target!==document.activeElement&&(Y.target.value=st),t.setValue(r,{formattedValue:st})},selRange(Y){Y.target.setSelectionRange(...Y.detail.selRange)},charLimit:Y=>{let{charLimit:st}=Y.detail,{target:nt}=Y;if(st===0){nt.removeAttribute("maxLength");return}nt.setAttribute("maxLength",st);let et=j.userValue;!et||et.length<=st||(et=et.slice(0,st),nt.value=j.userValue=et,t.setValue(r,{value:et}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:et,willCommit:!0,commitKey:1,selStart:nt.selectionStart,selEnd:nt.selectionEnd}}))}};this._dispatchEventFromSandbox(Z,V)}),h.addEventListener("keydown",V=>{j.commitKey=1;let Z=-1;if(V.key==="Escape"?Z=0:V.key==="Enter"&&!this.data.multiLine?Z=2:V.key==="Tab"&&(j.commitKey=3),Z===-1)return;let{value:Y}=V.target;j.lastCommittedValue!==Y&&(j.lastCommittedValue=Y,j.userValue=Y,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:Y,willCommit:!0,commitKey:Z,selStart:V.target.selectionStart,selEnd:V.target.selectionEnd}}))});let W=z;z=null,h.addEventListener("blur",V=>{if(!V.relatedTarget)return;let{value:Z}=V.target;j.userValue=Z,j.lastCommittedValue!==Z&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:Z,willCommit:!0,commitKey:j.commitKey,selStart:V.target.selectionStart,selEnd:V.target.selectionEnd}}),W(V)}),this.data.actions?.Keystroke&&h.addEventListener("beforeinput",V=>{j.lastCommittedValue=null;let{data:Z,target:Y}=V,{value:st,selectionStart:nt,selectionEnd:et}=Y,at=nt,ot=et;switch(V.inputType){case"deleteWordBackward":{let lt=st.substring(0,nt).match(/\w*[^\w]*$/);lt&&(at-=lt[0].length);break}case"deleteWordForward":{let lt=st.substring(nt).match(/^[^\w]*\w*/);lt&&(ot+=lt[0].length);break}case"deleteContentBackward":nt===et&&(at-=1);break;case"deleteContentForward":nt===et&&(ot+=1);break}V.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:st,change:Z||"",willCommit:!1,selStart:at,selEnd:ot}})}),this._setEventListeners(h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],V=>V.target.value)}if(z&&h.addEventListener("blur",z),this.data.comb){let V=(this.data.rect[2]-this.data.rect[0])/w;h.classList.add("comb"),h.style.letterSpacing=`calc(${V}px * var(--scale-factor) - 1ch)`}}else h=document.createElement("div"),h.textContent=this.data.fieldValue,h.style.verticalAlign="middle",h.style.display="table-cell";return this._setTextStyle(h),this._setBackgroundColor(h),this._setDefaultPropertiesFromJS(h),this.container.append(h),this.container}}class M extends _{constructor(t){super(t,{isRenderable:t.renderForms})}render(){let t=this.annotationStorage,r=this.data,h=r.id,g=t.getValue(h,{value:r.exportValue===r.fieldValue}).value;typeof g=="string"&&(g=g!=="Off",t.setValue(h,{value:g})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let v=document.createElement("input");return e.add(v),v.setAttribute("data-element-id",h),v.disabled=r.readOnly,this._setRequired(v,this.data.required),v.type="checkbox",v.name=r.fieldName,g&&v.setAttribute("checked",!0),v.setAttribute("exportValue",r.exportValue),v.tabIndex=y,v.addEventListener("change",w=>{let{name:R,checked:j}=w.target;for(let z of this._getElementsByName(R,h)){let W=j&&z.exportValue===r.exportValue;z.domElement&&(z.domElement.checked=W),t.setValue(z.id,{value:W})}t.setValue(h,{value:j})}),v.addEventListener("resetform",w=>{let R=r.defaultFieldValue||"Off";w.target.checked=R===r.exportValue}),this.enableScripting&&this.hasJSActions&&(v.addEventListener("updatefromsandbox",w=>{let R={value(j){j.target.checked=j.detail.value!=="Off",t.setValue(h,{value:j.target.checked})}};this._dispatchEventFromSandbox(R,w)}),this._setEventListeners(v,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.checked)),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class N extends _{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let t=this.annotationStorage,r=this.data,h=r.id,g=t.getValue(h,{value:r.fieldValue===r.buttonValue}).value;typeof g=="string"&&(g=g!==r.buttonValue,t.setValue(h,{value:g}));let v=document.createElement("input");if(e.add(v),v.setAttribute("data-element-id",h),v.disabled=r.readOnly,this._setRequired(v,this.data.required),v.type="radio",v.name=r.fieldName,g&&v.setAttribute("checked",!0),v.tabIndex=y,v.addEventListener("change",w=>{let{name:R,checked:j}=w.target;for(let z of this._getElementsByName(R,h))t.setValue(z.id,{value:!1});t.setValue(h,{value:j})}),v.addEventListener("resetform",w=>{let R=r.defaultFieldValue;w.target.checked=R!=null&&R===r.buttonValue}),this.enableScripting&&this.hasJSActions){let w=r.buttonValue;v.addEventListener("updatefromsandbox",R=>{let j={value:z=>{let W=w===z.detail.value;for(let V of this._getElementsByName(z.target.name)){let Z=W&&V.id===h;V.domElement&&(V.domElement.checked=Z),t.setValue(V.id,{value:Z})}}};this._dispatchEventFromSandbox(j,R)}),this._setEventListeners(v,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],R=>R.target.checked)}return this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class P extends A{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){let t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(t.title=this.data.alternativeText);let r=t.lastChild;return this.enableScripting&&this.hasJSActions&&r&&(this._setDefaultPropertiesFromJS(r),r.addEventListener("updatefromsandbox",h=>{this._dispatchEventFromSandbox({},h)})),t}}class c extends _{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let t=this.annotationStorage,r=this.data.id,h=t.getValue(r,{value:this.data.fieldValue}),g=document.createElement("select");e.add(g),g.setAttribute("data-element-id",r),g.disabled=this.data.readOnly,this._setRequired(g,this.data.required),g.name=this.data.fieldName,g.tabIndex=y;let v=this.data.combo&&this.data.options.length>0;this.data.combo||(g.size=this.data.options.length,this.data.multiSelect&&(g.multiple=!0)),g.addEventListener("resetform",W=>{let V=this.data.defaultFieldValue;for(let Z of g.options)Z.selected=Z.value===V});for(let W of this.data.options){let V=document.createElement("option");V.textContent=W.displayValue,V.value=W.exportValue,h.value.includes(W.exportValue)&&(V.setAttribute("selected",!0),v=!1),g.append(V)}let w=null;if(v){let W=document.createElement("option");W.value=" ",W.setAttribute("hidden",!0),W.setAttribute("selected",!0),g.prepend(W),w=()=>{W.remove(),g.removeEventListener("input",w),w=null},g.addEventListener("input",w)}let R=W=>{let V=W?"value":"textContent",{options:Z,multiple:Y}=g;return Y?Array.prototype.filter.call(Z,st=>st.selected).map(st=>st[V]):Z.selectedIndex===-1?null:Z[Z.selectedIndex][V]},j=R(!1),z=W=>{let V=W.target.options;return Array.prototype.map.call(V,Z=>({displayValue:Z.textContent,exportValue:Z.value}))};return this.enableScripting&&this.hasJSActions?(g.addEventListener("updatefromsandbox",W=>{let V={value(Z){w?.();let Y=Z.detail.value,st=new Set(Array.isArray(Y)?Y:[Y]);for(let nt of g.options)nt.selected=st.has(nt.value);t.setValue(r,{value:R(!0)}),j=R(!1)},multipleSelection(Z){g.multiple=!0},remove(Z){let Y=g.options,st=Z.detail.remove;Y[st].selected=!1,g.remove(st),Y.length>0&&Array.prototype.findIndex.call(Y,et=>et.selected)===-1&&(Y[0].selected=!0),t.setValue(r,{value:R(!0),items:z(Z)}),j=R(!1)},clear(Z){for(;g.length!==0;)g.remove(0);t.setValue(r,{value:null,items:[]}),j=R(!1)},insert(Z){let{index:Y,displayValue:st,exportValue:nt}=Z.detail.insert,et=g.children[Y],at=document.createElement("option");at.textContent=st,at.value=nt,et?et.before(at):g.append(at),t.setValue(r,{value:R(!0),items:z(Z)}),j=R(!1)},items(Z){let{items:Y}=Z.detail;for(;g.length!==0;)g.remove(0);for(let st of Y){let{displayValue:nt,exportValue:et}=st,at=document.createElement("option");at.textContent=nt,at.value=et,g.append(at)}g.options.length>0&&(g.options[0].selected=!0),t.setValue(r,{value:R(!0),items:z(Z)}),j=R(!1)},indices(Z){let Y=new Set(Z.detail.indices);for(let st of Z.target.options)st.selected=Y.has(st.index);t.setValue(r,{value:R(!0)}),j=R(!1)},editable(Z){Z.target.disabled=!Z.detail.editable}};this._dispatchEventFromSandbox(V,W)}),g.addEventListener("input",W=>{let V=R(!0);t.setValue(r,{value:V}),W.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:j,changeEx:V,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(g,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],W=>W.target.value)):g.addEventListener("input",function(W){t.setValue(r,{value:R(!0)})}),this.data.combo&&this._setTextStyle(g),this._setBackgroundColor(g),this._setDefaultPropertiesFromJS(g),this.container.append(g),this.container}}class f extends i{static IGNORE_TYPES=new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]);constructor(t){let{data:r}=t,h=!f.IGNORE_TYPES.has(r.parentType)&&!!(r.titleObj?.str||r.contentsObj?.str||r.richText?.str);super(t,{isRenderable:h})}render(){this.container.classList.add("popupAnnotation");let t=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(t.length===0)return this.container;let r=new k({container:this.container,trigger:Array.from(t),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),h=this.page,g=a.Util.normalizeRect([this.data.parentRect[0],h.view[3]-this.data.parentRect[1]+h.view[1],this.data.parentRect[2],h.view[3]-this.data.parentRect[3]+h.view[1]]),v=g[0]+this.data.parentRect[2]-this.data.parentRect[0],w=g[1],{pageWidth:R,pageHeight:j,pageX:z,pageY:W}=this.viewport.rawDims;return this.container.style.left=`${100*(v-z)/R}%`,this.container.style.top=`${100*(w-W)/j}%`,this.container.append(r.render()),this.container}}class k{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.richText=t.richText,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){let r=document.createElement("div");r.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?r:this.container,this.hideElement.hidden=!0;let h=document.createElement("div");h.classList.add("popup");let g=this.color;if(g){let R=.7*(255-g[0])+g[0],j=.7*(255-g[1])+g[1],z=.7*(255-g[2])+g[2];h.style.backgroundColor=a.Util.makeHexColor(R|0,j|0,z|0)}let v=document.createElement("h1");v.dir=this.titleObj.dir,v.textContent=this.titleObj.str,h.append(v);let w=u.PDFDateString.toDateObject(this.modificationDate);if(w){let R=document.createElement("span");R.classList.add("popupDate"),R.textContent="{{date}}, {{time}}",R.dataset.l10nId="annotation_date_string",R.dataset.l10nArgs=JSON.stringify({date:w.toLocaleDateString(),time:w.toLocaleTimeString()}),h.append(R)}if(this.richText?.str&&(!this.contentsObj?.str||this.contentsObj.str===this.richText.str))I.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:h}),h.lastChild.classList.add("richText","popupContent");else{let R=this._formatContents(this.contentsObj);h.append(R)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(let R of this.trigger)R.addEventListener("click",this._toggle.bind(this)),R.addEventListener("mouseover",this._show.bind(this,!1)),R.addEventListener("mouseout",this._hide.bind(this,!1));return h.addEventListener("click",this._hide.bind(this,!0)),r.append(h),r}_formatContents({str:t,dir:r}){let h=document.createElement("p");h.classList.add("popupContent"),h.dir=r;let g=t.split(/(?:\r\n?|\n)/);for(let v=0,w=g.length;v<w;++v){let R=g[v];h.append(document.createTextNode(R)),v<w-1&&h.append(document.createElement("br"))}return h}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class B extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0}),this.textContent=t.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(let r of this.textContent){let h=document.createElement("span");h.textContent=r,t.append(h)}this.container.append(t)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class O extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let t=this.data,{width:r,height:h}=d(t.rect),g=this.svgFactory.create(r,h,!0),v=this.svgFactory.createElement("svg:line");return v.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),v.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),v.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),v.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),v.setAttribute("stroke-width",t.borderStyle.width||1),v.setAttribute("stroke","transparent"),v.setAttribute("fill","transparent"),g.append(v),this.container.append(g),this._createPopup(v,t),this.container}}class G extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let t=this.data,{width:r,height:h}=d(t.rect),g=this.svgFactory.create(r,h,!0),v=t.borderStyle.width,w=this.svgFactory.createElement("svg:rect");return w.setAttribute("x",v/2),w.setAttribute("y",v/2),w.setAttribute("width",r-v),w.setAttribute("height",h-v),w.setAttribute("stroke-width",v||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),g.append(w),this.container.append(g),this._createPopup(w,t),this.container}}class X extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let t=this.data,{width:r,height:h}=d(t.rect),g=this.svgFactory.create(r,h,!0),v=t.borderStyle.width,w=this.svgFactory.createElement("svg:ellipse");return w.setAttribute("cx",r/2),w.setAttribute("cy",h/2),w.setAttribute("rx",r/2-v/2),w.setAttribute("ry",h/2-v/2),w.setAttribute("stroke-width",v||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),g.append(w),this.container.append(g),this._createPopup(w,t),this.container}}class K extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let t=this.data,{width:r,height:h}=d(t.rect),g=this.svgFactory.create(r,h,!0),v=[];for(let R of t.vertices){let j=R.x-t.rect[0],z=t.rect[3]-R.y;v.push(j+","+z)}v=v.join(" ");let w=this.svgFactory.createElement(this.svgElementName);return w.setAttribute("points",v),w.setAttribute("stroke-width",t.borderStyle.width||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),g.append(w),this.container.append(g),this._createPopup(w,t),this.container}}class rt extends K{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class tt extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let t=this.data,{width:r,height:h}=d(t.rect),g=this.svgFactory.create(r,h,!0);for(let v of t.inkLists){let w=[];for(let j of v){let z=j.x-t.rect[0],W=t.rect[3]-j.y;w.push(`${z},${W}`)}w=w.join(" ");let R=this.svgFactory.createElement(this.svgElementName);R.setAttribute("points",w),R.setAttribute("stroke-width",t.borderStyle.width||1),R.setAttribute("stroke","transparent"),R.setAttribute("fill","transparent"),this._createPopup(R,t),g.append(R)}return this.container.append(g),this.container}}class $ extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class U extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class L extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class S extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class o extends i{constructor(t){let r=!!(t.data.hasPopup||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str);super(t,{isRenderable:r,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class l extends i{constructor(t){super(t,{isRenderable:!0});let{filename:r,content:h}=this.data.file;this.filename=(0,u.getFilenameFromUrl)(r,!0),this.content=h,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:r,content:h})}render(){this.container.classList.add("fileAttachmentAnnotation");let t;return this.data.hasAppearance?t=document.createElement("div"):(t=document.createElement("img"),t.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),t.classList.add("popupTriggerArea"),t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(t,this.data),this.container.append(t),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class m{static#t(t,r,h,g){let v=t.firstChild||t;v.id=`${u.AnnotationPrefix}${r}`,h.append(t),g?.moveElementInDOM(h,t,v,!1)}static render(t){let{annotations:r,div:h,viewport:g,accessibilityManager:v}=t;(0,u.setLayerDimensions)(h,g);let w={data:null,layer:h,page:t.page,viewport:g,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new u.DOMSVGFactory,annotationStorage:t.annotationStorage||new F.AnnotationStorage,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects},R=0;for(let j of r){if(j.noHTML)continue;if(j.annotationType!==a.AnnotationType.POPUP){let{width:V,height:Z}=d(j.rect);if(V<=0||Z<=0)continue}w.data=j;let z=p.create(w);if(!z.isRenderable)continue;let W=z.render();if(j.hidden&&(W.style.visibility="hidden"),Array.isArray(W))for(let V of W)V.style.zIndex=R++,m.#t(V,j.id,h,v);else W.style.zIndex=R++,z instanceof f?h.prepend(W):m.#t(W,j.id,h,v)}this.#e(h,t.annotationCanvasMap)}static update(t){let{annotationCanvasMap:r,div:h,viewport:g}=t;(0,u.setLayerDimensions)(h,{rotation:g.rotation}),this.#e(h,r),h.hidden=!1}static#e(t,r){if(r){for(let[h,g]of r){let v=t.querySelector(`[data-annotation-id="${h}"]`);if(!v)continue;let{firstChild:w}=v;w?w.nodeName==="CANVAS"?w.replaceWith(g):w.before(g):v.append(g)}r.clear()}}}s.AnnotationLayer=m},(D,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorConverters=void 0;function C(u){return Math.floor(Math.max(0,Math.min(1,u))*255).toString(16).padStart(2,"0")}class a{static CMYK_G([F,x,I,y]){return["G",1-Math.min(1,.3*F+.59*I+.11*x+y)]}static G_CMYK([F]){return["CMYK",0,0,0,1-F]}static G_RGB([F]){return["RGB",F,F,F]}static G_HTML([F]){let x=C(F);return`#${x}${x}${x}`}static RGB_G([F,x,I]){return["G",.3*F+.59*x+.11*I]}static RGB_HTML([F,x,I]){let y=C(F),n=C(x),e=C(I);return`#${y}${n}${e}`}static T_HTML(){return"#00000000"}static CMYK_RGB([F,x,I,y]){return["RGB",1-Math.min(1,F+y),1-Math.min(1,I+y),1-Math.min(1,x+y)]}static CMYK_HTML(F){let x=this.CMYK_RGB(F).slice(1);return this.RGB_HTML(x)}static RGB_CMYK([F,x,I]){let y=1-F,n=1-x,e=1-I,d=Math.min(y,n,e);return["CMYK",y,n,e,d]}}s.ColorConverters=a},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.XfaLayer=void 0;var a=C(19);class u{static setupStorage(x,I,y,n,e){let d=n.getValue(I,{value:null});switch(y.name){case"textarea":if(d.value!==null&&(x.textContent=d.value),e==="print")break;x.addEventListener("input",p=>{n.setValue(I,{value:p.target.value})});break;case"input":if(y.attributes.type==="radio"||y.attributes.type==="checkbox"){if(d.value===y.attributes.xfaOn?x.setAttribute("checked",!0):d.value===y.attributes.xfaOff&&x.removeAttribute("checked"),e==="print")break;x.addEventListener("change",p=>{n.setValue(I,{value:p.target.checked?p.target.getAttribute("xfaOn"):p.target.getAttribute("xfaOff")})})}else{if(d.value!==null&&x.setAttribute("value",d.value),e==="print")break;x.addEventListener("input",p=>{n.setValue(I,{value:p.target.value})})}break;case"select":if(d.value!==null)for(let p of y.children)p.attributes.value===d.value&&(p.attributes.selected=!0);x.addEventListener("input",p=>{let i=p.target.options,A=i.selectedIndex===-1?"":i[i.selectedIndex].value;n.setValue(I,{value:A})});break}}static setAttributes({html:x,element:I,storage:y=null,intent:n,linkService:e}){let{attributes:d}=I,p=x instanceof HTMLAnchorElement;d.type==="radio"&&(d.name=`${d.name}-${n}`);for(let[i,A]of Object.entries(d))if(A!=null)switch(i){case"class":A.length&&x.setAttribute(i,A.join(" "));break;case"dataId":break;case"id":x.setAttribute("data-element-id",A);break;case"style":Object.assign(x.style,A);break;case"textContent":x.textContent=A;break;default:(!p||i!=="href"&&i!=="newWindow")&&x.setAttribute(i,A)}p&&e.addLinkAttributes(x,d.href,d.newWindow),y&&d.dataId&&this.setupStorage(x,d.dataId,I,y)}static render(x){let I=x.annotationStorage,y=x.linkService,n=x.xfaHtml,e=x.intent||"display",d=document.createElement(n.name);n.attributes&&this.setAttributes({html:d,element:n,intent:e,linkService:y});let p=[[n,-1,d]],i=x.div;if(i.append(d),x.viewport){let T=`matrix(${x.viewport.transform.join(",")})`;i.style.transform=T}e!=="richText"&&i.setAttribute("class","xfaLayer xfaFont");let A=[];for(;p.length>0;){let[T,_,b]=p.at(-1);if(_+1===T.children.length){p.pop();continue}let M=T.children[++p.at(-1)[1]];if(M===null)continue;let{name:N}=M;if(N==="#text"){let c=document.createTextNode(M.value);A.push(c),b.append(c);continue}let P;if(M?.attributes?.xmlns?P=document.createElementNS(M.attributes.xmlns,N):P=document.createElement(N),b.append(P),M.attributes&&this.setAttributes({html:P,element:M,storage:I,intent:e,linkService:y}),M.children&&M.children.length>0)p.push([M,-1,P]);else if(M.value){let c=document.createTextNode(M.value);a.XfaText.shouldBuildText(N)&&A.push(c),P.append(c)}}for(let T of i.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))T.setAttribute("readOnly",!0);return{textDivs:A}}static update(x){let I=`matrix(${x.viewport.transform.join(",")})`;x.div.style.transform=I,x.div.hidden=!1}}s.XfaLayer=u},(D,s,C)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SVGGraphics=void 0;var a=C(6),u=C(1),F=C(10);let x=class{constructor(){(0,u.unreachable)("Not implemented: SVGGraphics")}};s.SVGGraphics=x;{let T=function(c){let f=[],k=[];for(let B of c){if(B.fn==="save"){f.push({fnId:92,fn:"group",items:[]}),k.push(f),f=f.at(-1).items;continue}B.fn==="restore"?f=k.pop():f.push(B)}return f},_=function(c){if(Number.isInteger(c))return c.toString();let f=c.toFixed(10),k=f.length-1;if(f[k]!=="0")return f;do k--;while(f[k]==="0");return f.substring(0,f[k]==="."?k:k+1)},b=function(c){if(c[4]===0&&c[5]===0){if(c[1]===0&&c[2]===0)return c[0]===1&&c[3]===1?"":`scale(${_(c[0])} ${_(c[3])})`;if(c[0]===c[3]&&c[1]===-c[2]){let f=Math.acos(c[0])*180/Math.PI;return`rotate(${_(f)})`}}else if(c[0]===1&&c[1]===0&&c[2]===0&&c[3]===1)return`translate(${_(c[4])} ${_(c[5])})`;return`matrix(${_(c[0])} ${_(c[1])} ${_(c[2])} ${_(c[3])} ${_(c[4])} ${_(c[5])})`},I={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},y="http://www.w3.org/XML/1998/namespace",n="http://www.w3.org/1999/xlink",e=["butt","round","square"],d=["miter","round","bevel"],p=function(c,f="",k=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!k)return URL.createObjectURL(new Blob([c],{type:f}));let B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",O=`data:${f};base64,`;for(let G=0,X=c.length;G<X;G+=3){let K=c[G]&255,rt=c[G+1]&255,Q=c[G+2]&255,tt=K>>2,$=(K&3)<<4|rt>>4,U=G+1<X?(rt&15)<<2|Q>>6:64,L=G+2<X?Q&63:64;O+=B[tt]+B[$]+B[U]+B[L]}return O},i=function(){let c=new Uint8Array([137,80,78,71,13,10,26,10]),f=12,k=new Int32Array(256);for(let Q=0;Q<256;Q++){let tt=Q;for(let $=0;$<8;$++)tt&1?tt=3988292384^tt>>1&2147483647:tt=tt>>1&2147483647;k[Q]=tt}function B(Q,tt,$){let U=-1;for(let L=tt;L<$;L++){let S=(U^Q[L])&255,o=k[S];U=U>>>8^o}return U^-1}function O(Q,tt,$,U){let L=U,S=tt.length;$[L]=S>>24&255,$[L+1]=S>>16&255,$[L+2]=S>>8&255,$[L+3]=S&255,L+=4,$[L]=Q.charCodeAt(0)&255,$[L+1]=Q.charCodeAt(1)&255,$[L+2]=Q.charCodeAt(2)&255,$[L+3]=Q.charCodeAt(3)&255,L+=4,$.set(tt,L),L+=tt.length;let o=B($,U+4,L);$[L]=o>>24&255,$[L+1]=o>>16&255,$[L+2]=o>>8&255,$[L+3]=o&255}function G(Q,tt,$){let U=1,L=0;for(let S=tt;S<$;++S)U=(U+(Q[S]&255))%65521,L=(L+U)%65521;return L<<16|U}function X(Q){if(!F.isNodeJS)return K(Q);try{let tt;parseInt(process.versions.node)>=8?tt=Q:tt=Buffer.from(Q);let $=zt().deflateSync(tt,{level:9});return $ instanceof Uint8Array?$:new Uint8Array($)}catch(tt){(0,u.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+tt)}return K(Q)}function K(Q){let tt=Q.length,$=65535,U=Math.ceil(tt/$),L=new Uint8Array(2+tt+U*5+4),S=0;L[S++]=120,L[S++]=156;let o=0;for(;tt>$;)L[S++]=0,L[S++]=255,L[S++]=255,L[S++]=0,L[S++]=0,L.set(Q.subarray(o,o+$),S),S+=$,o+=$,tt-=$;L[S++]=1,L[S++]=tt&255,L[S++]=tt>>8&255,L[S++]=~tt&65535&255,L[S++]=(~tt&65535)>>8&255,L.set(Q.subarray(o),S),S+=Q.length-o;let l=G(Q,0,Q.length);return L[S++]=l>>24&255,L[S++]=l>>16&255,L[S++]=l>>8&255,L[S++]=l&255,L}function rt(Q,tt,$,U){let L=Q.width,S=Q.height,o,l,m,E=Q.data;switch(tt){case u.ImageKind.GRAYSCALE_1BPP:l=0,o=1,m=L+7>>3;break;case u.ImageKind.RGB_24BPP:l=2,o=8,m=L*3;break;case u.ImageKind.RGBA_32BPP:l=6,o=8,m=L*4;break;default:throw new Error("invalid format")}let t=new Uint8Array((1+m)*S),r=0,h=0;for(let z=0;z<S;++z)t[r++]=0,t.set(E.subarray(h,h+m),r),h+=m,r+=m;if(tt===u.ImageKind.GRAYSCALE_1BPP&&U){r=0;for(let z=0;z<S;z++){r++;for(let W=0;W<m;W++)t[r++]^=255}}let g=new Uint8Array([L>>24&255,L>>16&255,L>>8&255,L&255,S>>24&255,S>>16&255,S>>8&255,S&255,o,l,0,0,0]),v=X(t),w=c.length+f*3+g.length+v.length,R=new Uint8Array(w),j=0;return R.set(c,j),j+=c.length,O("IHDR",g,R,j),j+=f+g.length,O("IDATA",v,R,j),j+=f+v.length,O("IEND",new Uint8Array(0),R,j),p(R,"image/png",$)}return function(tt,$,U){let L=tt.kind===void 0?u.ImageKind.GRAYSCALE_1BPP:tt.kind;return rt(tt,L,$,U)}}();class A{constructor(){this.fontSizeScale=1,this.fontWeight=I.fontWeight,this.fontSize=0,this.textMatrix=u.IDENTITY_MATRIX,this.fontMatrix=u.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=u.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=I.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(f,k){this.x=f,this.y=k}}let M=0,N=0,P=0;s.SVGGraphics=x=class{constructor(c,f,k=!1){(0,a.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new a.DOMSVGFactory,this.current=new A,this.transformMatrix=u.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=c,this.objs=f,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!k,this._operatorIdMapping=[];for(let B in u.OPS)this._operatorIdMapping[u.OPS[B]]=B}getObject(c,f=null){return typeof c=="string"?c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c):f}save(){this.transformStack.push(this.transformMatrix);let c=this.current;this.extraStack.push(c),this.current=c.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(c){this.save(),this.executeOpTree(c),this.restore()}loadDependencies(c){let f=c.fnArray,k=c.argsArray;for(let B=0,O=f.length;B<O;B++)if(f[B]===u.OPS.dependency)for(let G of k[B]){let X=G.startsWith("g_")?this.commonObjs:this.objs,K=new Promise(rt=>{X.get(G,rt)});this.current.dependencies.push(K)}return Promise.all(this.current.dependencies)}transform(c,f,k,B,O,G){let X=[c,f,k,B,O,G];this.transformMatrix=u.Util.transform(this.transformMatrix,X),this.tgrp=null}getSVG(c,f){this.viewport=f;let k=this._initialize(f);return this.loadDependencies(c).then(()=>(this.transformMatrix=u.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(c)),k))}convertOpList(c){let f=this._operatorIdMapping,k=c.argsArray,B=c.fnArray,O=[];for(let G=0,X=B.length;G<X;G++){let K=B[G];O.push({fnId:K,fn:f[K],args:k[G]})}return T(O)}executeOpTree(c){for(let f of c){let k=f.fn,B=f.fnId,O=f.args;switch(B|0){case u.OPS.beginText:this.beginText();break;case u.OPS.dependency:break;case u.OPS.setLeading:this.setLeading(O);break;case u.OPS.setLeadingMoveText:this.setLeadingMoveText(O[0],O[1]);break;case u.OPS.setFont:this.setFont(O);break;case u.OPS.showText:this.showText(O[0]);break;case u.OPS.showSpacedText:this.showText(O[0]);break;case u.OPS.endText:this.endText();break;case u.OPS.moveText:this.moveText(O[0],O[1]);break;case u.OPS.setCharSpacing:this.setCharSpacing(O[0]);break;case u.OPS.setWordSpacing:this.setWordSpacing(O[0]);break;case u.OPS.setHScale:this.setHScale(O[0]);break;case u.OPS.setTextMatrix:this.setTextMatrix(O[0],O[1],O[2],O[3],O[4],O[5]);break;case u.OPS.setTextRise:this.setTextRise(O[0]);break;case u.OPS.setTextRenderingMode:this.setTextRenderingMode(O[0]);break;case u.OPS.setLineWidth:this.setLineWidth(O[0]);break;case u.OPS.setLineJoin:this.setLineJoin(O[0]);break;case u.OPS.setLineCap:this.setLineCap(O[0]);break;case u.OPS.setMiterLimit:this.setMiterLimit(O[0]);break;case u.OPS.setFillRGBColor:this.setFillRGBColor(O[0],O[1],O[2]);break;case u.OPS.setStrokeRGBColor:this.setStrokeRGBColor(O[0],O[1],O[2]);break;case u.OPS.setStrokeColorN:this.setStrokeColorN(O);break;case u.OPS.setFillColorN:this.setFillColorN(O);break;case u.OPS.shadingFill:this.shadingFill(O[0]);break;case u.OPS.setDash:this.setDash(O[0],O[1]);break;case u.OPS.setRenderingIntent:this.setRenderingIntent(O[0]);break;case u.OPS.setFlatness:this.setFlatness(O[0]);break;case u.OPS.setGState:this.setGState(O[0]);break;case u.OPS.fill:this.fill();break;case u.OPS.eoFill:this.eoFill();break;case u.OPS.stroke:this.stroke();break;case u.OPS.fillStroke:this.fillStroke();break;case u.OPS.eoFillStroke:this.eoFillStroke();break;case u.OPS.clip:this.clip("nonzero");break;case u.OPS.eoClip:this.clip("evenodd");break;case u.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case u.OPS.paintImageXObject:this.paintImageXObject(O[0]);break;case u.OPS.paintInlineImageXObject:this.paintInlineImageXObject(O[0]);break;case u.OPS.paintImageMaskXObject:this.paintImageMaskXObject(O[0]);break;case u.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(O[0],O[1]);break;case u.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case u.OPS.closePath:this.closePath();break;case u.OPS.closeStroke:this.closeStroke();break;case u.OPS.closeFillStroke:this.closeFillStroke();break;case u.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case u.OPS.nextLine:this.nextLine();break;case u.OPS.transform:this.transform(O[0],O[1],O[2],O[3],O[4],O[5]);break;case u.OPS.constructPath:this.constructPath(O[0],O[1]);break;case u.OPS.endPath:this.endPath();break;case 92:this.group(f.items);break;default:(0,u.warn)(`Unimplemented operator ${k}`);break}}}setWordSpacing(c){this.current.wordSpacing=c}setCharSpacing(c){this.current.charSpacing=c}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(c,f,k,B,O,G){let X=this.current;X.textMatrix=X.lineMatrix=[c,f,k,B,O,G],X.textMatrixScale=Math.hypot(c,f),X.x=X.lineX=0,X.y=X.lineY=0,X.xcoords=[],X.ycoords=[],X.tspan=this.svgFactory.createElement("svg:tspan"),X.tspan.setAttributeNS(null,"font-family",X.fontFamily),X.tspan.setAttributeNS(null,"font-size",`${_(X.fontSize)}px`),X.tspan.setAttributeNS(null,"y",_(-X.y)),X.txtElement=this.svgFactory.createElement("svg:text"),X.txtElement.append(X.tspan)}beginText(){let c=this.current;c.x=c.lineX=0,c.y=c.lineY=0,c.textMatrix=u.IDENTITY_MATRIX,c.lineMatrix=u.IDENTITY_MATRIX,c.textMatrixScale=1,c.tspan=this.svgFactory.createElement("svg:tspan"),c.txtElement=this.svgFactory.createElement("svg:text"),c.txtgrp=this.svgFactory.createElement("svg:g"),c.xcoords=[],c.ycoords=[]}moveText(c,f){let k=this.current;k.x=k.lineX+=c,k.y=k.lineY+=f,k.xcoords=[],k.ycoords=[],k.tspan=this.svgFactory.createElement("svg:tspan"),k.tspan.setAttributeNS(null,"font-family",k.fontFamily),k.tspan.setAttributeNS(null,"font-size",`${_(k.fontSize)}px`),k.tspan.setAttributeNS(null,"y",_(-k.y))}showText(c){let f=this.current,k=f.font,B=f.fontSize;if(B===0)return;let O=f.fontSizeScale,G=f.charSpacing,X=f.wordSpacing,K=f.fontDirection,rt=f.textHScale*K,Q=k.vertical,tt=Q?1:-1,$=k.defaultVMetrics,U=B*f.fontMatrix[0],L=0;for(let l of c){if(l===null){L+=K*X;continue}else if(typeof l=="number"){L+=tt*l*B/1e3;continue}let m=(l.isSpace?X:0)+G,E=l.fontChar,t,r,h=l.width;if(Q){let v,w=l.vmetric||$;v=l.vmetric?w[1]:h*.5,v=-v*U;let R=w[2]*U;h=w?-w[0]:h,t=v/O,r=(L+R)/O}else t=L/O,r=0;(l.isInFont||k.missingFile)&&(f.xcoords.push(f.x+t),Q&&f.ycoords.push(-f.y+r),f.tspan.textContent+=E);let g;Q?g=h*U-m*K:g=h*U+m*K,L+=g}f.tspan.setAttributeNS(null,"x",f.xcoords.map(_).join(" ")),Q?f.tspan.setAttributeNS(null,"y",f.ycoords.map(_).join(" ")):f.tspan.setAttributeNS(null,"y",_(-f.y)),Q?f.y-=L:f.x+=L*rt,f.tspan.setAttributeNS(null,"font-family",f.fontFamily),f.tspan.setAttributeNS(null,"font-size",`${_(f.fontSize)}px`),f.fontStyle!==I.fontStyle&&f.tspan.setAttributeNS(null,"font-style",f.fontStyle),f.fontWeight!==I.fontWeight&&f.tspan.setAttributeNS(null,"font-weight",f.fontWeight);let S=f.textRenderingMode&u.TextRenderingMode.FILL_STROKE_MASK;if(S===u.TextRenderingMode.FILL||S===u.TextRenderingMode.FILL_STROKE?(f.fillColor!==I.fillColor&&f.tspan.setAttributeNS(null,"fill",f.fillColor),f.fillAlpha<1&&f.tspan.setAttributeNS(null,"fill-opacity",f.fillAlpha)):f.textRenderingMode===u.TextRenderingMode.ADD_TO_PATH?f.tspan.setAttributeNS(null,"fill","transparent"):f.tspan.setAttributeNS(null,"fill","none"),S===u.TextRenderingMode.STROKE||S===u.TextRenderingMode.FILL_STROKE){let l=1/(f.textMatrixScale||1);this._setStrokeAttributes(f.tspan,l)}let o=f.textMatrix;f.textRise!==0&&(o=o.slice(),o[5]+=f.textRise),f.txtElement.setAttributeNS(null,"transform",`${b(o)} scale(${_(rt)}, -1)`),f.txtElement.setAttributeNS(y,"xml:space","preserve"),f.txtElement.append(f.tspan),f.txtgrp.append(f.txtElement),this._ensureTransformGroup().append(f.txtElement)}setLeadingMoveText(c,f){this.setLeading(-f),this.moveText(c,f)}addFontStyle(c){if(!c.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));let f=p(c.data,c.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${c.loadedName}"; src: url(${f}); }
`}setFont(c){let f=this.current,k=this.commonObjs.get(c[0]),B=c[1];f.font=k,this.embedFonts&&!k.missingFile&&!this.embeddedFonts[k.loadedName]&&(this.addFontStyle(k),this.embeddedFonts[k.loadedName]=k),f.fontMatrix=k.fontMatrix||u.FONT_IDENTITY_MATRIX;let O="normal";k.black?O="900":k.bold&&(O="bold");let G=k.italic?"italic":"normal";B<0?(B=-B,f.fontDirection=-1):f.fontDirection=1,f.fontSize=B,f.fontFamily=k.loadedName,f.fontWeight=O,f.fontStyle=G,f.tspan=this.svgFactory.createElement("svg:tspan"),f.tspan.setAttributeNS(null,"y",_(-f.y)),f.xcoords=[],f.ycoords=[]}endText(){let c=this.current;c.textRenderingMode&u.TextRenderingMode.ADD_TO_PATH_FLAG&&c.txtElement?.hasChildNodes()&&(c.element=c.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(c){c>0&&(this.current.lineWidth=c)}setLineCap(c){this.current.lineCap=e[c]}setLineJoin(c){this.current.lineJoin=d[c]}setMiterLimit(c){this.current.miterLimit=c}setStrokeAlpha(c){this.current.strokeAlpha=c}setStrokeRGBColor(c,f,k){this.current.strokeColor=u.Util.makeHexColor(c,f,k)}setFillAlpha(c){this.current.fillAlpha=c}setFillRGBColor(c,f,k){this.current.fillColor=u.Util.makeHexColor(c,f,k),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(c){this.current.strokeColor=this._makeColorN_Pattern(c)}setFillColorN(c){this.current.fillColor=this._makeColorN_Pattern(c)}shadingFill(c){let f=this.viewport.width,k=this.viewport.height,B=u.Util.inverseTransform(this.transformMatrix),O=u.Util.applyTransform([0,0],B),G=u.Util.applyTransform([0,k],B),X=u.Util.applyTransform([f,0],B),K=u.Util.applyTransform([f,k],B),rt=Math.min(O[0],G[0],X[0],K[0]),Q=Math.min(O[1],G[1],X[1],K[1]),tt=Math.max(O[0],G[0],X[0],K[0]),$=Math.max(O[1],G[1],X[1],K[1]),U=this.svgFactory.createElement("svg:rect");U.setAttributeNS(null,"x",rt),U.setAttributeNS(null,"y",Q),U.setAttributeNS(null,"width",tt-rt),U.setAttributeNS(null,"height",$-Q),U.setAttributeNS(null,"fill",this._makeShadingPattern(c)),this.current.fillAlpha<1&&U.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(U)}_makeColorN_Pattern(c){return c[0]==="TilingPattern"?this._makeTilingPattern(c):this._makeShadingPattern(c)}_makeTilingPattern(c){let f=c[1],k=c[2],B=c[3]||u.IDENTITY_MATRIX,[O,G,X,K]=c[4],rt=c[5],Q=c[6],tt=c[7],$=`shading${P++}`,[U,L,S,o]=u.Util.normalizeRect([...u.Util.applyTransform([O,G],B),...u.Util.applyTransform([X,K],B)]),[l,m]=u.Util.singularValueDecompose2dScale(B),E=rt*l,t=Q*m,r=this.svgFactory.createElement("svg:pattern");r.setAttributeNS(null,"id",$),r.setAttributeNS(null,"patternUnits","userSpaceOnUse"),r.setAttributeNS(null,"width",E),r.setAttributeNS(null,"height",t),r.setAttributeNS(null,"x",`${U}`),r.setAttributeNS(null,"y",`${L}`);let h=this.svg,g=this.transformMatrix,v=this.current.fillColor,w=this.current.strokeColor,R=this.svgFactory.create(S-U,o-L);if(this.svg=R,this.transformMatrix=B,tt===2){let j=u.Util.makeHexColor(...f);this.current.fillColor=j,this.current.strokeColor=j}return this.executeOpTree(this.convertOpList(k)),this.svg=h,this.transformMatrix=g,this.current.fillColor=v,this.current.strokeColor=w,r.append(R.childNodes[0]),this.defs.append(r),`url(#${$})`}_makeShadingPattern(c){switch(typeof c=="string"&&(c=this.objs.get(c)),c[0]){case"RadialAxial":let f=`shading${P++}`,k=c[3],B;switch(c[1]){case"axial":let O=c[4],G=c[5];B=this.svgFactory.createElement("svg:linearGradient"),B.setAttributeNS(null,"id",f),B.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),B.setAttributeNS(null,"x1",O[0]),B.setAttributeNS(null,"y1",O[1]),B.setAttributeNS(null,"x2",G[0]),B.setAttributeNS(null,"y2",G[1]);break;case"radial":let X=c[4],K=c[5],rt=c[6],Q=c[7];B=this.svgFactory.createElement("svg:radialGradient"),B.setAttributeNS(null,"id",f),B.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),B.setAttributeNS(null,"cx",K[0]),B.setAttributeNS(null,"cy",K[1]),B.setAttributeNS(null,"r",Q),B.setAttributeNS(null,"fx",X[0]),B.setAttributeNS(null,"fy",X[1]),B.setAttributeNS(null,"fr",rt);break;default:throw new Error(`Unknown RadialAxial type: ${c[1]}`)}for(let O of k){let G=this.svgFactory.createElement("svg:stop");G.setAttributeNS(null,"offset",O[0]),G.setAttributeNS(null,"stop-color",O[1]),B.append(G)}return this.defs.append(B),`url(#${f})`;case"Mesh":return(0,u.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${c[0]}`)}}setDash(c,f){this.current.dashArray=c,this.current.dashPhase=f}constructPath(c,f){let k=this.current,B=k.x,O=k.y,G=[],X=0;for(let K of c)switch(K|0){case u.OPS.rectangle:B=f[X++],O=f[X++];let rt=f[X++],Q=f[X++],tt=B+rt,$=O+Q;G.push("M",_(B),_(O),"L",_(tt),_(O),"L",_(tt),_($),"L",_(B),_($),"Z");break;case u.OPS.moveTo:B=f[X++],O=f[X++],G.push("M",_(B),_(O));break;case u.OPS.lineTo:B=f[X++],O=f[X++],G.push("L",_(B),_(O));break;case u.OPS.curveTo:B=f[X+4],O=f[X+5],G.push("C",_(f[X]),_(f[X+1]),_(f[X+2]),_(f[X+3]),_(B),_(O)),X+=6;break;case u.OPS.curveTo2:G.push("C",_(B),_(O),_(f[X]),_(f[X+1]),_(f[X+2]),_(f[X+3])),B=f[X+2],O=f[X+3],X+=4;break;case u.OPS.curveTo3:B=f[X+2],O=f[X+3],G.push("C",_(f[X]),_(f[X+1]),_(B),_(O),_(B),_(O)),X+=4;break;case u.OPS.closePath:G.push("Z");break}G=G.join(" "),k.path&&c.length>0&&c[0]!==u.OPS.rectangle&&c[0]!==u.OPS.moveTo?G=k.path.getAttributeNS(null,"d")+G:(k.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(k.path)),k.path.setAttributeNS(null,"d",G),k.path.setAttributeNS(null,"fill","none"),k.element=k.path,k.setCurrentPoint(B,O)}endPath(){let c=this.current;if(c.path=null,!this.pendingClip)return;if(!c.element){this.pendingClip=null;return}let f=`clippath${M++}`,k=this.svgFactory.createElement("svg:clipPath");k.setAttributeNS(null,"id",f),k.setAttributeNS(null,"transform",b(this.transformMatrix));let B=c.element.cloneNode(!0);if(this.pendingClip==="evenodd"?B.setAttributeNS(null,"clip-rule","evenodd"):B.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,k.append(B),this.defs.append(k),c.activeClipUrl){c.clipGroup=null;for(let O of this.extraStack)O.clipGroup=null;k.setAttributeNS(null,"clip-path",c.activeClipUrl)}c.activeClipUrl=`url(#${f})`,this.tgrp=null}clip(c){this.pendingClip=c}closePath(){let c=this.current;if(c.path){let f=`${c.path.getAttributeNS(null,"d")}Z`;c.path.setAttributeNS(null,"d",f)}}setLeading(c){this.current.leading=-c}setTextRise(c){this.current.textRise=c}setTextRenderingMode(c){this.current.textRenderingMode=c}setHScale(c){this.current.textHScale=c/100}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(let[f,k]of c)switch(f){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k);break;case"CA":this.setStrokeAlpha(k);break;case"ca":this.setFillAlpha(k);break;default:(0,u.warn)(`Unimplemented graphic state operator ${f}`);break}}fill(){let c=this.current;c.element&&(c.element.setAttributeNS(null,"fill",c.fillColor),c.element.setAttributeNS(null,"fill-opacity",c.fillAlpha),this.endPath())}stroke(){let c=this.current;c.element&&(this._setStrokeAttributes(c.element),c.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(c,f=1){let k=this.current,B=k.dashArray;f!==1&&B.length>0&&(B=B.map(function(O){return f*O})),c.setAttributeNS(null,"stroke",k.strokeColor),c.setAttributeNS(null,"stroke-opacity",k.strokeAlpha),c.setAttributeNS(null,"stroke-miterlimit",_(k.miterLimit)),c.setAttributeNS(null,"stroke-linecap",k.lineCap),c.setAttributeNS(null,"stroke-linejoin",k.lineJoin),c.setAttributeNS(null,"stroke-width",_(f*k.lineWidth)+"px"),c.setAttributeNS(null,"stroke-dasharray",B.map(_).join(" ")),c.setAttributeNS(null,"stroke-dashoffset",_(f*k.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){let c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x","0"),c.setAttributeNS(null,"y","0"),c.setAttributeNS(null,"width","1px"),c.setAttributeNS(null,"height","1px"),c.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(c)}paintImageXObject(c){let f=this.getObject(c);if(!f){(0,u.warn)(`Dependent image with object ID ${c} is not ready yet`);return}this.paintInlineImageXObject(f)}paintInlineImageXObject(c,f){let k=c.width,B=c.height,O=i(c,this.forceDataSchema,!!f),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",_(k)),G.setAttributeNS(null,"height",_(B)),this.current.element=G,this.clip("nonzero");let X=this.svgFactory.createElement("svg:image");X.setAttributeNS(n,"xlink:href",O),X.setAttributeNS(null,"x","0"),X.setAttributeNS(null,"y",_(-B)),X.setAttributeNS(null,"width",_(k)+"px"),X.setAttributeNS(null,"height",_(B)+"px"),X.setAttributeNS(null,"transform",`scale(${_(1/k)} ${_(-1/B)})`),f?f.append(X):this._ensureTransformGroup().append(X)}paintImageMaskXObject(c){let f=this.getObject(c.data,c);if(f.bitmap){(0,u.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}let k=this.current,B=f.width,O=f.height,G=k.fillColor;k.maskId=`mask${N++}`;let X=this.svgFactory.createElement("svg:mask");X.setAttributeNS(null,"id",k.maskId);let K=this.svgFactory.createElement("svg:rect");K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y","0"),K.setAttributeNS(null,"width",_(B)),K.setAttributeNS(null,"height",_(O)),K.setAttributeNS(null,"fill",G),K.setAttributeNS(null,"mask",`url(#${k.maskId})`),this.defs.append(X),this._ensureTransformGroup().append(K),this.paintInlineImageXObject(f,X)}paintFormXObjectBegin(c,f){if(Array.isArray(c)&&c.length===6&&this.transform(c[0],c[1],c[2],c[3],c[4],c[5]),f){let k=f[2]-f[0],B=f[3]-f[1],O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x",f[0]),O.setAttributeNS(null,"y",f[1]),O.setAttributeNS(null,"width",_(k)),O.setAttributeNS(null,"height",_(B)),this.current.element=O,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(c){let f=this.svgFactory.create(c.width,c.height),k=this.svgFactory.createElement("svg:defs");f.append(k),this.defs=k;let B=this.svgFactory.createElement("svg:g");return B.setAttributeNS(null,"transform",b(c.transform)),f.append(B),this.svg=B,f}_ensureClipGroup(){if(!this.current.clipGroup){let c=this.svgFactory.createElement("svg:g");c.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(c),this.current.clipGroup=c}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",b(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(D){var s=__webpack_module_cache__[D];if(s!==void 0)return s.exports;var C=__webpack_module_cache__[D]={exports:{}};return __webpack_modules__[D](C,C.exports,__w_pdfjs_require__),C.exports}var __webpack_exports__={};return(()=>{var D=__webpack_exports__;Object.defineProperty(D,"__esModule",{value:!0}),Object.defineProperty(D,"AbortException",{enumerable:!0,get:function(){return s.AbortException}}),Object.defineProperty(D,"AnnotationEditorLayer",{enumerable:!0,get:function(){return F.AnnotationEditorLayer}}),Object.defineProperty(D,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return s.AnnotationEditorParamsType}}),Object.defineProperty(D,"AnnotationEditorType",{enumerable:!0,get:function(){return s.AnnotationEditorType}}),Object.defineProperty(D,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return x.AnnotationEditorUIManager}}),Object.defineProperty(D,"AnnotationLayer",{enumerable:!0,get:function(){return I.AnnotationLayer}}),Object.defineProperty(D,"AnnotationMode",{enumerable:!0,get:function(){return s.AnnotationMode}}),Object.defineProperty(D,"CMapCompressionType",{enumerable:!0,get:function(){return s.CMapCompressionType}}),Object.defineProperty(D,"FeatureTest",{enumerable:!0,get:function(){return s.FeatureTest}}),Object.defineProperty(D,"GlobalWorkerOptions",{enumerable:!0,get:function(){return y.GlobalWorkerOptions}}),Object.defineProperty(D,"InvalidPDFException",{enumerable:!0,get:function(){return s.InvalidPDFException}}),Object.defineProperty(D,"MissingPDFException",{enumerable:!0,get:function(){return s.MissingPDFException}}),Object.defineProperty(D,"OPS",{enumerable:!0,get:function(){return s.OPS}}),Object.defineProperty(D,"PDFDataRangeTransport",{enumerable:!0,get:function(){return C.PDFDataRangeTransport}}),Object.defineProperty(D,"PDFDateString",{enumerable:!0,get:function(){return a.PDFDateString}}),Object.defineProperty(D,"PDFWorker",{enumerable:!0,get:function(){return C.PDFWorker}}),Object.defineProperty(D,"PasswordResponses",{enumerable:!0,get:function(){return s.PasswordResponses}}),Object.defineProperty(D,"PermissionFlag",{enumerable:!0,get:function(){return s.PermissionFlag}}),Object.defineProperty(D,"PixelsPerInch",{enumerable:!0,get:function(){return a.PixelsPerInch}}),Object.defineProperty(D,"PromiseCapability",{enumerable:!0,get:function(){return s.PromiseCapability}}),Object.defineProperty(D,"RenderingCancelledException",{enumerable:!0,get:function(){return a.RenderingCancelledException}}),Object.defineProperty(D,"SVGGraphics",{enumerable:!0,get:function(){return n.SVGGraphics}}),Object.defineProperty(D,"UnexpectedResponseException",{enumerable:!0,get:function(){return s.UnexpectedResponseException}}),Object.defineProperty(D,"Util",{enumerable:!0,get:function(){return s.Util}}),Object.defineProperty(D,"VerbosityLevel",{enumerable:!0,get:function(){return s.VerbosityLevel}}),Object.defineProperty(D,"XfaLayer",{enumerable:!0,get:function(){return e.XfaLayer}}),Object.defineProperty(D,"build",{enumerable:!0,get:function(){return C.build}}),Object.defineProperty(D,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return s.createValidAbsoluteUrl}}),Object.defineProperty(D,"getDocument",{enumerable:!0,get:function(){return C.getDocument}}),Object.defineProperty(D,"getFilenameFromUrl",{enumerable:!0,get:function(){return a.getFilenameFromUrl}}),Object.defineProperty(D,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return a.getPdfFilenameFromUrl}}),Object.defineProperty(D,"getXfaPageViewport",{enumerable:!0,get:function(){return a.getXfaPageViewport}}),Object.defineProperty(D,"isDataScheme",{enumerable:!0,get:function(){return a.isDataScheme}}),Object.defineProperty(D,"isPdfFile",{enumerable:!0,get:function(){return a.isPdfFile}}),Object.defineProperty(D,"loadScript",{enumerable:!0,get:function(){return a.loadScript}}),Object.defineProperty(D,"normalizeUnicode",{enumerable:!0,get:function(){return s.normalizeUnicode}}),Object.defineProperty(D,"renderTextLayer",{enumerable:!0,get:function(){return u.renderTextLayer}}),Object.defineProperty(D,"setLayerDimensions",{enumerable:!0,get:function(){return a.setLayerDimensions}}),Object.defineProperty(D,"shadow",{enumerable:!0,get:function(){return s.shadow}}),Object.defineProperty(D,"updateTextLayer",{enumerable:!0,get:function(){return u.updateTextLayer}}),Object.defineProperty(D,"version",{enumerable:!0,get:function(){return C.version}});var s=__w_pdfjs_require__(1),C=__w_pdfjs_require__(2),a=__w_pdfjs_require__(6),u=__w_pdfjs_require__(26),F=__w_pdfjs_require__(27),x=__w_pdfjs_require__(5),I=__w_pdfjs_require__(30),y=__w_pdfjs_require__(14),n=__w_pdfjs_require__(33),e=__w_pdfjs_require__(32);let d="3.7.107",p="036f855dc"})(),__webpack_exports__})())});var Lt=se($t());Lt.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.7.107/pdf.worker.min.js";async function ne(D){let s=await Lt.getDocument(D).promise;console.debug("PDF pages",s.numPages);let C=[];for(let u=1;u<=s.numPages;u++){let F=s.getPage(u);C.push(F.then(async x=>(await x.getTextContent()).items.map(y=>y.str).join("")))}return(await Promise.all(C)).join("")}chrome.runtime.onMessage.addListener((D,s,C)=>{if(D.action==="getPageData"){let a=document.body.innerText;if(a)C({text:a});else if(/\.pdf$/i.test(location.href))return ne(location.href).then(u=>C({text:u})),!0}});})();
